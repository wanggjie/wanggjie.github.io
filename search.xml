<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>修改ElementUI文本域的placeholder颜色</title>
    <url>/2021/01/01/01%E4%BF%AE%E6%94%B9%E6%96%87%E6%9C%AC%E5%9F%9F%E7%9A%84placeholder%E9%A2%9C%E8%89%B2/</url>
    <content><![CDATA[<h1 id="修改文本域的placeholder颜色并取消拖拽"><a href="#修改文本域的placeholder颜色并取消拖拽" class="headerlink" title="修改文本域的placeholder颜色并取消拖拽"></a>修改文本域的placeholder颜色并取消拖拽</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.el-textarea</span> /deep/<span class="selector-class">.el-textarea__inner</span> &#123;</span><br><span class="line"> &amp;<span class="selector-pseudo">::placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#bfc4cc</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: MicrosoftYaHei, PingFangSC-Regular, HiraginoSansGB-W3,</span><br><span class="line">   HelveticaNeue, Helvetica, Arial;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//禁止拖拽</span><br><span class="line"><span class="selector-tag">textarea</span>&#123;</span><br><span class="line"> <span class="attribute">resize</span>:none;  <span class="comment">/* 取消拖拽 */</span></span><br><span class="line"> <span class="attribute">outline</span>: none;<span class="comment">/* 取消选中高亮 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>文本域</tag>
      </tags>
  </entry>
  <entry>
    <title>ip4/6及ip段的正则表达式校验</title>
    <url>/2021/01/03/02ip%E5%8F%8Aip%E6%AE%B5%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="ip4-x2F-6的正则表达式校验规则"><a href="#ip4-x2F-6的正则表达式校验规则" class="headerlink" title="ip4&#x2F;6的正则表达式校验规则"></a>ip4&#x2F;6的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ip4</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">validIp4</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入ip&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> ipv4 =</span><br><span class="line">          <span class="string">&quot;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)&quot;</span>;</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^(<span class="subst">$&#123;ipv4&#125;</span>)$`</span>);</span><br><span class="line">          <span class="comment">//let reg = /^($&#123;ipv4&#125;)$/</span></span><br><span class="line">        <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;ip格式不正确&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ip6</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">validIp6</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (value) &#123;</span><br><span class="line">    <span class="keyword">const</span> ipv6 =</span><br><span class="line">      <span class="string">&quot;([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|::([\\da-fA-F]&#123;1,4&#125;:)&#123;0,4&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:):([\\da-fA-F]&#123;1,4&#125;:)&#123;0,3&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,2&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,1&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;:((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;7&#125;[\\da-fA-F]&#123;1,4&#125;|:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,6&#125;|:)|[\\da-fA-F]&#123;1,4&#125;:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;5&#125;:([\\da-fA-F]&#123;1,4&#125;)?|([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;:&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^(<span class="subst">$&#123;ipv6&#125;</span>)$`</span>);</span><br><span class="line">    <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;ip格式不正确&quot;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h1 id="ip4-x2F-6段的正则表达式校验规则"><a href="#ip4-x2F-6段的正则表达式校验规则" class="headerlink" title="ip4&#x2F;6段的正则表达式校验规则"></a>ip4&#x2F;6段的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">validIp</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入ip段&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> semicolon = <span class="string">&quot;[;；]&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> ipv4 =</span><br><span class="line">          <span class="string">&quot;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> mask = <span class="string">&quot;([1-9]|[1-2][0-9]|3[0-2])&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> ipv6WithMask =</span><br><span class="line">          <span class="string">&quot;([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|::([\\da-fA-F]&#123;1,4&#125;:)&#123;0,4&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:):([\\da-fA-F]&#123;1,4&#125;:)&#123;0,3&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,2&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,1&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;:((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;7&#125;[\\da-fA-F]&#123;1,4&#125;(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,6&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|[\\da-fA-F]&#123;1,4&#125;:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;5&#125;:([\\da-fA-F]&#123;1,4&#125;)?(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;:(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))&quot;</span>;</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(</span><br><span class="line">          <span class="string">`^((<span class="subst">$&#123;ipv4&#125;</span>\\/<span class="subst">$&#123;mask&#125;</span>)|(<span class="subst">$&#123;ipv6WithMask&#125;</span>))(<span class="subst">$&#123;semicolon&#125;</span>((<span class="subst">$&#123;ipv4&#125;</span>\\/<span class="subst">$&#123;mask&#125;</span>)|(<span class="subst">$&#123;ipv6WithMask&#125;</span>)))*$`</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;格式不正确&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>端口域名的正则表达式校验</title>
    <url>/2021/01/04/03%E7%AB%AF%E5%8F%A3%E5%9F%9F%E5%90%8D%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="端口域名的正则表达式校验规则"><a href="#端口域名的正则表达式校验规则" class="headerlink" title="端口域名的正则表达式校验规则"></a>端口域名的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在rules配置域名domain字段的正则表达式校验</span></span><br><span class="line"><span class="attr">rules</span>: &#123;</span><br><span class="line">  <span class="attr">domain</span>: [</span><br><span class="line">          <span class="comment">// 支持 泛域名 *.ctyun.cn</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">              <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span>,</span><br><span class="line">              <span class="attr">pattern</span>: <span class="regexp">/^(\*\.|\*)?([a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?\.)+[a-zA-Z]&#123;2,6&#125;$/</span>,</span><br><span class="line">              <span class="attr">message</span>: <span class="string">&quot;请输入正确的域名&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          ],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置端口正则表达式校验的处理函数</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title function_">valiPost</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入端口数字值&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title class_">Post</span> =<span class="regexp">/^([0-9]|[1-9]\d|[1-9]\d&#123;2&#125;|[1-9]\d&#123;3&#125;|[1-5]\d&#123;4&#125;|6[0-4]\d&#123;3&#125;|65[0-4]\d&#123;2&#125;|655[0-2]\d|6553[0-5])$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title class_">Post</span>.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;端口不在合法范围&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>前端获取响应头返回的字段</title>
    <url>/2021/01/10/04%E5%89%8D%E7%AB%AF%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E5%A4%B4%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AD%97%E6%AE%B5/</url>
    <content><![CDATA[<h1 id="前端获取响应头返回的字段"><a href="#前端获取响应头返回的字段" class="headerlink" title="前端获取响应头返回的字段"></a>前端获取响应头返回的字段</h1><p>1：在导出文件的时候，有些文件名需要后端那边动态展示，后端便会在响应头返回某字段<br>2：前端需要知道怎么获取<br>3：有些后端也没有试过怎么从响应头返回字段，有些仅以为写某些字段在响应头就行<br>4：前端现在只看得到，去拿不到<br>4：此时后端需要在响应头上设置 Access-Control-Expose-Headers</p>
<p><img src="/2021/01/10/04%E5%89%8D%E7%AB%AF%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E5%A4%B4%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AD%97%E6%AE%B5/01.png"></p>
]]></content>
      <tags>
        <tag>响应头</tag>
      </tags>
  </entry>
  <entry>
    <title>去掉空格、换行的正则表达式</title>
    <url>/2021/01/13/05%E5%8E%BB%E6%8E%89%E7%A9%BA%E6%A0%BC%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="去掉空格、换行的正则表达式"><a href="#去掉空格、换行的正则表达式" class="headerlink" title="去掉空格、换行的正则表达式"></a>去掉空格、换行的正则表达式</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//去除空格 </span></span><br><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">Trim</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">replace</span>(<span class="regexp">/\s+/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除换行 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ClearBr</span>(<span class="params">key</span>) &#123; </span><br><span class="line">key = key.<span class="title function_">replace</span>(<span class="regexp">/&lt;\/?.+?&gt;/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">key = key.<span class="title function_">replace</span>(<span class="regexp">/[\r\n]/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line"><span class="keyword">return</span> key; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除左侧空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LTrim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/^\s*/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去右空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RTrim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/\s*$/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去掉字符串两端的空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/(^\s*)|(\s*$)/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除字符串中间空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CTim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>空格</tag>
      </tags>
  </entry>
  <entry>
    <title>验证码流字符串转图片（*js-base64*）</title>
    <url>/2021/01/20/06%E9%AA%8C%E8%AF%81%E7%A0%81%E6%B5%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="验证码流字符串转图片（js-base64）"><a href="#验证码流字符串转图片（js-base64）" class="headerlink" title="验证码流字符串转图片（js-base64）"></a>验证码流字符串转图片（<em>js-base64</em>）</h1><p>1：下载第三方包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i js-base64</span><br></pre></td></tr></table></figure>


<h2 id="js-base64常规方法：编码-解码-乱码"><a href="#js-base64常规方法：编码-解码-乱码" class="headerlink" title="js-base64常规方法：编码-解码-乱码"></a>js-base64常规方法：编码-解码-乱码</h2><p>（官方文档<a href="https://www.npmjs.com/package/js-base64%EF%BC%89">https://www.npmjs.com/package/js-base64）</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 编码base64</span></span><br><span class="line"> <span class="title function_">getEncode64</span>(<span class="params">str</span>)&#123;</span><br><span class="line">     <span class="comment">// 对字符串进行编码</span></span><br><span class="line">     <span class="keyword">var</span> encode = <span class="built_in">encodeURI</span>(str);</span><br><span class="line">     <span class="comment">// 对编码的字符串转化base64</span></span><br><span class="line">     <span class="keyword">var</span> base64 = <span class="title function_">btoa</span>(encode);</span><br><span class="line">     <span class="keyword">return</span> base64;</span><br><span class="line">   &#125;,</span><br><span class="line">       </span><br><span class="line"><span class="comment">// base64转字符串解码</span></span><br><span class="line">   <span class="title function_">getDecode</span>(<span class="params">str</span>)&#123;</span><br><span class="line">      <span class="comment">// 对base64转编码</span></span><br><span class="line">      <span class="keyword">var</span> decode = <span class="title function_">atob</span>(base64);</span><br><span class="line">      <span class="comment">// 编码转字符串</span></span><br><span class="line">      <span class="keyword">var</span> str = <span class="built_in">decodeURI</span>(decode);</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">  &#125;,</span><br><span class="line">      </span><br><span class="line"><span class="comment">//问题：</span></span><br><span class="line">用上述的编码和解码，自己前端操作编译和解码中文都是没有问题的，但是由于需要后台，编码后传输到后台，后台返回编码格式再解码的时候就会出现中文乱码。</span><br><span class="line"></span><br><span class="line">原因：</span><br><span class="line">一番查找下来，可能是由于 常规的encode方法虽然界面上转的是utf-<span class="number">8</span>，但是实际上传输存储的时候格式还是utf-<span class="number">16</span>，后台返回的是utf-<span class="number">8</span>格式，用decode界面实际上转的是utf-<span class="number">16</span>,转utf-<span class="number">8</span>会出现中文乱码。也就是说上述的编码和解码，适用于页面本身编码解码，不适合传输用。</span><br><span class="line"></span><br><span class="line"><span class="comment">//解决解码中文乱码：</span></span><br><span class="line"><span class="title function_">getEncode64</span>(<span class="params">str</span>)&#123;   </span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">btoa</span>(<span class="built_in">encodeURIComponent</span>(str).<span class="title function_">replace</span>(<span class="regexp">/%([0-9A-F]&#123;2&#125;)/g</span>,</span><br><span class="line">          <span class="keyword">function</span> <span class="title function_">toSolidBytes</span>(<span class="params">match, p1</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="string">&#x27;0x&#x27;</span> + p1);</span><br><span class="line">         &#125;));</span><br><span class="line">            </span><br><span class="line">  &#125;,</span><br><span class="line">      </span><br><span class="line"><span class="title function_">getDecode</span>(<span class="params">str</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(<span class="title function_">atob</span>(str).<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&#x27;%&#x27;</span> + (<span class="string">&#x27;00&#x27;</span> + c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>).<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">slice</span>(-<span class="number">2</span>);</span><br><span class="line">      &#125;).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <tags>
        <tag>验证码</tag>
      </tags>
  </entry>
  <entry>
    <title>this.$set(),对象和数组的注入方式</title>
    <url>/2021/01/24/07this.$set%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="this-set-对象和数组的注入方式"><a href="#this-set-对象和数组的注入方式" class="headerlink" title="this.$set(),对象和数组的注入方式"></a>this.$set(),对象和数组的注入方式</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//对象</span></span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="string">&#x27;&#123;object&#125;&#x27;</span>,<span class="string">&#x27;要添加注入的属性名&#x27;</span>,<span class="string">&#x27;设置的属性值&#x27;</span>)</span><br><span class="line"><span class="comment">//数组</span></span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="string">&#x27;数组&#x27;</span>,<span class="title function_">index</span>(数组的下标),<span class="string">&#x27;要赋的值值&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>$set</tag>
      </tags>
  </entry>
  <entry>
    <title>表单enter阻止事件</title>
    <url>/2021/02/02/08%E8%A1%A8%E5%8D%95enter%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="表单enter阻止事件"><a href="#表单enter阻止事件" class="headerlink" title="表单enter阻止事件"></a>表单enter阻止事件</h1><p>1：需要添加 @submit.native.prevent 事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;el-form :inline=<span class="string">&quot;true&quot;</span> :model=<span class="string">&quot;search&quot;</span> @submit.<span class="property">native</span>.<span class="property">prevent</span>&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>vue传值EventBus的坑</title>
    <url>/2021/02/05/09vue%E4%BC%A0%E5%80%BCEventBus%E7%9A%84%E5%9D%91/</url>
    <content><![CDATA[<h1 id="vue传值EventBus的坑"><a href="#vue传值EventBus的坑" class="headerlink" title="vue传值EventBus的坑"></a>vue传值EventBus的坑</h1><h2 id="1：创建空js文件–src-utils-eventBus-js（路径）"><a href="#1：创建空js文件–src-utils-eventBus-js（路径）" class="headerlink" title="1：创建空js文件–src\utils\eventBus.js（路径）"></a>1：创建空js文件–src\utils\eventBus.js（路径）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vue</span>()</span><br></pre></td></tr></table></figure>

<h2 id="2：在需要传值的-兄弟组件1-中导入并使用传值"><a href="#2：在需要传值的-兄弟组件1-中导入并使用传值" class="headerlink" title="2：在需要传值的 兄弟组件1 中导入并使用传值"></a>2：在需要传值的 兄弟组件1 中导入并使用传值</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//导入（兄弟组件1）</span></span><br><span class="line"><span class="keyword">import</span> eventBus <span class="keyword">from</span> <span class="string">&#x27;@/utils/eventBus&#x27;</span></span><br><span class="line"><span class="comment">//兄弟组件1传值给兄弟组件2</span></span><br><span class="line">eventBus.$emit(<span class="string">&#x27;sendFieldTableData&#x27;</span>, value)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 兄弟组件2接收兄弟组件1的传值（兄弟组件2）</span></span><br><span class="line">eventBus.$on(<span class="string">&#x27;sendFieldTableData&#x27;</span>, <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">fieldTableData</span> = value</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3：eventBus的坑（每次使用需要-off来注销）"><a href="#3：eventBus的坑（每次使用需要-off来注销）" class="headerlink" title="3：eventBus的坑（每次使用需要$off来注销）"></a>3：eventBus的坑（每次使用需要$off来注销）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$on会多次触发</span></span><br><span class="line"><span class="comment">//在使用$on的组件必须要注销要不然会逐渐追加调用1+1+2+3</span></span><br><span class="line"><span class="title function_">creatr</span>(<span class="params"></span>)&#123;</span><br><span class="line">	eventBus.$on(<span class="string">&#x27;sendId&#x27;</span>, <span class="title function_">async</span>(item) =&gt; &#123;&#125;)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 销毁多次触发</span></span><br><span class="line">  eventBus.$off(<span class="string">&#x27;selfId&#x27;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>vue传值</tag>
      </tags>
  </entry>
  <entry>
    <title>给Element的el-table表头加必选星号</title>
    <url>/2021/02/10/11%E7%BB%99el-table%E8%A1%A8%E5%A4%B4%E5%8A%A0%E5%BF%85%E9%80%89%E6%98%9F%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="给Element的el-table表头加必选星号"><a href="#给Element的el-table表头加必选星号" class="headerlink" title="给Element的el-table表头加必选星号"></a>给Element的el-table表头加必选星号</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1：在el-table-column 上添加render-header属性。render-header指定列标题 Label 区域渲染使用的 Function</span></span><br><span class="line">&lt;el-table-column label=<span class="string">&quot;地域&quot;</span> align=<span class="string">&quot;center&quot;</span> :render-header=<span class="string">&quot;addRedStar&quot;</span>&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2：addRedStar函数</span></span><br><span class="line">  <span class="title function_">addRedStar</span>(<span class="params">h, &#123; column &#125;</span>) &#123; <span class="comment">// 给表头加必选标识</span></span><br><span class="line">     <span class="keyword">return</span> [<span class="title function_">h</span>(<span class="string">&#x27;span&#x27;</span>, &#123; <span class="attr">style</span>: <span class="string">&#x27;color: red&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>), <span class="title function_">h</span>(<span class="string">&#x27;span&#x27;</span>, <span class="string">&#x27; &#x27;</span> + column.<span class="property">label</span>)]</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>表格</tag>
      </tags>
  </entry>
  <entry>
    <title>判断数据类型的方法</title>
    <url>/2021/02/20/12%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="判断数据类型的方法"><a href="#判断数据类型的方法" class="headerlink" title="判断数据类型的方法"></a>判断数据类型的方法</h1><h3 id="下面是typeof、instanceof、constructor三种方法判断数据类型的用法"><a href="#下面是typeof、instanceof、constructor三种方法判断数据类型的用法" class="headerlink" title="下面是typeof、instanceof、constructor三种方法判断数据类型的用法"></a>下面是typeof、instanceof、constructor三种方法判断数据类型的用法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一种typeof</span></span><br><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>:<span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn=<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="number">1</span>);       <span class="comment">//number</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="string">&#x27;abc&#x27;</span>);   <span class="comment">//string</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">true</span>);    <span class="comment">//boolean</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">undefined</span>);  <span class="comment">//undefined </span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> fn);      <span class="comment">//function</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> (<span class="keyword">new</span> <span class="title class_">Date</span>) );  <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>);     <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);  <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> obj);      <span class="comment">//object</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//instanceof</span></span><br><span class="line"> <span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line">        <span class="keyword">let</span> obj=&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>:<span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn=<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(arr <span class="keyword">instanceof</span> <span class="title class_">Array</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Object</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(fn <span class="keyword">instanceof</span> <span class="title class_">Function</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="keyword">new</span> <span class="title class_">Date</span>) <span class="keyword">instanceof</span> <span class="title class_">Date</span>);  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//constructor</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">        <span class="keyword">let</span> obj = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="number">9</span>).<span class="property">constructor</span> === <span class="title class_">Number</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>.<span class="property">constructor</span> === <span class="title class_">String</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">true</span>.<span class="property">constructor</span> === <span class="title class_">Boolean</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(fn.<span class="property">constructor</span> === <span class="title class_">Function</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="property">constructor</span> === <span class="title class_">Date</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">constructor</span> === <span class="title class_">Object</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="property">constructor</span> === <span class="title class_">Array</span>);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>数据类型</tag>
      </tags>
  </entry>
  <entry>
    <title>数组里的对象怎么排序</title>
    <url>/2021/02/07/10%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%80%8E%E4%B9%88%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<h1 id="数组里的对象怎么排序sort"><a href="#数组里的对象怎么排序sort" class="headerlink" title="数组里的对象怎么排序sort()"></a>数组里的对象怎么排序sort()</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//一般数组排序事例：</span></span><br><span class="line"><span class="keyword">var</span> presonArr = [<span class="number">2</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">22</span>,<span class="number">10</span>]</span><br><span class="line">presonArr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> a - b;	</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(presonArr);<span class="comment">//[1, 2, 3, 6, 9, 10, 22]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组里的对象排序</span></span><br><span class="line"><span class="keyword">var</span> presonArr = [</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;freddy&#x27;</span>, <span class="attr">age</span>:<span class="number">24</span>, <span class="attr">score</span>:<span class="number">97</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;nick&#x27;</span>, <span class="attr">age</span>:<span class="number">18</span>, <span class="attr">score</span>:<span class="number">87</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;mike&#x27;</span>, <span class="attr">age</span>:<span class="number">26</span>, <span class="attr">score</span>:<span class="number">80</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;james&#x27;</span>, <span class="attr">age</span>:<span class="number">34</span>, <span class="attr">score</span>:<span class="number">90</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;curry&#x27;</span>, <span class="attr">age</span>:<span class="number">30</span>, <span class="attr">score</span>:<span class="number">83</span> &#125;</span><br><span class="line">];</span><br><span class="line">presonArr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> a.<span class="property">age</span> - b.<span class="property">age</span>;	</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(presonArr);</span><br></pre></td></tr></table></figure>
<p><img src="/2021/02/07/10%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%80%8E%E4%B9%88%E6%8E%92%E5%BA%8F/01.png"></p>
]]></content>
      <tags>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>封装下载/导出文件流的api</title>
    <url>/2021/02/24/13%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%B5%81%E7%9A%84api%E5%B0%81%E8%A3%85/</url>
    <content><![CDATA[<h1 id="封装下载-x2F-导出文件流的api"><a href="#封装下载-x2F-导出文件流的api" class="headerlink" title="封装下载&#x2F;导出文件流的api"></a>封装下载&#x2F;导出文件流的api</h1><h2 id="下载-x2F-导出-XXX-模板"><a href="#下载-x2F-导出-XXX-模板" class="headerlink" title="下载&#x2F;导出 XXX 模板"></a>下载&#x2F;导出 XXX 模板</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">downCancelTemplate</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/v1/download&#x27;</span>,<span class="comment">//导出url</span></span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">responseType</span>: <span class="string">&#x27;blob&#x27;</span><span class="comment">//转文件流（导出接口api一定要设置）</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下载-x2F-导出模板按钮使用参考代码"><a href="#下载-x2F-导出模板按钮使用参考代码" class="headerlink" title="下载&#x2F;导出模板按钮使用参考代码"></a>下载&#x2F;导出模板按钮使用参考代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">downloadTemplateFn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//接口请求</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">downCancelTemplate</span>()</span><br><span class="line">    <span class="comment">// 创建一个url</span></span><br><span class="line">    <span class="keyword">const</span> fileUrl = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res]))</span><br><span class="line">    <span class="comment">// 创建a标签</span></span><br><span class="line">    <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="comment">// 通过样式隐藏a标签</span></span><br><span class="line">    link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">    <span class="comment">// 把url放到a标签中</span></span><br><span class="line">    link.<span class="property">href</span> = fileUrl</span><br><span class="line">    link.<span class="property">download</span> = <span class="string">`XXX 模板.xlsx`</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link)</span><br><span class="line">    link.<span class="title function_">click</span>()</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link)</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(fileUrl)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(err.<span class="property">msg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>当文本行超出宽度时换行</title>
    <url>/2021/03/19/15%E5%BD%93%E6%96%87%E6%9C%AC%E8%A1%8C%E8%B6%85%E5%87%BA%E5%AE%BD%E5%BA%A6%E6%8D%A2%E8%A1%8C/</url>
    <content><![CDATA[<h1 id="当文本行超出宽度时换行"><a href="#当文本行超出宽度时换行" class="headerlink" title="当文本行超出宽度时换行"></a>当文本行超出宽度时换行</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给span添加属性</span></span><br><span class="line"> word-<span class="attr">break</span>: <span class="keyword">break</span>-all; <span class="regexp">/如果单词超过宽度了，整个单词打散，超过的部分换行 */</span></span><br><span class="line"> white-<span class="attr">space</span>: normal; <span class="regexp">/ 重点是这个属性 */</span></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>文本换行</tag>
      </tags>
  </entry>
  <entry>
    <title>阻止事件冒泡(@click.native.stop)</title>
    <url>/2021/03/10/14%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/</url>
    <content><![CDATA[<h1 id="阻止事件冒泡-click-native-stop"><a href="#阻止事件冒泡-click-native-stop" class="headerlink" title="阻止事件冒泡(@click.native.stop)"></a>阻止事件冒泡(@click.native.stop)</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;el-button @click.<span class="property">native</span>.<span class="property">stop</span>&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>事件冒泡</tag>
      </tags>
  </entry>
  <entry>
    <title>递归树排序</title>
    <url>/2021/04/01/16%E9%80%92%E5%BD%92%E6%A0%91%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<h1 id="递归树排序"><a href="#递归树排序" class="headerlink" title="递归树排序"></a>递归树排序</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 递归树排序</span></span><br><span class="line">    <span class="title function_">treeStore</span>(<span class="params">val</span>) &#123;</span><br><span class="line">      val.<span class="property">children</span> &amp;&amp; val.<span class="property">children</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item1</span> =&gt;</span> &#123;</span><br><span class="line">        item1.<span class="property">children</span> &amp;&amp; item1.<span class="property">children</span>.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">before, after</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> before.<span class="property">sort</span> - after.<span class="property">sort</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">treeStore</span>(item1)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>vuex辅助函数使用方法</title>
    <url>/2021/04/08/17vuex%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="vuex辅助函数使用方法"><a href="#vuex辅助函数使用方法" class="headerlink" title="vuex辅助函数使用方法"></a>vuex辅助函数使用方法</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vuex辅助函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState，mapMutations，mapActions，mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;count&#x27;</span>])，</span><br><span class="line">    ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;filterList&#x27;</span>])</span><br><span class="line">  &#125;,</span><br><span class="line"> <span class="attr">methods</span>:&#123;</span><br><span class="line">     ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;addCount&#x27;</span>])，</span><br><span class="line">    ...<span class="title function_">mapActions</span>([<span class="string">&#x27;getAsyncCount&#x27;</span>])，</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>vuex</tag>
      </tags>
  </entry>
  <entry>
    <title>字体添加渐变颜色</title>
    <url>/2021/04/11/18%E5%AD%97%E4%BD%93%E6%B7%BB%E5%8A%A0%E6%B8%90%E5%8F%98%E9%A2%9C%E8%89%B2/</url>
    <content><![CDATA[<h1 id="字体添加渐变颜色"><a href="#字体添加渐变颜色" class="headerlink" title="字体添加渐变颜色"></a>字体添加渐变颜色</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//字体渐变</span><br><span class="line"><span class="selector-class">.text</span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="attribute">background-image</span>:<span class="built_in">-webkit-linear-gradient</span>(bottom,red,<span class="number">#fd8403</span>,yellow); </span><br><span class="line"></span><br><span class="line">    -webkit-<span class="attribute">background-clip</span>:text; </span><br><span class="line"></span><br><span class="line">    -webkit-text-fill-<span class="attribute">color</span>:transparent; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css实现文字循环滚动效果</title>
    <url>/2021/04/18/19css%E5%AE%9E%E7%8E%B0%E6%96%87%E5%AD%97%E5%BE%AA%E7%8E%AF%E6%BB%9A%E5%8A%A8%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="css实现文字循环滚动效果"><a href="#css实现文字循环滚动效果" class="headerlink" title="css实现文字循环滚动效果"></a>css实现文字循环滚动效果</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在公司项目，产品要求在首页上添加一个公告文本循环滚动</p>
<p><img src="/2021/04/18/19css%E5%AE%9E%E7%8E%B0%E6%96%87%E5%AD%97%E5%BE%AA%E7%8E%AF%E6%BB%9A%E5%8A%A8%E6%95%88%E6%9E%9C/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      css实现文字循环滚动效果css实现文字循环滚动效果css实现文字循环滚动效果</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">200px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">12s</span> wordsLoop linear infinite normal;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> wordsLoop &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> wordsLoop &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>js将匹配到关键字使其变为红色</title>
    <url>/2021/05/07/21js%E5%B0%86%E5%8C%B9%E9%85%8D%E5%88%B0%E5%85%B3%E9%94%AE%E5%AD%97%E4%BD%BF%E5%85%B6%E5%8F%98%E4%B8%BA%E7%BA%A2%E8%89%B2/</url>
    <content><![CDATA[<h1 id="js将匹配到关键字使其变为红色"><a href="#js将匹配到关键字使其变为红色" class="headerlink" title="js将匹配到关键字使其变为红色"></a>js将匹配到关键字使其变为红色</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  项目中，产品要求在一段文字中将关键词加粗、变为红色</p>
<p><img src="/2021/05/07/21js%E5%B0%86%E5%8C%B9%E9%85%8D%E5%88%B0%E5%85%B3%E9%94%AE%E5%AD%97%E4%BD%BF%E5%85%B6%E5%8F%98%E4%B8%BA%E7%BA%A2%E8%89%B2/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-text&quot;&gt;&lt;p id=&quot;box-text-p&quot;&gt;&#123;&#123; changeKeyRed(text,&#x27;破浪&#x27;) &#125;&#125;&lt;/p&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在methods添加changeKeyRed处理函数："><a href="#在methods添加changeKeyRed处理函数：" class="headerlink" title="在methods添加changeKeyRed处理函数："></a>在methods添加changeKeyRed处理函数：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">changeKeyRed</span>(<span class="params">str, keyWord</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (str != <span class="literal">null</span> &amp;&amp; keyWord != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> substr = <span class="string">&#x27;/&#x27;</span> + keyWord + <span class="string">&#x27;/g&#x27;</span></span><br><span class="line">        <span class="keyword">var</span> replaceStr = str.<span class="title function_">replace</span>(<span class="built_in">eval</span>(substr), <span class="string">&quot;&lt;span style=&#x27;color:red;font-weight:bold&#x27;&gt;&quot;</span> + keyWord + <span class="string">&#x27;&lt;/span&gt;&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> inText = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">`box-text-p`</span>)</span><br><span class="line">          inText.<span class="property">innerHTML</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(replaceStr))</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> replaceStr</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> str</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>css 省略号动画（请稍等...）</title>
    <url>/2021/04/25/20css%E7%9C%81%E7%95%A5%E5%8F%B7%E9%97%AA%E7%83%81%E5%8A%A8%E7%94%BB/</url>
    <content><![CDATA[<h1 id="css-省略号动画（请稍等…）"><a href="#css-省略号动画（请稍等…）" class="headerlink" title="css 省略号动画（请稍等…）"></a>css 省略号动画（请稍等…）</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在项目中，在某页面的控制台上需要添加（加载中，请稍等…）提示语，要求后面的省略号跳动</p>
<p><img src="/2021/04/25/20css%E7%9C%81%E7%95%A5%E5%8F%B7%E9%97%AA%E7%83%81%E5%8A%A8%E7%94%BB/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box-text&quot;</span>&gt;</span>加载中，请稍等<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;box-text-drop&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box-text-drop</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: simsun; <span class="comment">/*固定字体避免设置的宽度无效*/</span></span><br><span class="line">    <span class="attribute">animation</span>: dropMove <span class="number">1s</span> infinite step-start;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1.5em</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: bottom; <span class="comment">/*始终让省略号在文字的下面*/</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> dropMove &#123; <span class="comment">/*动态改变显示宽度, 但始终让总占据空间不变, 避免抖动*/</span></span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">width</span>: <span class="number">0</span>; <span class="attribute">margin-right</span>: <span class="number">1.5em</span>; &#125;</span><br><span class="line">    <span class="number">33%</span> &#123; <span class="attribute">width</span>: .<span class="number">5em</span>; <span class="attribute">margin-right</span>: <span class="number">1em</span>; &#125;</span><br><span class="line">    <span class="number">66%</span> &#123; <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">margin-right</span>: .<span class="number">5em</span>; &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">width</span>: <span class="number">1.5em</span>; <span class="attribute">margin-right</span>: <span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css鼠标悬停盒子放大效果</title>
    <url>/2021/05/10/22css%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C%E7%9B%92%E5%AD%90%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="css鼠标悬停盒子放大效果"><a href="#css鼠标悬停盒子放大效果" class="headerlink" title="css鼠标悬停盒子放大效果"></a>css鼠标悬停盒子放大效果</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在JQ项目中，产品要求把页面展示的卡片通过鼠标悬停的方式凸显&#x2F;放大的动效</p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加盒子样式测试："><a href="#在css添加盒子样式测试：" class="headerlink" title="在css添加盒子样式测试："></a>在css添加盒子样式测试：</h2><p>有两种效果可参考，后续美化可根据产品需求自行调整</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-item</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  // 效果一：</span><br><span class="line">  // <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.296</span>);</span><br><span class="line">  // -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">2px</span>, <span class="number">0</span>);</span><br><span class="line">  // <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">20px</span>, <span class="number">0</span>);</span><br><span class="line">  // <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  // 效果二：</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">1px</span> <span class="number">1px</span> <span class="number">15px</span> <span class="number">#c8c8c8</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>js计算当前时间的前一天</title>
    <url>/2021/05/25/24js%E8%AE%A1%E7%AE%97%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E7%9A%84%E5%89%8D%E4%B8%80%E5%A4%A9/</url>
    <content><![CDATA[<h1 id="js计算当前时间的前一天"><a href="#js计算当前时间的前一天" class="headerlink" title="js计算当前时间的前一天"></a>js计算当前时间的前一天</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//js如何去当前时间前一天的时间</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Date</span> countDate = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> preDate = <span class="keyword">new</span> <span class="title class_">Date</span>(countDate.<span class="title function_">getTime</span>() - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>); <span class="comment">//前一天</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nextDate = <span class="keyword">new</span> <span class="title class_">Date</span>(countDate.<span class="title function_">getTime</span>() + <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>); <span class="comment">//后一天</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>css给箭头添加向上的动效</title>
    <url>/2021/05/20/23%E7%BB%99%E7%AE%AD%E5%A4%B4%E6%B7%BB%E5%8A%A0%E5%90%91%E4%B8%8A%E7%9A%84%E5%8A%A8%E6%95%88/</url>
    <content><![CDATA[<h1 id="css给箭头添加向上的动效"><a href="#css给箭头添加向上的动效" class="headerlink" title="css给箭头添加向上的动效"></a>css给箭头添加向上的动效</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在JQ项目，产品要求把两个箭头添加向上的一个动效效果</p>
<p><img src="/2021/05/20/23%E7%BB%99%E7%AE%AD%E5%A4%B4%E6%B7%BB%E5%8A%A0%E5%90%91%E4%B8%8A%E7%9A%84%E5%8A%A8%E6%95%88/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><p>(本次模拟用三角形来模拟，后续项目可以更替为图片，效果一样的)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box-item&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 三角形的一个样式处理 */</span></span><br><span class="line"><span class="selector-class">.box-item</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">50px</span> <span class="number">100px</span> <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: transparent transparent <span class="number">#00adb5</span> transparent;</span><br><span class="line">  <span class="attribute">animation</span>: breathDown <span class="number">1.0s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> breathDown &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">10%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue-count-to(数字滚动计时)</title>
    <url>/2021/06/25/26Vue-count-to(%E6%95%B0%E5%AD%97%E6%BB%9A%E5%8A%A8%E8%AE%A1%E6%97%B6)/</url>
    <content><![CDATA[<h1 id="Vue-count-to-数字滚动计时"><a href="#Vue-count-to-数字滚动计时" class="headerlink" title="Vue-count-to(数字滚动计时)"></a>Vue-count-to(数字滚动计时)</h1><h2 id="项目需求："><a href="#项目需求：" class="headerlink" title="项目需求："></a>项目需求：</h2><blockquote>
<p>项目首页的数量展示需要添加一个从 0-获取回来数量 的滚动效果</p>
</blockquote>
<h2 id="使用vue-count-to（数字滚动插件）："><a href="#使用vue-count-to（数字滚动插件）：" class="headerlink" title="使用vue-count-to（数字滚动插件）："></a>使用vue-count-to（数字滚动插件）：</h2><blockquote>
<p>官网：<a href="https://www.npmjs.com/package/vue-count-to">https://www.npmjs.com/package/vue-count-to</a></p>
</blockquote>
<p>1：下载插件依赖</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install vue-count-to</span><br></pre></td></tr></table></figure>
<p>2：页面使用插件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入</span></span><br><span class="line"><span class="keyword">import</span> countTo <span class="keyword">from</span> <span class="string">&quot;vue-count-to&quot;</span>;</span><br><span class="line"><span class="comment">//注册</span></span><br><span class="line"><span class="attr">components</span>: &#123;</span><br><span class="line">    countTo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line">&lt;countTo :startVal=<span class="string">&#x27;startVal&#x27;</span> :endVal=<span class="string">&#x27;endVal&#x27;</span> :duration=<span class="string">&#x27;3000&#x27;</span>&gt;&lt;/countTo&gt;</span><br><span class="line"><span class="comment">//startVal开始值，endVal结束值，duration时间</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>插件</tag>
      </tags>
  </entry>
  <entry>
    <title>input输入框搜索处理不符合条件的校验</title>
    <url>/2021/06/01/25input%E6%90%9C%E7%B4%A2%E5%A4%84%E7%90%86%E4%B8%8D%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="input搜索处理不符合条件的校验"><a href="#input搜索处理不符合条件的校验" class="headerlink" title="input搜索处理不符合条件的校验"></a>input搜索处理不符合条件的校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><p>项目搜索条件有数字搜索的输入框，需要仅能输入数字</p>
<h2 id="处理方法："><a href="#处理方法：" class="headerlink" title="处理方法："></a>处理方法：</h2><blockquote>
<p>通过输入框的blur事件用replace()方法处理该需求</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a-input</span><br><span class="line">  v-model.trim=&quot;searchForm.refValueId&quot;</span><br><span class="line">  placeholder=&quot;请输入参考值标识&quot;</span><br><span class="line">  allow-clear</span><br><span class="line">  @blur=&quot;</span><br><span class="line">    () =&gt;</span><br><span class="line">      (searchForm.refValueId = searchForm.refValueId.replace(</span><br><span class="line">        /[^0-9]/g,</span><br><span class="line">        &#x27;&#x27;</span><br><span class="line">      ))</span><br><span class="line">  &quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>ant组件可以通过尾部图标显示字数</title>
    <url>/2021/07/08/28ant%E7%BB%84%E4%BB%B6%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E5%B0%BE%E9%83%A8%E5%9B%BE%E6%A0%87%E6%98%BE%E7%A4%BA%E5%AD%97%E6%95%B0/</url>
    <content><![CDATA[<h1 id="ant组件可以通过尾部图标显示字数"><a href="#ant组件可以通过尾部图标显示字数" class="headerlink" title="ant组件可以通过尾部图标显示字数"></a>ant组件可以通过尾部图标显示字数</h1><h2 id="在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置"><a href="#在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置" class="headerlink" title="在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置"></a>在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a-input</span><br><span class="line">  v-model=<span class="string">&quot;form.rule_name&quot;</span></span><br><span class="line">  :maxLength=<span class="string">&quot;30&quot;</span></span><br><span class="line">  allowClear</span><br><span class="line">  :suffix=<span class="string">&quot;(form.rule_name.length || 0) + &#x27;/30&#x27;&quot;</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>利用ES6 Set去重（ES6中最常用）</title>
    <url>/2021/07/12/29%E5%88%A9%E7%94%A8ES6%20Set%E5%8E%BB%E9%87%8D%EF%BC%88ES6%E4%B8%AD%E6%9C%80%E5%B8%B8%E7%94%A8%EF%BC%89/</url>
    <content><![CDATA[<h1 id="利用ES6-Set去重（ES6中最常用）"><a href="#利用ES6-Set去重（ES6中最常用）" class="headerlink" title="利用ES6 Set去重（ES6中最常用）"></a>利用ES6 Set去重（ES6中最常用）</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//利用ES6 Set去重（ES6中最常用）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span> (arr) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(arr))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>, <span class="literal">null</span>,<span class="literal">null</span>, <span class="title class_">NaN</span>, <span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"> <span class="comment">//[1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;&#125;, &#123;&#125;]</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>获取屏幕缩放倍数</title>
    <url>/2021/07/03/27%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E7%BC%A9%E6%94%BE%E5%80%8D%E6%95%B0/</url>
    <content><![CDATA[<h1 id="获取屏幕缩放倍数"><a href="#获取屏幕缩放倍数" class="headerlink" title="获取屏幕缩放倍数"></a>获取屏幕缩放倍数</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 屏幕缩放大小</span></span><br><span class="line">    <span class="title function_">detectZoom</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> ratio = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">const</span> screen = <span class="variable language_">window</span>.<span class="property">screen</span>;</span><br><span class="line">      <span class="keyword">const</span> ua = navigator.<span class="property">userAgent</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        ratio = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (~ua.<span class="title function_">indexOf</span>(<span class="string">&quot;msie&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (screen.<span class="property">deviceXDPI</span> &amp;&amp; screen.<span class="property">logicalXDPI</span>) &#123;</span><br><span class="line">          ratio = screen.<span class="property">deviceXDPI</span> / screen.<span class="property">logicalXDPI</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">outerWidth</span> !== <span class="literal">undefined</span> &amp;&amp;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">innerWidth</span> !== <span class="literal">undefined</span></span><br><span class="line">      ) &#123;</span><br><span class="line">        ratio = <span class="variable language_">window</span>.<span class="property">outerWidth</span> / <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (ratio) &#123;</span><br><span class="line">        ratio = <span class="title class_">Math</span>.<span class="title function_">round</span>(ratio * <span class="number">100</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ratio;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="title function_">detectZoom</span>()) <span class="comment">//打印出来的结果要和你电脑本地设置的缩放大小计算（本地放大倍数*浏览器放大倍数/100）</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p><img src="/2021/07/03/27%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E7%BC%A9%E6%94%BE%E5%80%8D%E6%95%B0/01.png"></p>
]]></content>
      <tags>
        <tag>浏览器</tag>
      </tags>
  </entry>
  <entry>
    <title>遍历的表单项如何添加校验</title>
    <url>/2021/07/18/30%E9%81%8D%E5%8E%86%E7%9A%84%E8%A1%A8%E5%8D%95%E9%A1%B9%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="遍历的表单项如何添加校验"><a href="#遍历的表单项如何添加校验" class="headerlink" title="遍历的表单项如何添加校验"></a>遍历的表单项如何添加校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面新增某属性时，可以添加多条，此时就会添加多个相同的表单项，校验方式也是发生改变</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>通过 + index + 的方法来实现<br>例：:prop&#x3D;”‘domains.’ + index + ‘.paramType’”</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">&quot;dynamicValidateForm&quot;</span> <span class="attr">:model</span>=<span class="string">&quot;dynamicValidateForm&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;inline&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-row</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in dynamicValidateForm.domains&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">label</span>=<span class="string">&quot;城市&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.paramType&#x27;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:rules</span>=<span class="string">&quot;rules.paramType&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;item.paramType&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择城市&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;shanghai&quot;</span>&gt;</span> shanghai <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;beijing&quot;</span>&gt;</span> beijing <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span> <span class="attr">:offset</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">label</span>=<span class="string">&quot;类型&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.valueType&#x27;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:rules</span>=<span class="string">&quot;rules.valueType&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;item.valueType&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择类型&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;Zone one&quot;</span>&gt;</span> Zone one <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;Zone two&quot;</span>&gt;</span> Zone two <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span> <span class="attr">:offset</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span> <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.value&#x27;&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules.value&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;item.value&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入内容&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 引入</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 注册</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">components</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dynamicValidateForm</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">domains</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 校验</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">rules</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">value</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">message</span>: <span class="string">&#x27;请选择城市&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">valueType</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">message</span>: <span class="string">&#x27;请选择类型&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">paramType</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入内容&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.box</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>表格中的表单项如何添加校验</title>
    <url>/2021/07/24/31%E8%A1%A8%E6%A0%BC%E4%B8%AD%E7%9A%84%E8%A1%A8%E5%8D%95%E9%A1%B9%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="表格中的表单项如何添加校验"><a href="#表格中的表单项如何添加校验" class="headerlink" title="表格中的表单项如何添加校验"></a>表格中的表单项如何添加校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面的表格项需要添加表单填写，并提交。</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>也是和表单遍历处理的方式差不多，:prop&#x3D;”‘list.’+scope.$index+’.name’”</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;el-form ref=&quot;tableformRef&quot; :model=&quot;form&quot;&gt;</span><br><span class="line">      &lt;el-table :data=&quot;form.list&quot;&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;姓名&quot;</span><br><span class="line">          prop=&quot;name&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.name&#x27;&quot; :rules=&quot;rules.name&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.name&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;性别&quot;</span><br><span class="line">          prop=&quot;sex&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.sex&#x27;&quot; :rules=&quot;rules.sex&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.sex&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;年龄&quot;</span><br><span class="line">          prop=&quot;age&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.age&#x27;&quot; :rules=&quot;rules.age&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.age&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;等级&quot;</span><br><span class="line">          prop=&quot;level&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.level&#x27;&quot; :rules=&quot;rules.level&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.level&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">      &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button @click=&quot;handleSubmit&quot;&gt;提交&lt;/el-button&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入</span><br><span class="line">export default &#123;</span><br><span class="line">  // 注册</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    const validatorAge = (rule, value, callback) =&gt; &#123;</span><br><span class="line">      if (!value) &#123;</span><br><span class="line">        callback(new Error(&#x27;年龄不能为空&#x27;))</span><br><span class="line">      &#125; else if (value &lt; 20 || value &gt; 50) &#123;</span><br><span class="line">        callback(new Error(&#x27;年龄输入错误&#x27;))</span><br><span class="line">      &#125; else callback()</span><br><span class="line">    &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">      form: &#123;</span><br><span class="line">        list: [</span><br><span class="line">          &#123; id: &#x27;1&#x27;, name: &#x27;唐僧&#x27;, sex: &#x27;1&#x27;, age: &#x27;35&#x27;, level: 1, describe: &#x27;他是师傅&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;2&#x27;, name: &#x27;孙悟空&#x27;, sex: &#x27;2&#x27;, age: &#x27;20&#x27;, level: 2, describe: &#x27;他是大师兄&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;3&#x27;, name: &#x27;沙和尚&#x27;, sex: &#x27;1&#x27;, age: &#x27;30&#x27;, level: 4, describe: &#x27;他是三师弟&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;4&#x27;, name: &#x27;猪八戒&#x27;, sex: &#x27;2&#x27;, age: &#x27;33&#x27;, level: 3, describe: &#x27;他是猪八戒&#x27; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      rules: &#123;</span><br><span class="line">        name: &#123; required: true, message: &#x27;姓名不能为空&#x27; &#125;,</span><br><span class="line">        sex: &#123; required: true, message: &#x27;性别不能为空&#x27; &#125;,</span><br><span class="line">        age: [</span><br><span class="line">          &#123; required: true, validator: validatorAge &#125;</span><br><span class="line">        ],</span><br><span class="line">        level: &#123; required: true, message: &#x27;等级不能为空&#x27; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleSubmit() &#123;</span><br><span class="line">      this.$refs.tableformRef.validate(async valid =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          this.$message.success(&#x27;提交成功&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>el-tree组件在内容超出长度时出现提示框</title>
    <url>/2021/09/04/33el-tree%E7%BB%84%E4%BB%B6%E5%9C%A8%E5%86%85%E5%AE%B9%E8%B6%85%E5%87%BA%E9%95%BF%E5%BA%A6%E6%97%B6%E5%87%BA%E7%8E%B0%E6%8F%90%E7%A4%BA%E6%A1%86/</url>
    <content><![CDATA[<h1 id="el-tree组件在内容超出长度时出现提示框"><a href="#el-tree组件在内容超出长度时出现提示框" class="headerlink" title="el-tree组件在内容超出长度时出现提示框"></a>el-tree组件在内容超出长度时出现提示框</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面的树形控件在超出规定长度时要省略号…,并且鼠标悬浮展示全部名称</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>可以通过mouseover事件处理</p>
</blockquote>
<h2 id="优化点："><a href="#优化点：" class="headerlink" title="优化点："></a>优化点：</h2><blockquote>
<p>处理好了样式可能有问题，当超出时，鼠标悬浮右边会出现滚动条，可以再body标签那边添加overflow: hidden;</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-tree&quot;&gt;</span><br><span class="line">      &lt;el-tree</span><br><span class="line">        ref=&quot;tree&quot;</span><br><span class="line">        :data=&quot;treeData&quot;</span><br><span class="line">        node-key=&quot;label&quot;</span><br><span class="line">        :props=&quot;defaultProps&quot;</span><br><span class="line">        class=&quot;tree-wrap&quot;</span><br><span class="line">        :indent=&quot;40&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;el-tooltip slot-scope=&quot;&#123; node &#125;&quot; :disabled=&quot;showTitle&quot; effect=&quot;dark&quot; :content=&quot;tooltipTitle&quot; placement=&quot;top&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;span-ellipsis&quot; @mouseover=&quot;onShowNameTipsMouseenter&quot;&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/el-tooltip&gt;</span><br><span class="line">      &lt;/el-tree&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      treeData: [&#123;</span><br><span class="line">        label: &#x27;一级 11111111111111111111111111111&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1111111111111111&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-11111111111111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 222222222222222222222222222&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-111111111111111111111&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-111111111111111111111111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;二级 2-222222222222222222222222222&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-2-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 3&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 3-1&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 3-1-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;二级 3-2&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 3-2-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;],</span><br><span class="line">      defaultProps: &#123;</span><br><span class="line">        children: &#x27;children&#x27;,</span><br><span class="line">        label: &#x27;label&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      showTitle: false,</span><br><span class="line">      tooltipTitle: undefined</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onShowNameTipsMouseenter(e) &#123;</span><br><span class="line">      var target = e.target</span><br><span class="line">      const textLength = target.clientWidth</span><br><span class="line">      const containerLength = target.scrollWidth</span><br><span class="line">      if (textLength &lt; containerLength) &#123;</span><br><span class="line">        this.tooltipTitle = e.target.innerText</span><br><span class="line">        this.showTitle = false</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.showTitle = true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 500px;</span><br><span class="line">&#125;</span><br><span class="line">.box-tree&#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 100%;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">&#125;</span><br><span class="line">.span-ellipsis &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  white-space: nowrap;</span><br><span class="line">  text-overflow: ellipsis;</span><br><span class="line">  margin-right: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>el-tree树控件</tag>
      </tags>
  </entry>
  <entry>
    <title>后端返回base64字符串转图片</title>
    <url>/2021/08/20/32%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9Ebase64%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="后端返回base64字符串转图片"><a href="#后端返回base64字符串转图片" class="headerlink" title="后端返回base64字符串转图片"></a>后端返回base64字符串转图片</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>后端返回的一串base64字符串，要求在页面展示图片</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>可以通过图片标签的src路径前面添加 “data:image&#x2F;gif;base64,”</p>
</blockquote>
<h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img :src=&quot;&#x27;data:image/gif;base64,&#x27; + srcImg(后端返回的base64字符串)&quot; alt=&quot;&quot; style=&quot;width: 100px;height: 100px;&quot; ref=&quot;printform&quot; id=&quot;printform&quot;&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>单行和多行超出宽度添加省略号</title>
    <url>/2021/09/14/34%E5%8D%95%E8%A1%8C%E5%92%8C%E5%A4%9A%E8%A1%8C%E8%B6%85%E5%87%BA%E5%AE%BD%E5%BA%A6%E6%B7%BB%E5%8A%A0%E7%9C%81%E7%95%A5%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="单行和多行超出宽度添加省略号"><a href="#单行和多行超出宽度添加省略号" class="headerlink" title="单行和多行超出宽度添加省略号"></a>单行和多行超出宽度添加省略号</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaassssssssssssssssssdsdasdasdsd</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入</span><br><span class="line">export default &#123;</span><br><span class="line">  // 注册</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 500px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box-item &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  // 单行省略号</span><br><span class="line">  // white-space: nowrap;</span><br><span class="line">  // overflow: hidden;</span><br><span class="line">  // text-overflow: ellipsis;</span><br><span class="line">  // 多行的：</span><br><span class="line">  word-break: break-all;</span><br><span class="line">  text-overflow: ellipsis;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: -webkit-box;</span><br><span class="line">  -webkit-line-clamp: 2;//多少行添加省略号</span><br><span class="line">  -webkit-box-orient: vertical;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>根据数据嵌套的最后一级id找父集合的id</title>
    <url>/2021/09/25/35%E6%A0%B9%E6%8D%AE%E6%95%B0%E6%8D%AE%E5%B5%8C%E5%A5%97%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E7%BA%A7id%E6%89%BE%E7%88%B6%E9%9B%86%E5%90%88%E7%9A%84id/</url>
    <content><![CDATA[<h1 id="根据数据嵌套的最后一级id找父集合的id"><a href="#根据数据嵌套的最后一级id找父集合的id" class="headerlink" title="根据数据嵌套的最后一级id找父集合的id"></a>根据数据嵌套的最后一级id找父集合的id</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>在表单中有级联框需要回显所以要查找出id父集合<br>（数据嵌套，递归）</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      data: [&#123;</span><br><span class="line">        label: &#x27;一级 1&#x27;,</span><br><span class="line">        id: &#x27;1&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1&#x27;,</span><br><span class="line">          id: &#x27;11&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-1&#x27;,</span><br><span class="line">            id: &#x27;111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 2&#x27;,</span><br><span class="line">        id: &#x27;2&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-1&#x27;,</span><br><span class="line">          id: &#x27;21&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-1&#x27;,</span><br><span class="line">            id: &#x27;211&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.getHierarchyData(this.data, [&#x27;111&#x27;])</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    getHierarchyData(rawData, list) &#123;</span><br><span class="line">      const data = []</span><br><span class="line">      const find = (classifyList, id) =&gt; &#123;</span><br><span class="line">        const temp = [id]</span><br><span class="line">        const forFn = function(arr, id) &#123;</span><br><span class="line">          for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">            const item = arr[i]</span><br><span class="line">            if (item.children) &#123;</span><br><span class="line">              const data1 = item.children.find((item1) =&gt; item1.id === id)</span><br><span class="line">              if (data1) &#123;</span><br><span class="line">                temp.unshift(item.id)</span><br><span class="line">                forFn(classifyList, item.id)</span><br><span class="line">                break</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                forFn(item.children, id)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        forFn(classifyList, id)</span><br><span class="line">        return temp</span><br><span class="line">      &#125;</span><br><span class="line">      list.forEach((str) =&gt; &#123;</span><br><span class="line">        data.push(find(rawData, str))</span><br><span class="line">      &#125;)</span><br><span class="line">      return data</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>根据最后一级id找name，或者根据最后一级name找id</title>
    <url>/2021/10/12/36%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%90%8E%E4%B8%80%E7%BA%A7id%E6%89%BEname/</url>
    <content><![CDATA[<h1 id="根据最后一级id找name，或者根据最后一级name找id"><a href="#根据最后一级id找name，或者根据最后一级name找id" class="headerlink" title="根据最后一级id找name，或者根据最后一级name找id"></a>根据最后一级id找name，或者根据最后一级name找id</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      data: [&#123;</span><br><span class="line">        label: &#x27;一级 1&#x27;,</span><br><span class="line">        id: &#x27;1&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1&#x27;,</span><br><span class="line">          id: &#x27;11&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-1&#x27;,</span><br><span class="line">            id: &#x27;111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 2&#x27;,</span><br><span class="line">        id: &#x27;2&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-1&#x27;,</span><br><span class="line">          id: &#x27;21&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-1&#x27;,</span><br><span class="line">            id: &#x27;211&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.getGroupName(this.data, &#x27;111&#x27;)</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    getGroupName(data, idval) &#123;</span><br><span class="line">      let result = &#x27;&#x27;</span><br><span class="line">      if (!data) &#123;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      for (const item of data) &#123;</span><br><span class="line">        if (item.id === idval) &#123;</span><br><span class="line">          result = item.label</span><br><span class="line">          break</span><br><span class="line">        &#125; else if (item.children &amp;&amp; item.children.length &gt; 0) &#123;</span><br><span class="line">          const res = this.getGroupName(item.children, idval)</span><br><span class="line">          if (res) &#123; result = res; break &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return result</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>判断两数组是否一样</title>
    <url>/2021/11/02/38%E5%88%A4%E6%96%AD%E4%B8%A4%E6%95%B0%E7%BB%84%E6%98%AF%E5%90%A6%E4%B8%80%E6%A0%B7/</url>
    <content><![CDATA[<h1 id="判断两数组是否一样"><a href="#判断两数组是否一样" class="headerlink" title="判断两数组是否一样"></a>判断两数组是否一样</h1><h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// arr1//数组1</span></span><br><span class="line"><span class="comment">// arr2//数组2</span></span><br><span class="line">arr1.<span class="property">length</span> === arr2.<span class="property">length</span> &amp;&amp; arr1.<span class="title function_">every</span>(<span class="keyword">function</span>(<span class="params">v, i</span>) &#123; <span class="keyword">return</span> v === arr2[i] &#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>数据类型</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript最简洁根据parentId将数据递归成树状</title>
    <url>/2021/10/22/37js%E6%A0%B9%E6%8D%AEparentId%E5%B0%86%E6%95%B0%E6%8D%AE%E9%80%92%E5%BD%92%E6%88%90%E6%A0%91%E7%8A%B6/</url>
    <content><![CDATA[<h1 id="JavaScript最简洁根据parentId将数据递归成树状"><a href="#JavaScript最简洁根据parentId将数据递归成树状" class="headerlink" title="JavaScript最简洁根据parentId将数据递归成树状"></a>JavaScript最简洁根据parentId将数据递归成树状</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      // 假设数据如下</span><br><span class="line">      data: [</span><br><span class="line">        &#123; id: 2, name: &#x27;研发部&#x27;, parentId: 1 &#125;,</span><br><span class="line">        &#123; id: 4, name: &#x27;行政人事部&#x27;, parentId: 1 &#125;,</span><br><span class="line">        &#123; id: 6, name: &#x27;行政人事部下面的行政&#x27;, parentId: 4 &#125;,</span><br><span class="line">        &#123; id: 7, name: &#x27;行政人事部下面的人力资源&#x27;, parentId: 4 &#125;,</span><br><span class="line">        &#123; id: 20, name: &#x27;研发下面的产品组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 21, name: &#x27;研发下面的测试组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 22, name: &#x27;研发下面的运维组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 23, name: &#x27;研发下面的前端组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 24, name: &#x27;研发下面的后台组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 25, name: &#x27;研发下面的移动开发组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 99, name: &#x27;移动组下面的组&#x27;, parentId: 25 &#125;,</span><br><span class="line">        &#123; id: 98, name: &#x27;移动组下面的组&#x27;, parentId: 25 &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.formatToTree(this.data, 1)</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    formatToTree(ary, pid) &#123;</span><br><span class="line">      return ary</span><br><span class="line">        .filter((item) =&gt;</span><br><span class="line">        // pid父级id</span><br><span class="line">        // 如果没有父id（第一次递归的时候）将所有父级查询出来</span><br><span class="line">        // 这里认为 item.parentId === 1 就是最顶层 需要根据业务调整</span><br><span class="line">          pid === undefined ? item.parentId === 1 : item.parentId === pid</span><br><span class="line">        )</span><br><span class="line">        .map((item) =&gt; &#123;</span><br><span class="line">          // 通过父节点ID查询所有子节点</span><br><span class="line">          item.children = this.formatToTree(ary, item.id)</span><br><span class="line">          return item</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>vue请求后台JFIF格式文件流</title>
    <url>/2022/01/05/40vue%E8%AF%B7%E6%B1%82%E5%90%8E%E5%8F%B0JFIF%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6%E6%B5%81/</url>
    <content><![CDATA[<h1 id="vue请求后台JFIF格式文件流"><a href="#vue请求后台JFIF格式文件流" class="headerlink" title="vue请求后台JFIF格式文件流"></a>vue请求后台JFIF格式文件流</h1><h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//封装请求api（封装方式1）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getValidataCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/captcha.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">responseType</span>: <span class="string">&#x27;arraybuffer&#x27;</span><span class="comment">//重要设置</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 封装方式2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getJFIF</span>(<span class="params">url, params</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span>&#123;</span><br><span class="line">        axios.<span class="title function_">get</span>(url, &#123;</span><br><span class="line">            <span class="attr">params</span>: params,</span><br><span class="line">            <span class="attr">responseType</span>: <span class="string">&#x27;arraybuffer&#x27;</span></span><br><span class="line">        &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入封装方式1</span></span><br><span class="line"><span class="keyword">import</span> &#123;getValidataCode &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/login&#x27;</span></span><br><span class="line"><span class="comment">/* 获取验证码图片 */</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getCaptcha</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getValidataCode</span>()</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">captchaImg</span> = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res]))</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>文件流</tag>
      </tags>
  </entry>
  <entry>
    <title>锚点简单案例</title>
    <url>/2022/01/25/41%E9%94%9A%E7%82%B9%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B/</url>
    <content><![CDATA[<h1 id="锚点简单案例"><a href="#锚点简单案例" class="headerlink" title="锚点简单案例"></a>锚点简单案例</h1><h2 id="完整代码展示"><a href="#完整代码展示" class="headerlink" title="完整代码展示"></a>完整代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;anchor-point&quot;&gt;</span><br><span class="line">    &lt;!-- 滚动区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;scroll-content&quot; @scroll=&quot;onScroll&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: #3a8ee6;&quot;&gt;一层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: red;&quot;&gt;二层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: #42b983&quot;&gt;三层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 1000px;background: yellow;&quot;&gt;四层&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 按钮 --&gt;</span><br><span class="line">    &lt;div class=&quot;operation-btn&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        v-for=&quot;(item, index) in [&#x27;一层&#x27;,&#x27;二层&#x27;,&#x27;三层&#x27;,&#x27;四层&#x27;]&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        :style=&quot;&#123;background: activeStep === index ? &#x27;red&#x27; : &#x27;#ffffff&#x27;&#125;&quot;</span><br><span class="line">        @click=&quot;jump(index)&quot;</span><br><span class="line">      &gt;&#123;&#123; item &#125;&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      activeStep: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 滚动触发按钮高亮</span><br><span class="line">    onScroll(e) &#123;</span><br><span class="line">      const scrollItems = document.querySelectorAll(&#x27;.scroll-item&#x27;)</span><br><span class="line">      console.log(e, scrollItems)</span><br><span class="line">      for (let i = scrollItems.length - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">        // 判断滚动条滚动距离是否大于当前滚动项可滚动距离</span><br><span class="line">        const judge = e.target.scrollTop &gt;= scrollItems[i].offsetTop - scrollItems[0].offsetTop</span><br><span class="line">        if (judge) &#123;</span><br><span class="line">          this.activeStep = i</span><br><span class="line">          break</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    // 点击切换锚点</span><br><span class="line">    jump(index) &#123;</span><br><span class="line">      const target = document.querySelector(&#x27;.scroll-content&#x27;)</span><br><span class="line">      const scrollItems = document.querySelectorAll(&#x27;.scroll-item&#x27;)</span><br><span class="line">      // 判断滚动条是否滚动到底部</span><br><span class="line">      if (target.scrollHeight &lt;= target.scrollTop + target.clientHeight) &#123;</span><br><span class="line">        this.activeStep = index</span><br><span class="line">      &#125;</span><br><span class="line">      const total = scrollItems[index].offsetTop - scrollItems[0].offsetTop // 锚点元素距离其offsetParent(这里是body)顶部的距离(待滚动的距离)</span><br><span class="line">      let distance = document.querySelector(&#x27;.scroll-content&#x27;).scrollTop // 滚动条距离滚动区域顶部的距离</span><br><span class="line">      // let distance = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset // 滚动条距离滚动区域顶部的距离(滚动区域为窗口)</span><br><span class="line">      // 滚动动画实现, 使用setTimeout的递归实现平滑滚动，将距离细分为50小段，10ms滚动一次</span><br><span class="line">      // 计算每一小段的距离</span><br><span class="line">      let step = total / 50</span><br><span class="line">      if (total &gt; distance) &#123;</span><br><span class="line">        smoothDown(document.querySelector(&#x27;.scroll-content&#x27;))</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        const newTotal = distance - total</span><br><span class="line">        step = newTotal / 50</span><br><span class="line">        smoothUp(document.querySelector(&#x27;.scroll-content&#x27;))</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 参数element为滚动区域</span><br><span class="line">      function smoothDown(element) &#123;</span><br><span class="line">        if (distance &lt; total) &#123;</span><br><span class="line">          distance += step</span><br><span class="line">          element.scrollTop = distance</span><br><span class="line">          setTimeout(smoothDown.bind(this, element), 10)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          element.scrollTop = total</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 参数element为滚动区域</span><br><span class="line">      function smoothUp(element) &#123;</span><br><span class="line">        if (distance &gt; total) &#123;</span><br><span class="line">          distance -= step</span><br><span class="line">          element.scrollTop = distance</span><br><span class="line">          setTimeout(smoothUp.bind(this, element), 10)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          element.scrollTop = total</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // document.querySelectorAll(&#x27;.scroll-item&#x27;).forEach((item, index1) =&gt; &#123;</span><br><span class="line">      //   if (index === index1) &#123;</span><br><span class="line">      //     item.scrollIntoView(&#123;</span><br><span class="line">      //       block: &#x27;start&#x27;,</span><br><span class="line">      //       behavior: &#x27;smooth&#x27;</span><br><span class="line">      //     &#125;)</span><br><span class="line">      //   &#125;</span><br><span class="line">      // &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.anchor-point &#123;</span><br><span class="line">flex-basis: 100%;</span><br><span class="line">display: flex;</span><br><span class="line">overflow: hidden;</span><br><span class="line">.scroll-content &#123;</span><br><span class="line">  height: 500px;</span><br><span class="line">  width: 90%;</span><br><span class="line">  overflow: scroll;</span><br><span class="line">&#125;</span><br><span class="line">.operation-btn &#123;</span><br><span class="line">  width: 10%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>锚点</tag>
      </tags>
  </entry>
  <entry>
    <title>iframe嵌套合作伙伴项目</title>
    <url>/2022/02/18/42iframe%E5%B5%8C%E5%A5%97%E5%90%88%E4%BD%9C%E4%BC%99%E4%BC%B4%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<h1 id="iframe嵌套合作伙伴项目"><a href="#iframe嵌套合作伙伴项目" class="headerlink" title="iframe嵌套合作伙伴项目"></a>iframe嵌套合作伙伴项目</h1><h2 id="ifram之间的传值"><a href="#ifram之间的传值" class="headerlink" title="ifram之间的传值"></a>ifram之间的传值</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;iframe</span><br><span class="line">      key=<span class="string">&quot;jiesuan&quot;</span></span><br><span class="line">      ref=<span class="string">&quot;child&quot;</span></span><br><span class="line">      id=<span class="string">&quot;settlementCenter&quot;</span></span><br><span class="line">      <span class="keyword">class</span>=<span class="string">&quot;layadmin-iframe iframe-main settlementCenter&quot;</span></span><br><span class="line">      :src=<span class="string">&quot;`http://(合作伙伴ip地址)?clientId=SETTLE-CENTER&amp;responseType=code&amp;token=$&#123;token&#125;`&quot;</span> <span class="comment">//和后端第定义传的参数</span></span><br><span class="line">      width=<span class="string">&quot;100%&quot;</span></span><br><span class="line">      height=<span class="string">&quot;100%&quot;</span></span><br><span class="line">      marginwidth=<span class="string">&quot;0&quot;</span></span><br><span class="line">      marginheight=<span class="string">&quot;0&quot;</span></span><br><span class="line">      scrolling=<span class="string">&quot;yes&quot;</span></span><br><span class="line">      allowtransparency=<span class="string">&quot;yes&quot;</span></span><br><span class="line">      frameborder=<span class="string">&quot;0&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//跨域通讯</span></span><br><span class="line"><span class="comment">// 子传父postMessage</span></span><br><span class="line"><span class="comment">// 子页面可在vue页面或者js文件写</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;token失效，请重新登录！&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"><span class="comment">// 父在iframe标签的页面写</span></span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 父接收子的信息-------------------------------------------------------------------</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(ev)</span><br><span class="line">    &#125;, <span class="literal">false</span>)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//父传子步骤</span></span><br><span class="line">$(<span class="string">&#x27;#my-iframe&#x27;</span>).<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;www&#x27;</span>,</span><br><span class="line">  <span class="attr">ctx</span>: <span class="string">&#x27;给你消息，收到了嘛?&#x27;</span></span><br><span class="line">&#125;), <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子项目接收</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(ev)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

<h2 id="之间的token值替换"><a href="#之间的token值替换" class="headerlink" title="之间的token值替换"></a>之间的token值替换</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//嵌入其他项目的页面时要去掉旧项目的token</span></span><br><span class="line"><span class="comment">// 路由配置在路由守卫处理</span></span><br><span class="line"><span class="comment">// &lt;!-- http://localhost:21444/sett/#/access_token=$&#123;token&#125;&amp;userName=admin --&gt;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NProgress</span> <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span> <span class="comment">// progress bar</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;nprogress/nprogress.css&#x27;</span> <span class="comment">// progress bar style</span></span><br><span class="line"><span class="keyword">import</span> &#123; getToken, setToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span> <span class="comment">// get token from cookie</span></span><br><span class="line"><span class="keyword">import</span> getPageTitle <span class="keyword">from</span> <span class="string">&#x27;@/utils/get-page-title&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; sleep &#125; <span class="keyword">from</span> <span class="string">&#x27;./authorities&#x27;</span></span><br><span class="line"><span class="title class_">NProgress</span>.<span class="title function_">configure</span>(&#123; <span class="attr">showSpinner</span>: <span class="literal">false</span> &#125;) <span class="comment">// NProgress Configuration</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span>(to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">20</span>)</span><br><span class="line">  <span class="comment">// 检查hash中的token</span></span><br><span class="line">  <span class="comment">// 检查hash中的token</span></span><br><span class="line">  <span class="keyword">const</span> tokenMap = <span class="title function_">checkAndDealHashToken</span>()</span><br><span class="line">  tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>) &amp;&amp; <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;userName&#x27;</span>, tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>))</span><br><span class="line">  <span class="comment">// hash中的token需要处理掉</span></span><br><span class="line">  <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;success&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">replace</span>(<span class="string">&#x27;sett/dashboard&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> === <span class="string">&#x27;agency&#x27;</span> &amp;&amp;</span><br><span class="line">      to.<span class="property">path</span> !== <span class="string">&#x27;/404&#x27;</span> &amp;&amp;</span><br><span class="line">      !to.<span class="property">path</span>.<span class="title function_">includes</span>(<span class="string">&#x27;agency&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> + store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> + to.<span class="property">path</span>, <span class="attr">query</span>: to.<span class="property">query</span> &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 由于天翼物联嵌入内部系统，暂时不移除token</span></span><br><span class="line">    <span class="comment">// window.location.href = location.href.replace(location.hash, &#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> === <span class="string">&#x27;agency&#x27;</span> &amp;&amp;</span><br><span class="line">      to.<span class="property">path</span> !== <span class="string">&#x27;/404&#x27;</span> &amp;&amp;</span><br><span class="line">      !to.<span class="property">path</span>.<span class="title function_">includes</span>(<span class="string">&#x27;agency&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> + store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> + to.<span class="property">path</span>, <span class="attr">query</span>: to.<span class="property">query</span> &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ---------------------------------------------------------------------------------------------------</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeResolve</span>(<span class="title function_">async</span>(to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 从路由配置中取回menuCode</span></span><br><span class="line">  <span class="keyword">const</span> menuCode = to.<span class="property">meta</span>.<span class="property">menuCode</span></span><br><span class="line">  <span class="keyword">if</span> (menuCode) &#123;</span><br><span class="line">    <span class="comment">// 触发layout的菜单匹配</span></span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;checkBaseUrl/SET_BASE_URL&#x27;</span>, to.<span class="property">meta</span>.<span class="property">menuCode</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> setToken = <span class="title function_">getToken</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 权限点</span></span><br><span class="line">  <span class="comment">// start progress bar</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">start</span>()</span><br><span class="line">  <span class="comment">// set page title</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">title</span> = <span class="title function_">getPageTitle</span>(to.<span class="property">meta</span>.<span class="property">title</span>)</span><br><span class="line">  <span class="keyword">if</span> (!setToken &amp;&amp; to.<span class="property">path</span> !== <span class="string">&#x27;/Login&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// next(&#x27;/Login&#x27;)</span></span><br><span class="line">    <span class="comment">// removeToken()</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;token失效，请重新登录！&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (setToken &amp;&amp; to.<span class="property">path</span> === <span class="string">&#x27;/Login&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">next</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否有hash值并放入cookie</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkAndDealHashToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 后端定会返回带token和用户名的字符串</span></span><br><span class="line">  <span class="comment">// http://localhost:21444/sett/#/access_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTY3NzgzNzE0NCwiaWF0IjoxNjc3ODA4MzQ0LCJjcmVhdGVkIjoxNjc3ODA4MzQ0Mzg2LCJhdXRob3JpdGllcyI6W3siYXV0aG9yaXR5Ijoic3lzOnVzZXI6dmlldyJ9LHsiYXV0aG9yaXR5IjoiICJ9LHsiYXV0aG9yaXR5Ijoic3lzOnJvbGU6c2F2ZSJ9LHsiYXV0aG9yaXR5Ijoic3lzOnJvbGU6dmlldyJ9XX0.NrORHccsvkK8PyllHUfndV3Fd8olDuFfAlwVSed2NwQEMK9QXTBZY7mogvDPLGLrVUk-d4wdfJiJYP-4vArX5w&amp;userName=admin</span></span><br><span class="line">  <span class="comment">// &lt;1&gt; 获取 location 中的hash信息，也就是 #后边的内容</span></span><br><span class="line">  <span class="keyword">let</span> tokenStr = location.<span class="property">hash</span></span><br><span class="line">  <span class="comment">// 存储令牌信息</span></span><br><span class="line">  <span class="keyword">const</span> tokenMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  <span class="comment">// 默认失败</span></span><br><span class="line">  tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;success&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// 清除hash值，不然无限循环</span></span><br><span class="line">  <span class="keyword">if</span> (tokenStr !== <span class="literal">null</span> &amp;&amp; tokenStr !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 有hash值需要清理</span></span><br><span class="line">    tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;success&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// 去除第一个#号</span></span><br><span class="line">    <span class="keyword">if</span> (tokenStr.<span class="title function_">startsWith</span>(<span class="string">&#x27;#&#x27;</span>)) &#123;</span><br><span class="line">      tokenStr = tokenStr.<span class="title function_">replace</span>(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (tokenStr != <span class="literal">null</span> &amp;&amp; tokenStr !== <span class="literal">undefined</span> &amp;&amp; tokenStr !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 通过&amp;符号分割</span></span><br><span class="line">        <span class="keyword">const</span> tokenArray = tokenStr.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">        <span class="comment">// 转为key存储形式</span></span><br><span class="line">        tokenArray.<span class="title function_">forEach</span>(<span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> strArr = str.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">          tokenMap.<span class="title function_">set</span>(strArr[<span class="number">0</span>], strArr[<span class="number">1</span>])</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;/access_token&#x27;</span>) &amp;&amp; !<span class="title function_">getToken</span>()) &#123;</span><br><span class="line">          <span class="comment">// localStorage.setItem(&#x27;token&#x27;, tokenMap.get(&#x27;/access_token&#x27;))</span></span><br><span class="line">          <span class="title function_">setToken</span>(tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;/access_token&#x27;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// token放置到cookie</span></span><br><span class="line">        <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="comment">// const token = Cookies.get(&#x27;token&#x27;)</span></span><br><span class="line">          <span class="keyword">const</span> token = <span class="title function_">getToken</span>()</span><br><span class="line">          <span class="comment">// token不相等，重新替换</span></span><br><span class="line">          <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>) !== token) &#123;</span><br><span class="line">            <span class="comment">// 存储</span></span><br><span class="line">            <span class="comment">// Cookies.set(&#x27;token&#x27;, tokenMap.get(&#x27;access_token&#x27;))</span></span><br><span class="line">            <span class="title function_">setToken</span>(tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 放入cookie中的token到map中</span></span><br><span class="line">  tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;access_token&#x27;</span>, <span class="title function_">getToken</span>())</span><br><span class="line">  <span class="keyword">return</span> tokenMap</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// finish progress bar</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>iframe</tag>
      </tags>
  </entry>
  <entry>
    <title>拦截器写法(1)及封装请求方法</title>
    <url>/2022/02/24/43%E6%8B%A6%E6%88%AA%E5%99%A8%E5%86%99%E6%B3%95(1)%E5%8F%8A%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="拦截器写法-1-及封装请求方法"><a href="#拦截器写法-1-及封装请求方法" class="headerlink" title="拦截器写法(1)及封装请求方法"></a>拦截器写法(1)及封装请求方法</h1><blockquote>
<p>路径：src\utils\auth.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Cookies</span> <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TokenKey</span> = <span class="string">&#x27;hrToken&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">get</span>(<span class="title class_">TokenKey</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">setToken</span>(<span class="params">token</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">set</span>(<span class="title class_">TokenKey</span>, token)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">removeToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">remove</span>(<span class="title class_">TokenKey</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：src\utils\request.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Message</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serviceObj = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an axios instance</span></span><br><span class="line"><span class="comment">// 创建实例化</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">// 环境变量改变会随之改变----生成----开发----env文件</span></span><br><span class="line">  <span class="attr">baseURL</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>, <span class="comment">// url = base url + request url</span></span><br><span class="line">  <span class="comment">// withCredentials: true, // send cookies when cross-domain requests</span></span><br><span class="line">  <span class="comment">// 超时时间</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// request interceptor请求拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">    <span class="comment">// 主动介入</span></span><br><span class="line">    <span class="keyword">const</span> loginTime = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;setTimeOut&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> loginTimeOut = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">    <span class="keyword">const</span> isTimeOut = (loginTimeOut - loginTime) &gt; <span class="number">864000000</span></span><br><span class="line">    <span class="comment">// 判断是否超时退出登录</span></span><br><span class="line">    <span class="keyword">if</span> (isTimeOut) &#123;</span><br><span class="line">      store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/logout&#x27;</span>)</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;已超时(主动)&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果token存在 注入token</span></span><br><span class="line">    config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;store.getters.token&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 一定要返回值</span></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line">,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// do something with request error</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error) <span class="comment">// for debug</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// response interceptor响应拦截器 两个参数</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 成功的回调(网络层面)解构出请求成功的布尔值和token</span></span><br><span class="line">  <span class="keyword">const</span> &#123; success, data, message &#125; = res.<span class="property">data</span></span><br><span class="line">  <span class="keyword">if</span> (success) &#123;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 失败</span></span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(message)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 被动处理退出登录</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">response</span> &amp;&amp; err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">code</span> === <span class="number">10002</span>) &#123;</span><br><span class="line">    store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/logout&#x27;</span>)</span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 失败的回调(网络层面)</span></span><br><span class="line">  <span class="title class_">Message</span>.<span class="title function_">error</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// 则停止当前执行请求--直接走到catch抛出错误</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="number">39</span>, err))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">serviceObj.<span class="property">get</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">get</span>(url, &#123; <span class="attr">params</span>: data,</span><br><span class="line">      <span class="attr">responseType</span>: options &amp;&amp; options.<span class="property">responseType</span> ? options.<span class="property">responseType</span> : <span class="string">&#x27;text&#x27;</span> &#125;, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">post</span> = <span class="keyword">function</span>(<span class="params">url, data = &#123;&#125;, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">post</span>(url, data, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: options &amp;&amp; options.<span class="property">timeOut</span> ? options.<span class="property">timeOut</span> : <span class="number">60000</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: options &amp;&amp; options.<span class="property">contentType</span> ? options.<span class="property">contentType</span> : <span class="string">&#x27;application/json;charset=utf-8&#x27;</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">patch</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">patch</span>(url, data, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">delete</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">delete</span>(url, &#123; <span class="attr">data</span>: data &#125;, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logOut</span>(<span class="params">message</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (message === <span class="string">&#x27;登陆超时&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// sessionStorage.clear()</span></span><br><span class="line">    <span class="comment">// window.location.href = &#x27;/login&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">downLoads</span> = <span class="keyword">function</span>(<span class="params">url, data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">axios</span>(&#123;</span><br><span class="line">      <span class="attr">baseURL</span>: baseURL,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">      <span class="attr">url</span>: url,</span><br><span class="line">      <span class="attr">headers</span>: &#123; <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`Bearer <span class="subst">$&#123;getSessionToken()&#125;</span>`</span> &#125;,</span><br><span class="line">      <span class="attr">responseType</span>: <span class="string">&#x27;blob&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: data</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> file = res.<span class="property">headers</span>[<span class="string">&#x27;content-disposition&#x27;</span>]</span><br><span class="line">      file = file ? file.<span class="title function_">split</span>(<span class="string">&#x27;filename=&#x27;</span>)[<span class="number">1</span>] : <span class="string">&#x27;无描述文件.xls&#x27;</span></span><br><span class="line">      file = <span class="built_in">decodeURI</span>(file)</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">navigator</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="property">msSaveOrOpenBlob</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> csvData = <span class="keyword">new</span> <span class="title class_">Blob</span>([res.<span class="property">data</span>], &#123; <span class="attr">type</span>: <span class="string">&#x27;application/vnd.ms-excel&#x27;</span> &#125;)</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="title function_">msSaveOrOpenBlob</span>(csvData, file)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> url = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res.<span class="property">data</span>]))</span><br><span class="line">        <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        link.<span class="property">href</span> = url</span><br><span class="line">        link.<span class="property">download</span> = file</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link)</span><br><span class="line">        link.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link)</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(url)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// handlerResponseError(error.response.data)</span></span><br><span class="line">      <span class="comment">// console.log(error.response.data)</span></span><br><span class="line">      <span class="comment">// Message.error(error.message)</span></span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：.env.development（环境变量文件配置）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># just a flag</span><br><span class="line">ENV = &#x27;development&#x27;</span><br><span class="line"></span><br><span class="line"># base api</span><br><span class="line">VUE_APP_BASE_API = &#x27;/api&#x27;</span><br><span class="line"></span><br><span class="line">port=8080</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：vue.config.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> defaultSettings = <span class="built_in">require</span>(<span class="string">&#x27;./src/settings.js&#x27;</span>)</span><br><span class="line"><span class="comment">// 排除 elementUI xlsx  和 vue</span></span><br><span class="line"><span class="keyword">const</span> externals =</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="string">&#x27;vue&#x27;</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;element-ui&#x27;</span>: <span class="string">&#x27;ELEMENT&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;xlsx&#x27;</span>: <span class="string">&#x27;XLSX&#x27;</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cdn = &#123;</span><br><span class="line">  <span class="attr">css</span>: [</span><br><span class="line">    <span class="comment">// element-ui css</span></span><br><span class="line">    <span class="string">&#x27;https://unpkg.com/element-ui/lib/theme-chalk/index.css&#x27;</span> <span class="comment">// 样式表</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">js</span>: [</span><br><span class="line">    <span class="comment">// vue must at first!</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.bootcdn.net/ajax/libs/vue/2.6.10/vue.common.dev.js&#x27;</span>, <span class="comment">// vuejs</span></span><br><span class="line">    <span class="comment">// element-ui js</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.3/index.js&#x27;</span>, <span class="comment">// elementUI</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/jszip.min.js&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/xlsx.full.min.js&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resolve</span>(<span class="params">dir</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> path.<span class="title function_">join</span>(__dirname, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 网站标题名称</span></span><br><span class="line"><span class="keyword">const</span> name = defaultSettings.<span class="property">title</span> || <span class="string">&#x27;vue Admin Template&#x27;</span> <span class="comment">// page title</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// If your port is set to 80,</span></span><br><span class="line"><span class="comment">// use administrator privileges to execute the command line.</span></span><br><span class="line"><span class="comment">// For example, Mac: sudo npm run</span></span><br><span class="line"><span class="comment">// You can change the port by the following methods:</span></span><br><span class="line"><span class="comment">// port = 9528 npm run dev OR npm run dev --port = 9528</span></span><br><span class="line"><span class="comment">// 端口</span></span><br><span class="line"><span class="keyword">const</span> port = process.<span class="property">env</span>.<span class="property">port</span> || process.<span class="property">env</span>.<span class="property">npm_config_port</span> || <span class="number">9528</span> <span class="comment">// dev port</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// All configuration item explanations can be find in https://cli.vuejs.org/config/</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * You will need to set publicPath if you plan to deploy your site under a sub path,</span></span><br><span class="line"><span class="comment">   * for example GitHub Pages. If you plan to deploy your site to https://foo.github.io/bar/,</span></span><br><span class="line"><span class="comment">   * then publicPath should be set to &quot;/bar/&quot;.</span></span><br><span class="line"><span class="comment">   * In most cases please use &#x27;/&#x27; !!!</span></span><br><span class="line"><span class="comment">   * Detail: https://cli.vuejs.org/config/#publicpath</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">publicPath</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="attr">outputDir</span>: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">  <span class="attr">assetsDir</span>: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">  <span class="attr">lintOnSave</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">productionSourceMap</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: port,</span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">overlay</span>: &#123;</span><br><span class="line">      <span class="attr">warnings</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">errors</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://ihrm-java.itheima.net/&#x27;</span>,</span><br><span class="line">        <span class="comment">// target: &#x27;http://192.168.108.90:3000&#x27;,</span></span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">configureWebpack</span>: &#123;</span><br><span class="line">    externals,</span><br><span class="line">    <span class="comment">// provide the app&#x27;s title in webpack&#x27;s name field, so that</span></span><br><span class="line">    <span class="comment">// it can be accessed in index.html to inject the correct title.</span></span><br><span class="line">    <span class="attr">name</span>: name,</span><br><span class="line">    <span class="attr">resolve</span>: &#123;</span><br><span class="line">      <span class="attr">alias</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;@&#x27;</span>: <span class="title function_">resolve</span>(<span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">chainWebpack</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    config.<span class="title function_">plugin</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">tap</span>(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      args[<span class="number">0</span>].<span class="property">cdn</span> = cdn</span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// it can improve the speed of the first screen, it is recommended to turn on preload</span></span><br><span class="line">    config.<span class="title function_">plugin</span>(<span class="string">&#x27;preload&#x27;</span>).<span class="title function_">tap</span>(<span class="function">() =&gt;</span> [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">rel</span>: <span class="string">&#x27;preload&#x27;</span>,</span><br><span class="line">        <span class="comment">// to ignore runtime.js</span></span><br><span class="line">        <span class="comment">// https://github.com/vuejs/vue-cli/blob/dev/packages/@vue/cli-service/lib/config/app.js#L171</span></span><br><span class="line">        <span class="attr">fileBlacklist</span>: [<span class="regexp">/\.map$/</span>, <span class="regexp">/hot-update\.js$/</span>, <span class="regexp">/runtime\..*\.js$/</span>],</span><br><span class="line">        <span class="attr">include</span>: <span class="string">&#x27;initial&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// when there are many pages, it will cause too many meaningless requests</span></span><br><span class="line">    config.<span class="property">plugins</span>.<span class="title function_">delete</span>(<span class="string">&#x27;prefetch&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set svg-sprite-loader</span></span><br><span class="line">    config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;svg&#x27;</span>)</span><br><span class="line">      .<span class="property">exclude</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">    config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;icons&#x27;</span>)</span><br><span class="line">      .<span class="title function_">test</span>(<span class="regexp">/\.svg$/</span>)</span><br><span class="line">      .<span class="property">include</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">      .<span class="title function_">use</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">loader</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">options</span>(&#123;</span><br><span class="line">        <span class="attr">symbolId</span>: <span class="string">&#x27;icon-[name]&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line"></span><br><span class="line">    config</span><br><span class="line">      .<span class="title function_">when</span>(process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">        <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">          config</span><br><span class="line">            .<span class="title function_">plugin</span>(<span class="string">&#x27;ScriptExtHtmlWebpackPlugin&#x27;</span>)</span><br><span class="line">            .<span class="title function_">after</span>(<span class="string">&#x27;html&#x27;</span>)</span><br><span class="line">            .<span class="title function_">use</span>(<span class="string">&#x27;script-ext-html-webpack-plugin&#x27;</span>, [&#123;</span><br><span class="line">              <span class="comment">// `runtime` must same as runtimeChunk name. default is `runtime`</span></span><br><span class="line">              <span class="attr">inline</span>: <span class="regexp">/runtime\..*\.js$/</span></span><br><span class="line">            &#125;])</span><br><span class="line">            .<span class="title function_">end</span>()</span><br><span class="line">          config</span><br><span class="line">            .<span class="property">optimization</span>.<span class="title function_">splitChunks</span>(&#123;</span><br><span class="line">              <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">              <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">                <span class="attr">libs</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-libs&#x27;</span>,</span><br><span class="line">                  <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">10</span>,</span><br><span class="line">                  <span class="attr">chunks</span>: <span class="string">&#x27;initial&#x27;</span> <span class="comment">// only package third parties that are initially dependent</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">elementUI</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-elementUI&#x27;</span>, <span class="comment">// split elementUI into a single package</span></span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">20</span>, <span class="comment">// the weight needs to be larger than libs and app or it will be packaged into libs or app</span></span><br><span class="line">                  <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]_?element-ui(.*)/</span> <span class="comment">// in order to adapt to cnpm</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">commons</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-commons&#x27;</span>,</span><br><span class="line">                  <span class="attr">test</span>: <span class="title function_">resolve</span>(<span class="string">&#x27;src/components&#x27;</span>), <span class="comment">// can customize your rules</span></span><br><span class="line">                  <span class="attr">minChunks</span>: <span class="number">3</span>, <span class="comment">//  minimum common number</span></span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">5</span>,</span><br><span class="line">                  <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          <span class="comment">// https:// webpack.js.org/configuration/optimization/#optimizationruntimechunk</span></span><br><span class="line">          config.<span class="property">optimization</span>.<span class="title function_">runtimeChunk</span>(<span class="string">&#x27;single&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：src\store\modules\user.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入登录接口</span></span><br><span class="line"><span class="keyword">import</span> &#123; login, getUserInfo, getUserById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"><span class="comment">// 导入cookie封装的函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; setToken, getToken, removeToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; resetRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="comment">// 定义公共数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="comment">// 定义token变量</span></span><br><span class="line">  <span class="attr">token</span>: <span class="title function_">getToken</span>() || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="comment">// 定义用户信息变量</span></span><br><span class="line">  <span class="attr">userInfo</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line"><span class="comment">// 修改token值--异步修改</span></span><br><span class="line">  <span class="title function_">changeToken</span>(<span class="params">state, data</span>) &#123;</span><br><span class="line">    <span class="comment">// 持久保存token</span></span><br><span class="line">    <span class="comment">// localStorage.setItem(&#x27;hrToken&#x27;, data)</span></span><br><span class="line">    <span class="title function_">setToken</span>(data)</span><br><span class="line">    state.<span class="property">token</span> = data</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 删除token</span></span><br><span class="line">  <span class="title function_">removeToken</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">token</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="title function_">removeToken</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 修改userInfo的值</span></span><br><span class="line">  <span class="title function_">changeUserInfo</span>(<span class="params">state, data</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = &#123; ...data &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 删除用户信息</span></span><br><span class="line">  <span class="title function_">removeuserInfo</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = &#123; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// 异步修改-必修通过mutations</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">store, data</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">login</span>(data)</span><br><span class="line">    <span class="comment">// //console.log(&#x27;成功&#x27;, res)</span></span><br><span class="line">    <span class="comment">// 修改通过mutations</span></span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;changeToken&#x27;</span>, res)</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;setTimeOut&#x27;</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>())</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserInfo</span>(<span class="params">store, data</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>(data)</span><br><span class="line">    <span class="keyword">const</span> userRes = <span class="keyword">await</span> <span class="title function_">getUserById</span>(res.<span class="property">userId</span>)</span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;changeUserInfo&#x27;</span>, &#123; ...res, ...userRes &#125;)</span><br><span class="line">    <span class="comment">// //console.log(&#123; ...res, ...userRes &#125;)</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">logout</span>(<span class="params">stroe</span>) &#123;</span><br><span class="line">    stroe.<span class="title function_">commit</span>(<span class="string">&#x27;removeToken&#x27;</span>)</span><br><span class="line">    stroe.<span class="title function_">commit</span>(<span class="string">&#x27;removeuserInfo&#x27;</span>)</span><br><span class="line">    <span class="title function_">resetRouter</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// getter文件</span></span><br><span class="line">    <span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="attr">token</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">user</span>.<span class="property">token</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters</span><br><span class="line"></span><br><span class="line"><span class="comment">// api文件</span></span><br><span class="line">    <span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/sys/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">     <span class="comment">// 点击登录按钮--</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleLogin</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">loginForm</span>.<span class="title function_">validate</span>()</span><br><span class="line">      <span class="comment">// 发起请求</span></span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/login&#x27;</span>, <span class="variable language_">this</span>.<span class="property">loginForm</span>)</span><br><span class="line">      <span class="comment">// 提示用户</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&#x27;登录成功&#x27;</span>)</span><br><span class="line">      <span class="comment">// 跳转页面</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <tags>
        <tag>api</tag>
      </tags>
  </entry>
  <entry>
    <title>简单的富文本wangeditor</title>
    <url>/2021/11/18/39%E7%AE%80%E5%8D%95%E7%9A%84%E5%AF%8C%E6%96%87%E6%9C%ACwangeditor/</url>
    <content><![CDATA[<h1 id="简单的富文本wangeditor"><a href="#简单的富文本wangeditor" class="headerlink" title="简单的富文本wangeditor"></a>简单的富文本wangeditor</h1><h2 id="依赖包准备"><a href="#依赖包准备" class="headerlink" title="依赖包准备"></a>依赖包准备</h2><blockquote>
<p>下载依赖 npm i wangeditor<br>版本号：4.7.15</p>
</blockquote>
<h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;editor&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-top:20px&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;getEditorContent&quot;</span>&gt;</span>获取内容<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> E <span class="keyword">from</span> <span class="string">&#x27;wangeditor&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;WangEditor&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">components</span>: &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">editor</span>: <span class="literal">null</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">created</span>(<span class="params"></span>) &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="title function_">createEditor</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 创建富文本</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">createEditor</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">editor</span> = <span class="keyword">new</span> <span class="title function_">E</span>(<span class="string">&#x27;#editor&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> &#123; editor &#125; = <span class="variable language_">this</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="property">config</span>.<span class="property">uploadImgServer</span> = <span class="string">&#x27;/upload-img&#x27;</span> <span class="comment">// 服务器上传图片接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 设置编辑区域高度为 500px</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="property">config</span>.<span class="property">height</span> = <span class="number">500</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="title function_">create</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 获取富文本内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">getEditorContent</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">editor</span>.<span class="property">txt</span>.<span class="title function_">html</span>())</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.left-menu</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.main</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">flex</span>: <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>富文本</tag>
      </tags>
  </entry>
  <entry>
    <title>响应拦截器的另一种写法</title>
    <url>/2022/03/18/44%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E5%86%99%E6%B3%95/</url>
    <content><![CDATA[<h1 id="响应拦截器的另一种写法"><a href="#响应拦截器的另一种写法" class="headerlink" title="响应拦截器的另一种写法"></a>响应拦截器的另一种写法</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// response interceptor</span></span><br><span class="line">https.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">getSessionToken</span>(<span class="string">&#x27;billing-token&#x27;</span>)</span><br><span class="line">    <span class="comment">// 从头部取token，根据项目实际情况做调整</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> response.<span class="property">data</span> === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        response.<span class="property">data</span>.<span class="property">token</span> = token</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// setToken(response.headers[&#x27;token&#x27;])</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">errorCode</span> &amp;&amp; response.<span class="property">data</span>.<span class="property">errorCode</span> === <span class="string">&#x27;408&#x27;</span>) &#123;</span><br><span class="line">      store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/getToken&#x27;</span>)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (res) &#123;</span><br><span class="line">            <span class="title function_">setSessionToken</span>(res)</span><br><span class="line">            response.<span class="property">config</span>.<span class="property">baseURL</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 重新请求无需baseURL</span></span><br><span class="line">            <span class="title function_">https</span>(response.<span class="property">config</span>) <span class="comment">// 重新发起失败请求</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.<span class="property">message</span> = response.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? response.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">            <span class="title function_">removeSessionToken</span>()</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">BssLayout</span>.<span class="property">console</span>.<span class="title function_">goLogin</span>()</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span> ? response.<span class="property">data</span> : &#123; <span class="attr">code</span>: <span class="string">&#x27;200&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;请求成功&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err &amp;&amp; err.<span class="property">response</span>) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (err.<span class="property">response</span>.<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;请求出错&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;登陆超时&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;拒绝访问&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;请求错误,未找到该资源&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          <span class="comment">// 权限不足不做拦截重新获取token  408 拦截无效和过期做重新请求token</span></span><br><span class="line">          <span class="keyword">if</span> (err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorCode</span> &amp;&amp; err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorCode</span> === <span class="string">&#x27;408&#x27;</span>) &#123;</span><br><span class="line">            store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/getToken&#x27;</span>)</span><br><span class="line">              .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                  <span class="title function_">setSessionToken</span>(res)</span><br><span class="line">                  err.<span class="property">config</span>.<span class="property">baseURL</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 重新请求无需baseURL</span></span><br><span class="line">                  <span class="title function_">https</span>(err.<span class="property">config</span>) <span class="comment">// 重新发起失败请求</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">                  <span class="title function_">removeSessionToken</span>()</span><br><span class="line">                  <span class="variable language_">window</span>.<span class="property">BssLayout</span>.<span class="property">console</span>.<span class="title function_">goLogin</span>()</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">502</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ECONNABORTED&#x27;</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;请求超时&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      err.<span class="property">message</span> = <span class="string">&#x27;连接服务器超时&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>api</tag>
      </tags>
  </entry>
  <entry>
    <title>this.$router.options.routes 可以拿到初始化时配置的路由规则</title>
    <url>/2022/03/20/45$router.options.routes/</url>
    <content><![CDATA[<h1 id="this-router-options-routes-可以拿到初始化时配置的路由规则"><a href="#this-router-options-routes-可以拿到初始化时配置的路由规则" class="headerlink" title="this.$router.options.routes 可以拿到初始化时配置的路由规则"></a>this.$router.options.routes 可以拿到初始化时配置的路由规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="property">options</span>.<span class="property">routes</span> 可以拿到初始化时配置的路由规则 </span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>router</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出xlsx文件</title>
    <url>/2022/03/24/46%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BAxlsx%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="纯前端导出xlsx文件"><a href="#纯前端导出xlsx文件" class="headerlink" title="纯前端导出xlsx文件"></a>纯前端导出xlsx文件</h1><h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><blockquote>
<p>下载依赖：npm i file-saver <a href="mailto:&#120;&#x6c;&#115;&#120;&#x40;&#48;&#46;&#x31;&#52;&#x2e;&#x31;">&#120;&#x6c;&#115;&#120;&#x40;&#48;&#46;&#x31;&#52;&#x2e;&#x31;</a></p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><blockquote>
<p>在封装插件的文件夹下创建 Export2Excel.js</p>
</blockquote>
<p>下面代码全复制到Export2Excel.js中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="keyword">import</span> &#123; saveAs &#125; <span class="keyword">from</span> <span class="string">&#x27;file-saver&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">XLSX</span> <span class="keyword">from</span> <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">XLSX</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateArray</span>(<span class="params">table</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> out = [];</span><br><span class="line">  <span class="keyword">var</span> rows = table.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;tr&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> ranges = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R &lt; rows.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">var</span> outRow = [];</span><br><span class="line">    <span class="keyword">var</span> row = rows[R];</span><br><span class="line">    <span class="keyword">var</span> columns = row.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;td&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C &lt; columns.<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">var</span> cell = columns[C];</span><br><span class="line">      <span class="keyword">var</span> colspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&#x27;colspan&#x27;</span>);</span><br><span class="line">      <span class="keyword">var</span> rowspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&#x27;rowspan&#x27;</span>);</span><br><span class="line">      <span class="keyword">var</span> cellValue = cell.<span class="property">innerText</span>;</span><br><span class="line">      <span class="keyword">if</span> (cellValue !== <span class="string">&quot;&quot;</span> &amp;&amp; cellValue == +cellValue) cellValue = +cellValue;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Skip ranges</span></span><br><span class="line">      ranges.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">range</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (R &gt;= range.<span class="property">s</span>.<span class="property">r</span> &amp;&amp; R &lt;= range.<span class="property">e</span>.<span class="property">r</span> &amp;&amp; outRow.<span class="property">length</span> &gt;= range.<span class="property">s</span>.<span class="property">c</span> &amp;&amp; outRow.<span class="property">length</span> &lt;= range.<span class="property">e</span>.<span class="property">c</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= range.<span class="property">e</span>.<span class="property">c</span> - range.<span class="property">s</span>.<span class="property">c</span>; ++i) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Row Span</span></span><br><span class="line">      <span class="keyword">if</span> (rowspan || colspan) &#123;</span><br><span class="line">        rowspan = rowspan || <span class="number">1</span>;</span><br><span class="line">        colspan = colspan || <span class="number">1</span>;</span><br><span class="line">        ranges.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">s</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">e</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R + rowspan - <span class="number">1</span>,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span> + colspan - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Value</span></span><br><span class="line">      outRow.<span class="title function_">push</span>(cellValue !== <span class="string">&quot;&quot;</span> ? cellValue : <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Colspan</span></span><br><span class="line">      <span class="keyword">if</span> (colspan)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; colspan - <span class="number">1</span>; ++k) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    out.<span class="title function_">push</span>(outRow);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [out, ranges];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">datenum</span>(<span class="params">v, date1904</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (date1904) v += <span class="number">1462</span>;</span><br><span class="line">  <span class="keyword">var</span> epoch = <span class="title class_">Date</span>.<span class="title function_">parse</span>(v);</span><br><span class="line">  <span class="keyword">return</span> (epoch - <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">UTC</span>(<span class="number">1899</span>, <span class="number">11</span>, <span class="number">30</span>))) / (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sheet_from_array_of_arrays</span>(<span class="params">data, opts</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ws = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> range = &#123;</span><br><span class="line">    <span class="attr">s</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">10000000</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">10000000</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">e</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R != data.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C != data[R].<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">r</span> &gt; R) range.<span class="property">s</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &gt; C) range.<span class="property">s</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">r</span> &lt; R) range.<span class="property">e</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">c</span> &lt; C) range.<span class="property">e</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">var</span> cell = &#123;</span><br><span class="line">        <span class="attr">v</span>: data[R][C]</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">if</span> (cell.<span class="property">v</span> == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">var</span> cell_ref = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_cell</span>(&#123;</span><br><span class="line">        <span class="attr">c</span>: C,</span><br><span class="line">        <span class="attr">r</span>: R</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&#x27;number&#x27;</span>) cell.<span class="property">t</span> = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&#x27;boolean&#x27;</span>) cell.<span class="property">t</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (cell.<span class="property">v</span> <span class="keyword">instanceof</span> <span class="title class_">Date</span>) &#123;</span><br><span class="line">        cell.<span class="property">t</span> = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">        cell.<span class="property">z</span> = <span class="variable constant_">XLSX</span>.<span class="property">SSF</span>.<span class="property">_table</span>[<span class="number">14</span>];</span><br><span class="line">        cell.<span class="property">v</span> = <span class="title function_">datenum</span>(cell.<span class="property">v</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> cell.<span class="property">t</span> = <span class="string">&#x27;s&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      ws[cell_ref] = cell;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &lt; <span class="number">10000000</span>) ws[<span class="string">&#x27;!ref&#x27;</span>] = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_range</span>(range);</span><br><span class="line">  <span class="keyword">return</span> ws;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Workbook</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">Workbook</span>)) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Workbook</span>();</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">SheetNames</span> = [];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">Sheets</span> = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">s2ab</span>(<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(s.<span class="property">length</span>);</span><br><span class="line">  <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buf);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i != s.<span class="property">length</span>; ++i) view[i] = s.<span class="title function_">charCodeAt</span>(i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_table_to_excel</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> theTable = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line">  <span class="keyword">var</span> oo = <span class="title function_">generateArray</span>(theTable);</span><br><span class="line">  <span class="keyword">var</span> ranges = oo[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  <span class="keyword">var</span> data = oo[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add ranges to worksheet */</span></span><br><span class="line">  <span class="comment">// ws[&#x27;!cols&#x27;] = [&#x27;apple&#x27;, &#x27;banan&#x27;];</span></span><br><span class="line">  ws[<span class="string">&#x27;!merges&#x27;</span>] = ranges;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span>,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">saveAs</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">  &#125;), <span class="string">&quot;test.xlsx&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_json_to_excel</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">  multiHeader = [],</span></span><br><span class="line"><span class="params">  header,</span></span><br><span class="line"><span class="params">  data,</span></span><br><span class="line"><span class="params">  filename,</span></span><br><span class="line"><span class="params">  merges = [],</span></span><br><span class="line"><span class="params">  autoWidth = <span class="literal">true</span>,</span></span><br><span class="line"><span class="params">  bookType = <span class="string">&#x27;xlsx&#x27;</span></span></span><br><span class="line"><span class="params">&#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  filename = filename || <span class="string">&#x27;excel-list&#x27;</span></span><br><span class="line">  data = [...data]</span><br><span class="line">  data.<span class="title function_">unshift</span>(header);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = multiHeader.<span class="property">length</span> - <span class="number">1</span>; i &gt; -<span class="number">1</span>; i--) &#123;</span><br><span class="line">    data.<span class="title function_">unshift</span>(multiHeader[i])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (merges.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ws[<span class="string">&#x27;!merges&#x27;</span>]) ws[<span class="string">&#x27;!merges&#x27;</span>] = [];</span><br><span class="line">    merges.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      ws[<span class="string">&#x27;!merges&#x27;</span>].<span class="title function_">push</span>(<span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">decode_range</span>(item))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (autoWidth) &#123;</span><br><span class="line">    <span class="comment">/*设置worksheet每列的最大宽度*/</span></span><br><span class="line">    <span class="keyword">const</span> colWidth = data.<span class="title function_">map</span>(<span class="function"><span class="params">row</span> =&gt;</span> row.<span class="title function_">map</span>(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/*先判断是否为null/undefined*/</span></span><br><span class="line">      <span class="keyword">if</span> (val == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: <span class="number">10</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/*再判断是否为中文*/</span></span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (val.<span class="title function_">toString</span>().<span class="title function_">charCodeAt</span>(<span class="number">0</span>) &gt; <span class="number">255</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: val.<span class="title function_">toString</span>().<span class="property">length</span> * <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: val.<span class="title function_">toString</span>().<span class="property">length</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="comment">/*以第一行为初始值*/</span></span><br><span class="line">    <span class="keyword">let</span> result = colWidth[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; colWidth.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; colWidth[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (result[j][<span class="string">&#x27;wch&#x27;</span>] &lt; colWidth[i][j][<span class="string">&#x27;wch&#x27;</span>]) &#123;</span><br><span class="line">          result[j][<span class="string">&#x27;wch&#x27;</span>] = colWidth[i][j][<span class="string">&#x27;wch&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ws[<span class="string">&#x27;!cols&#x27;</span>] = result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: bookType,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">saveAs</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">  &#125;), <span class="string">`<span class="subst">$&#123;filename&#125;</span>.<span class="subst">$&#123;bookType&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>在导出按钮的vue组件methods中封装导出函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data：&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">downloadLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">dataList</span>:[],<span class="comment">//表格列表</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;&#x27;</span>,<span class="comment">//导出名字</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span><span class="comment">//导出文件后缀xlsx,txt,csv</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleDownload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;@/components/vendor/Export2Excel&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> tHeader = [<span class="string">&#x27;鱼场名称&#x27;</span>, <span class="string">&#x27;鱼场类型&#x27;</span>, <span class="string">&#x27;详细地址&#x27;</span>, <span class="string">&#x27;经度&#x27;</span>, <span class="string">&#x27;纬度&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> filterVal = [<span class="string">&#x27;farmName&#x27;</span>, <span class="string">&#x27;farmType&#x27;</span>, <span class="string">&#x27;address&#x27;</span>, <span class="string">&#x27;longitude&#x27;</span>, <span class="string">&#x27;latitude&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">dataList</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="title function_">formatJson</span>(filterVal, list)</span><br><span class="line">        excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">          <span class="attr">header</span>: tHeader,</span><br><span class="line">          data,</span><br><span class="line">          <span class="attr">filename</span>: <span class="variable language_">this</span>.<span class="property">filename</span>,</span><br><span class="line">          <span class="attr">autoWidth</span>: <span class="variable language_">this</span>.<span class="property">autoWidth</span>,</span><br><span class="line">          <span class="attr">bookType</span>: <span class="variable language_">this</span>.<span class="property">bookType</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">formatJson</span>(<span class="params">filterVal, jsonData</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> jsonData.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> filterVal.<span class="title function_">map</span>(<span class="function"><span class="params">j</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (j === <span class="string">&#x27;timestamp&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">parseTime</span>(v[j])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> v[j]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4："><a href="#步骤4：" class="headerlink" title="步骤4："></a>步骤4：</h2><blockquote>
<p>表格头有合并状态的导出处理</p>
</blockquote>
<p><img src="/2022/03/24/46%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BAxlsx%E6%96%87%E4%BB%B6/01.png"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data：&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">downloadLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">dataList</span>:[],<span class="comment">//表格列表</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;&#x27;</span>,<span class="comment">//导出名字</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span><span class="comment">//导出文件后缀</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleDownload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> multiHeader = [[<span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;Main Information&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>]]</span><br><span class="line">        <span class="keyword">const</span> header = [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Author&#x27;</span>, <span class="string">&#x27;Readings&#x27;</span>, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> filterVal = [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;author&#x27;</span>, <span class="string">&#x27;pageviews&#x27;</span>, <span class="string">&#x27;display_time&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">list</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="title function_">formatJson</span>(filterVal, list)</span><br><span class="line">        <span class="keyword">const</span> merges = [<span class="string">&#x27;A1:A2&#x27;</span>, <span class="string">&#x27;B1:D1&#x27;</span>, <span class="string">&#x27;E1:E2&#x27;</span>]</span><br><span class="line">        excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">          multiHeader,</span><br><span class="line">          header,</span><br><span class="line">          merges,</span><br><span class="line">          data</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">formatJson</span>(<span class="params">filterVal, jsonData</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> jsonData.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> filterVal.<span class="title function_">map</span>(<span class="function"><span class="params">j</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (j === <span class="string">&#x27;timestamp&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">parseTime</span>(v[j])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> v[j]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>上传xlsx文件及显示文件内容</title>
    <url>/2022/04/05/47%E4%B8%8A%E4%BC%A0xlsx%E6%96%87%E4%BB%B6%E5%8F%8A%E6%98%BE%E7%A4%BA%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/</url>
    <content><![CDATA[<h1 id="上传xlsx文件及显示文件内容"><a href="#上传xlsx文件及显示文件内容" class="headerlink" title="上传xlsx文件及显示文件内容"></a>上传xlsx文件及显示文件内容</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>产品要求上传xlsx时，展示文件名称和文件的sheet页数</p>
</blockquote>
<h2 id="步骤1：实现插件"><a href="#步骤1：实现插件" class="headerlink" title="步骤1：实现插件"></a>步骤1：实现插件</h2><blockquote>
<p>下载依赖：npm i <a href="mailto:&#x78;&#x6c;&#115;&#x78;&#64;&#48;&#x2e;&#49;&#52;&#46;&#49;">&#x78;&#x6c;&#115;&#x78;&#64;&#48;&#x2e;&#49;&#52;&#46;&#49;</a></p>
</blockquote>
<h2 id="步骤2：封装插件js"><a href="#步骤2：封装插件js" class="headerlink" title="步骤2：封装插件js"></a>步骤2：封装插件js</h2><blockquote>
<p>在封装插件的文件夹下创建 Excel.js</p>
</blockquote>
<p>下面代码全复制到Export2Excel.js中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; utils, writeFile, read &#125; <span class="keyword">from</span> <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line"><span class="comment">// vue中监听上传文件变化事件的第一个形参直接传入file即可，vue包装的对象符合格式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">importExcel</span>(<span class="params">files, cb</span>) &#123;</span><br><span class="line">  <span class="comment">// 通过FileReader对象读取文件</span></span><br><span class="line">  <span class="keyword">const</span> fileReader = <span class="keyword">new</span> <span class="title class_">FileReader</span>()</span><br><span class="line">  fileReader.<span class="property">onload</span> = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; result &#125; = event.<span class="property">target</span></span><br><span class="line">      <span class="comment">// 以二进制流方式读取得到整份excel表格对象</span></span><br><span class="line">      <span class="keyword">const</span> workbook = <span class="title function_">read</span>(result, &#123; <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span> &#125;)</span><br><span class="line">      <span class="keyword">let</span> data = [] <span class="comment">// 存储获取到的数据</span></span><br><span class="line">      <span class="comment">// 遍历每张工作表进行读取（这里默认只读取第一张表）</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> sheet <span class="keyword">in</span> workbook.<span class="property">Sheets</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (workbook.<span class="property">Sheets</span>.<span class="title function_">hasOwnProperty</span>(sheet)) &#123;</span><br><span class="line">          <span class="comment">// 利用 sheet_to_json 方法将 excel 转成 json 数据</span></span><br><span class="line"></span><br><span class="line">          data = data.<span class="title function_">concat</span>(utils.<span class="title function_">sheet_to_json</span>(workbook.<span class="property">Sheets</span>[sheet]))</span><br><span class="line">          <span class="comment">// break; // 如果只取第一张表，就取消注释这行</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (data)<span class="title function_">cb</span>(data)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="comment">// 这里可以抛出文件类型错误不正确的相关提示</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;参数或文件类型不正确&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 以二进制方式打开文件</span></span><br><span class="line">  fileReader.<span class="title function_">readAsBinaryString</span>(files[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headers 列 数组 [&#123;key:列名,title:excel显示列名&#125;]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 行数据 数组 [&#123;列名:值&#125;]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileName 文件名（包括后缀名）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">exportExcel</span>(<span class="params">headers, data, fileName = <span class="string">&#x27;项目导出.xlsx&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> _headers = headers</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">item, i</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, &#123; <span class="attr">key</span>: item.<span class="property">key</span>, <span class="attr">title</span>: item.<span class="property">title</span>, <span class="attr">position</span>: <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">65</span> + i) + <span class="number">1</span> &#125;))</span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prev, &#123; [next.<span class="property">position</span>]: &#123; <span class="attr">key</span>: next.<span class="property">key</span>, <span class="attr">v</span>: next.<span class="property">title</span> &#125;&#125;), &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> _data = data</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">item, i</span>) =&gt;</span> headers.<span class="title function_">map</span>(<span class="function">(<span class="params">key, j</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, &#123; <span class="attr">content</span>: item[key.<span class="property">key</span>], <span class="attr">position</span>: <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">65</span> + j) + (i + <span class="number">2</span>) &#125;)))</span><br><span class="line">  <span class="comment">// 对刚才的结果进行降维处理（二维数组变成一维数组）</span></span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> prev.<span class="title function_">concat</span>(next))</span><br><span class="line">  <span class="comment">// 转换成 worksheet 需要的结构</span></span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prev, &#123; [next.<span class="property">position</span>]: &#123; <span class="attr">v</span>: next.<span class="property">content</span> &#125;&#125;), &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 合并 headers 和 data</span></span><br><span class="line">  <span class="keyword">const</span> output = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, _headers, _data)</span><br><span class="line">  <span class="comment">// 获取所有单元格的位置</span></span><br><span class="line">  <span class="keyword">const</span> outputPos = <span class="title class_">Object</span>.<span class="title function_">keys</span>(output)</span><br><span class="line">  <span class="comment">// 计算出范围 ,[&quot;A1&quot;,..., &quot;H2&quot;]</span></span><br><span class="line">  <span class="keyword">const</span> ref = <span class="string">`<span class="subst">$&#123;outputPos[<span class="number">0</span>]&#125;</span>:<span class="subst">$&#123;outputPos[outputPos.length - <span class="number">1</span>]&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构建 workbook 对象</span></span><br><span class="line">  <span class="keyword">const</span> wb = &#123;</span><br><span class="line">    <span class="title class_">SheetNames</span>: [<span class="string">&#x27;mySheet&#x27;</span>],</span><br><span class="line">    <span class="title class_">Sheets</span>: &#123;</span><br><span class="line">      <span class="attr">mySheet</span>: <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">        &#123;&#125;,</span><br><span class="line">        output,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&#x27;!ref&#x27;</span>: ref,</span><br><span class="line">          <span class="string">&#x27;!cols&#x27;</span>: [&#123; <span class="attr">wpx</span>: <span class="number">45</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">200</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">80</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">150</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">300</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">300</span> &#125;]</span><br><span class="line">        &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 导出 Excel</span></span><br><span class="line">  <span class="title function_">writeFile</span>(wb, fileName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>封装导入组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;import&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-dialog</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">class</span>=<span class="string">&quot;dialog&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">title</span>=<span class="string">&quot;导入&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;40%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:close-on-click-modal</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:before-close</span>=<span class="string">&quot;handleClose&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:show-close</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&quot;upload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">v-loading</span>=<span class="string">&quot;loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">class</span>=<span class="string">&quot;upload-demo&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">drag</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:accept</span>=<span class="string">&quot;accept&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">action</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-success</span>=<span class="string">&quot;handleSuccess&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-exceed</span>=<span class="string">&quot;handleExceed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:http-request</span>=<span class="string">&quot;handleUpload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:before-remove</span>=<span class="string">&quot;beforeRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:limit</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-change</span>=<span class="string">&quot;handleChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-text</span>=<span class="string">&quot;正在导入中...&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-spinner</span>=<span class="string">&quot;el-icon-loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-background</span>=<span class="string">&quot;rgba(0, 0, 0, 0.8)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">multiple</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-upload&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__text&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          将文件拖到此处，或<span class="tag">&lt;<span class="name">em</span>&gt;</span>点击上传<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: rgba(120, 130, 150, 0.5); font-size: 12px&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            支持&#123;&#123; accept &#125;&#125;文件，导入数据请勿超过XXXXX条</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__tip&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;downloadTemplate&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            下载导入模板</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;showInfo.length&quot;</span> <span class="attr">class</span>=<span class="string">&quot;showInfo&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in showInfo&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&quot;text-align: center; margin: 4px 0&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: #eb9e00&quot;</span>&gt;</span>sheet&#123;&#123; index + 1 &#125;&#125;：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>行数：&#123;&#123; item.list.length &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="comment">&lt;!-- &lt;div&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">          &lt;el-progress :percentage=&quot;50&quot; :format=&quot;format&quot;&gt;&lt;/el-progress&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">        &lt;/div&gt; --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClose&quot;</span>&gt;</span>取 消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          @<span class="attr">click</span>=<span class="string">&quot;handleDetermine&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span>确 定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; importExcel &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/Excel&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// import &#123; postMasterDataUploadApi &#125; from &#x27;@/api/masterDataManagement&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;Import&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">apiUpload</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 上传接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">dialogVisible</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 弹框</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件类型限制</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">acceptType</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="function">() =&gt;</span> [<span class="string">&#x27;.xlsx&#x27;</span>, <span class="string">&#x27;.xls&#x27;</span>]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fileList</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">file</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 覆盖上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">formUpload</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// formDdta上传格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">loading</span>: <span class="literal">false</span>, <span class="comment">// 懒加载</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">showInfo</span>: []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">accept</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">acceptType</span>.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">format</span>(<span class="params">percentage</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> percentage === <span class="number">100</span> ? <span class="string">&#x27;满&#x27;</span> : <span class="string">`<span class="subst">$&#123;percentage&#125;</span>%`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件删除钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleSuccess</span>(<span class="params">response, file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 上传成功的钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">beforeRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 删除文件前的钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> bool = <span class="variable language_">this</span>.$confirm(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">`请确认是否继续移除文件： <span class="subst">$&#123;file.name&#125;</span>？`</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">&#x27;提示&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">confirmButtonText</span>: <span class="string">&#x27;继 续&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取 消&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">confirmButtonClass</span>: <span class="string">&#x27;btnDelete&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      )</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> bool</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleExceed</span>(<span class="params">files, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 超出文件数钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">&#x27;当前限制只能选择 1 个文件！&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleChange</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件改变</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> fileType = file.<span class="property">name</span>.<span class="title function_">substring</span>(file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;.&#x27;</span>))</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">acceptType</span>.<span class="title function_">includes</span>(fileType)) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">`只能上传后缀是【<span class="subst">$&#123;<span class="variable language_">this</span>.accept&#125;</span>】的文件`</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      importExcel([file.<span class="property">raw</span>], <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">showInfo</span> = data</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUpload</span>(<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 覆盖默认的上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">file</span> = data.<span class="property">file</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isLt2M = <span class="variable language_">this</span>.<span class="property">file</span>.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">20</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isLt2M) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;只能上传小于20M的文件&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 根据后台需求数据格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span> = <span class="keyword">new</span> <span class="title class_">FormData</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span>.<span class="title function_">append</span>(<span class="string">&#x27;uploadFile&#x27;</span>, <span class="variable language_">this</span>.<span class="property">file</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleClose</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 关闭弹框</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;closeDialogVisible&#x27;</span>, <span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">file</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 覆盖上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// formDdta上传格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">upload</span>.<span class="title function_">clearFiles</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">onUploadProgress</span>(<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> step = <span class="number">100</span> / e.<span class="property">total</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">loadbar</span> = e.<span class="property">loaded</span> * step</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">loadbar</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">handleDetermine</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 弹框确定按钮</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// const res = await postMasterDataUploadApi(</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.formUpload,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.onUploadProgress</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// )</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// this.loading = false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// if (res.result) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.success(res.msgTitle)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$emit(&#x27;updateList&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125; else &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.error(res.msgTitle)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">downloadTemplate</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 下载模板</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// try &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const res = await downCancelTemplate()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const fileUrl = window.URL.createObjectURL(new Blob([res]))</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const link = document.createElement(&#x27;a&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.style.display = &#x27;none&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.href = fileUrl</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const date = moment().format(&#x27;YYYY_MM_DD&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.download = `后台类目模板_$&#123;date&#125;.xlsx`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   document.body.appendChild(link)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.click()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   document.body.removeChild(link)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   window.URL.revokeObjectURL(fileUrl)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125; catch (err) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.error(err.msg)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.import &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.el-dialog__body</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload-list__item</span><span class="selector-pseudo">:first</span>-child &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#19c17e</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">background-color</span>: <span class="number">#19c17e17</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">16px</span> <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">height</span>: <span class="number">300px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.upload-demo</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">flex-direction</span>: column;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">align-items</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="selector-class">.el-upload-dragger</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">text-align</span>: center <span class="meta">!important</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload__text</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">text-align</span>: center <span class="meta">!important</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload__input</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.dialog-footer</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">justify-content</span>: flex-end;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出图片</title>
    <url>/2022/04/12/48%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BA%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="纯前端导出图片"><a href="#纯前端导出图片" class="headerlink" title="纯前端导出图片"></a>纯前端导出图片</h1><h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>npm i html2canvas</p>
</blockquote>
<h2 id="步骤2：导入需要的插件"><a href="#步骤2：导入需要的插件" class="headerlink" title="步骤2：导入需要的插件"></a>步骤2：导入需要的插件</h2><blockquote>
<p>import html2canvas from “html2canvas”;</p>
</blockquote>
<h2 id="步骤3：给img标签添加ref"><a href="#步骤3：给img标签添加ref" class="headerlink" title="步骤3：给img标签添加ref"></a>步骤3：给img标签添加ref</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img :src=&quot;&#x27;data:image/gif;base64,&#x27;+srcImg&quot; alt=&quot;&quot; style=&quot;width: 100px;height: 100px;&quot; ref=&quot;printform&quot; id=&quot;printform&quot;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：点击函数封装"><a href="#步骤4：点击函数封装" class="headerlink" title="步骤4：点击函数封装"></a>步骤4：点击函数封装</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">html2canvas</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">printform</span>, &#123;<span class="comment">//this.$refs.printform图片节点</span></span><br><span class="line">        <span class="attr">allowTaint</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">taintTest</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">useCORS</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">dpi</span>: <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">4</span>, <span class="comment">//将分辨率提高到特定的DPI 提高四倍</span></span><br><span class="line">        <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">//按比例增加分辨率</span></span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        link.<span class="property">href</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/jpeg&quot;</span>, <span class="number">1.0</span>); <span class="comment">//下载链接</span></span><br><span class="line">        link.<span class="title function_">setAttribute</span>(</span><br><span class="line">          <span class="string">&quot;download&quot;</span>,</span><br><span class="line">          <span class="string">`头像.jpeg`</span></span><br><span class="line">        );</span><br><span class="line">        link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>; <span class="comment">//a标签隐藏</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link);</span><br><span class="line">        link.<span class="title function_">click</span>();</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link) <span class="comment">// 下载完成移除元素</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出pdf文件（简单粗暴式）</title>
    <url>/2022/05/08/50%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BApdf%E6%96%B9%E5%BC%8F1/</url>
    <content><![CDATA[<h1 id="纯前端导出pdf文件（简单粗暴式）"><a href="#纯前端导出pdf文件（简单粗暴式）" class="headerlink" title="纯前端导出pdf文件（简单粗暴式）"></a>纯前端导出pdf文件（简单粗暴式）</h1><h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>第一个.将页面html转换成图片<br>npm install html2canvas –save<br>第二个.将图片生成pdf<br>npm install jspdf –save</p>
</blockquote>
<h2 id="步骤2：方法封装"><a href="#步骤2：方法封装" class="headerlink" title="步骤2：方法封装"></a>步骤2：方法封装</h2><blockquote>
<p>在utils创建htmlToPdfClick.js文件<br>下面完整代码可粘贴</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2Canvas <span class="keyword">from</span> <span class="string">&#x27;html2canvas&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JsPDF</span> <span class="keyword">from</span> <span class="string">&#x27;jspdf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPdfFromHtml</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="comment">// 可设置页边距，滚动有影响，需要设置滚动置顶</span></span><br><span class="line">  <span class="comment">// 能解决图片导出问题</span></span><br><span class="line">  ele = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;pdfDom&#x27;</span>)</span><br><span class="line">  pdfFileName = pdfFileName || <span class="string">&#x27;pdf&#x27;</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">pageYoffset</span> = <span class="number">0</span>; <span class="comment">// 滚动置顶</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// ele.style.fontFamily=&#x27;宋体&#x27;;</span></span><br><span class="line">  <span class="comment">// ele.style.padding=&#x27;30px&#x27;;</span></span><br><span class="line">  <span class="keyword">let</span> scale = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">2</span></span><br><span class="line">  <span class="title function_">html2Canvas</span>(ele, &#123;</span><br><span class="line">    <span class="comment">// dpi: 300,</span></span><br><span class="line">    <span class="attr">dpi</span>: <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">4</span>, <span class="comment">//将分辨率提高到特定的DPI 提高四倍</span></span><br><span class="line">    <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">//按比例增加分辨率</span></span><br><span class="line">    <span class="attr">logging</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// scale:scale,</span></span><br><span class="line">    <span class="attr">useCORS</span>: <span class="literal">true</span>,<span class="comment">//允许canvas画布内可以跨域请求外部链接图片, 允许跨域请求。</span></span><br><span class="line">    <span class="attr">allowTaint</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">height</span>: ele.<span class="property">offsetHeight</span>, <span class="comment">// 导出的dom宽高</span></span><br><span class="line">    <span class="attr">width</span>: ele.<span class="property">offsetWidth</span>, <span class="comment">// 导出的dom宽高</span></span><br><span class="line">    <span class="attr">windowWidth</span>: <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollWidth</span>, <span class="comment">// 浏览器所有内容的宽高，不是弹框的</span></span><br><span class="line">    <span class="attr">windowHeight</span>: <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>, <span class="comment">// 浏览器所有内容的宽高，不是弹框的</span></span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&#x27;#fff&#x27;</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">canvas</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> _this = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="comment">// 未生成pdf的html页面高度</span></span><br><span class="line">    <span class="keyword">var</span> leftHeight = canvas.<span class="property">height</span> <span class="comment">// 即弹框里面所有内容</span></span><br><span class="line">    <span class="keyword">var</span> a4Width = <span class="number">592</span> <span class="comment">// 原A4宽 592 因为要设置边距 20 ,这里要减掉 40</span></span><br><span class="line">    <span class="keyword">var</span> a4Height = <span class="number">821</span> <span class="comment">// 原A4高   841 因为要设置边距 20 ,这里要减掉 40</span></span><br><span class="line">    <span class="comment">// 一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">    <span class="comment">//var a4HeightRef = 4450 // 即A4的内容</span></span><br><span class="line">    <span class="keyword">var</span> a4HeightRef = <span class="title class_">Math</span>.<span class="title function_">floor</span>(canvas.<span class="property">width</span> / a4Width * a4Height);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//pdf页面偏移</span></span><br><span class="line">    <span class="keyword">var</span> position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pageData = canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pdf = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;pt&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">1</span>,</span><br><span class="line">      canvas1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>),</span><br><span class="line">      height;</span><br><span class="line">    pdf.<span class="title function_">setDisplayMode</span>(<span class="string">&#x27;fullwidth&#x27;</span>, <span class="string">&#x27;continuous&#x27;</span>, <span class="string">&#x27;FullScreen&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">createImpl</span>(<span class="params">canvas</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        <span class="keyword">var</span> checkCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (leftHeight &gt; a4HeightRef) &#123;</span><br><span class="line">          <span class="keyword">var</span> i = position + a4HeightRef;</span><br><span class="line">          <span class="keyword">for</span> (i = position + a4HeightRef; i &gt;= position; i--) &#123;</span><br><span class="line">            <span class="keyword">var</span> isWrite = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; canvas.<span class="property">width</span>; j++) &#123;</span><br><span class="line">              <span class="keyword">var</span> c = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>).<span class="title function_">getImageData</span>(j, i, <span class="number">1</span>, <span class="number">1</span>).<span class="property">data</span></span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (c[<span class="number">0</span>] != <span class="number">0xff</span> || c[<span class="number">1</span>] != <span class="number">0xff</span> || c[<span class="number">2</span>] != <span class="number">0xff</span>) &#123;</span><br><span class="line">                isWrite = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (isWrite) &#123;</span><br><span class="line">              checkCount++</span><br><span class="line">              <span class="keyword">if</span> (checkCount &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              checkCount = <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          height = <span class="title class_">Math</span>.<span class="title function_">round</span>(i - position) || <span class="title class_">Math</span>.<span class="title function_">min</span>(leftHeight, a4HeightRef);</span><br><span class="line">          <span class="keyword">if</span> (height &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            height = a4HeightRef;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          height = leftHeight;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        canvas1.<span class="property">width</span> = canvas.<span class="property">width</span>;</span><br><span class="line">        canvas1.<span class="property">height</span> = height;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// console.log(index, &#x27;height:&#x27;, height, &#x27;pos&#x27;, position);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> ctx = canvas1.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">        ctx.<span class="title function_">drawImage</span>(canvas, <span class="number">0</span>, position, canvas.<span class="property">width</span>, height, <span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, height); <span class="comment">// 边距这里设置0，不然又黑边</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> pageHeight = <span class="title class_">Math</span>.<span class="title function_">round</span>(a4Width / canvas.<span class="property">width</span> * height);</span><br><span class="line">        <span class="comment">// pdf.setPageSize(null, pageHeight)</span></span><br><span class="line">        <span class="keyword">if</span> (position != <span class="number">0</span>) &#123;</span><br><span class="line">          pdf.<span class="title function_">addPage</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 设置 20px 边距</span></span><br><span class="line">        pdf.<span class="title function_">addImage</span>(canvas1.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>), <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">20</span>, <span class="number">20</span>, a4Width, a4Width / canvas1.<span class="property">width</span> * height);</span><br><span class="line">        leftHeight -= height;</span><br><span class="line">        position += height;</span><br><span class="line">        <span class="comment">// $(&#x27;.pdfProgress&#x27;).text(index + 1);</span></span><br><span class="line">        <span class="comment">// $(&#x27;.pdfTotal&#x27;).text(index + Math.ceil(leftHeight / a4HeightRef));</span></span><br><span class="line">        <span class="keyword">if</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">//添加全屏水印</span></span><br><span class="line">          <span class="keyword">const</span> base64 = <span class="string">&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAArCAYAAADIWo5HAAACLUlEQVR42u2Zy2sCMRDGV9tbtVJKrQ/0JBWLvbgsaOttQQqreO5R6GHP/v+HZiEDQ9i8k33YDHyXbcxufpN8maRRFCJEiBAhQoTgRIfoh+hKNBe0G9I2GVG3om9bEl2I9rcIoE/77Cq8Myd6sn2ZSBgAr80YARhI+gOwCdGW6EB/d6R9XDUGFrsAf2Fe7Fswk1JBmzMd1DNKgI2EywQyUKYjkxFeOwwxkwgAvBJNqEa0DzaTHcn3qWrXdA/ocQD8m11ABUDfQF0fpujjI2QAeoZetdYdfOzB9HgGNEF6owM8Ec3Q8wEDgP07T6ktgNyB8YgAqGZ0b+gRsS2AtQP/iAUAHlAdsEW7TY6eFVrVNQN8A2AjlZho5R5wYjJhoqMiADy4DFWLPJMcKBhv3AYThFi4yJyrAAAfDrY/1SVQVhLDOWDowIwzSQ1TqwfA1P5CU3yJlsPY8fmjcTMgptmeIwB3aFbsLCvM2BRAFR4AZXYxuEdmn38hmjoosY0B5IonxLNhIYTNby0odMoAJJL1/k10bwpgQztZKaxb2YXFRnAUhexDHzoAUsGxu3j+awNA5+RmcxW1UCx1eQB4SyI1AaBrbiMEYGrwexgYBlgrgGtU/ZUY3AlGhgByTvV5MQGgW1SomqBOUWLiATy1wgNsABQz51PzWHxTALzWAW0F0EM+MKPmnLj6x0lbAPDuC5zfNPsCcChZ25DZd4VBJCW7wrRp1+whQoQIESJEg+IPRa38G55TPkQAAAAASUVORK5CYII=&#x27;</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">              <span class="keyword">const</span> left = (j * <span class="number">120</span>) + <span class="number">20</span>;</span><br><span class="line">              <span class="comment">// pdf.addImage(base64,&#x27;JPEG&#x27;, left, i*150, 20, 30); // 关掉水印</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="built_in">setTimeout</span>(createImpl, <span class="number">500</span>, canvas);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          pdf.<span class="title function_">save</span>(pdfFileName + <span class="string">&#x27;.pdf&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当内容未超过pdf一页显示的范围，无需分页</span></span><br><span class="line">    <span class="keyword">if</span> (leftHeight &lt; a4HeightRef) &#123;</span><br><span class="line">      pdf.<span class="title function_">addImage</span>(pageData, <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">20</span>, <span class="number">20</span>, a4Width, a4Width / canvas.<span class="property">width</span> * leftHeight);</span><br><span class="line">      pdf.<span class="title function_">save</span>(pdfFileName + <span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        pdf.<span class="title function_">deletePage</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">setTimeout</span>(createImpl, <span class="number">500</span>, canvas);</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：给要导出的盒子标签添加id"><a href="#步骤3：给要导出的盒子标签添加id" class="headerlink" title="步骤3：给要导出的盒子标签添加id"></a>步骤3：给要导出的盒子标签添加id</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：引用方法并使用"><a href="#步骤4：引用方法并使用" class="headerlink" title="步骤4：引用方法并使用"></a>步骤4：引用方法并使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> &#123;getPdfFromHtml&#125; <span class="keyword">from</span> <span class="string">&#x27;../../utils/htmlToPdfClick&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出pdf按钮点击方法</span></span><br><span class="line"><span class="title function_">getPdfClick</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="title function_">getPdfFromHtml</span>()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出pdf文件（多个class导出）</title>
    <url>/2022/05/28/51%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BApdf%E6%96%B9%E5%BC%8F2/</url>
    <content><![CDATA[<h1 id="纯前端导出pdf文件（多个class导出）"><a href="#纯前端导出pdf文件（多个class导出）" class="headerlink" title="纯前端导出pdf文件（多个class导出）"></a>纯前端导出pdf文件（多个class导出）</h1><blockquote>
<p>注：<br>1：当页面缩放时，下载pdf字体跟样式变小，可以用两个dom，应该定位最上面展示，另外一个真正下载的写死宽度<br>2：当发现断层时，你可以根据内容高度修改class标签内包含的内容（动动你的小脑袋，你是最聪明的！！！）</p>
</blockquote>
<h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>第一个.将页面html转换成图片<br>npm install html2canvas –save<br>第二个.将图片生成pdf<br>npm install jspdf –save</p>
</blockquote>
<h2 id="步骤2：方法封装"><a href="#步骤2：方法封装" class="headerlink" title="步骤2：方法封装"></a>步骤2：方法封装</h2><blockquote>
<p>在utils创建htmlToPdfClick.js文件<br>下面完整代码可粘贴</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2Canvas <span class="keyword">from</span> <span class="string">&#x27;html2canvas&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JsPDF</span> <span class="keyword">from</span> <span class="string">&#x27;jspdf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPdfFromHtml</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">`.<span class="subst">$&#123;ele&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">PDF</span> = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;pt&quot;</span>, <span class="string">&quot;a4&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> pageArr = [];</span><br><span class="line">  <span class="keyword">const</span> opts = &#123;</span><br><span class="line">    <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">// 缩放比例，提高生成图片清晰度</span></span><br><span class="line">    <span class="attr">useCORS</span>: <span class="literal">true</span>, <span class="comment">// 允许加载跨域的图片</span></span><br><span class="line">    <span class="attr">allowTaint</span>: <span class="literal">false</span>, <span class="comment">// 允许图片跨域，和 useCORS 二者不可共同使用</span></span><br><span class="line">    <span class="attr">tainttest</span>: <span class="literal">true</span>, <span class="comment">// 检测每张图片已经加载完成</span></span><br><span class="line">    <span class="attr">logging</span>: <span class="literal">true</span>, <span class="comment">// 日志开关，发布的时候记得改成 false</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> index <span class="keyword">in</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(element)) &#123;</span><br><span class="line">    <span class="title function_">html2Canvas</span>(element[index], opts).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高</span></span><br><span class="line">      <span class="keyword">const</span> contentWidth = canvas.<span class="property">width</span>;</span><br><span class="line">      <span class="keyword">const</span> contentHeight = canvas.<span class="property">height</span>;</span><br><span class="line">      <span class="keyword">const</span> imgWidth = <span class="number">595.28</span>;</span><br><span class="line">      <span class="keyword">const</span> imgHeight = (<span class="number">592.28</span> / contentWidth) * contentHeight;</span><br><span class="line">      <span class="keyword">const</span> pageData = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/jpeg&quot;</span>, <span class="number">1.0</span>);</span><br><span class="line">      <span class="comment">// 一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">      <span class="keyword">const</span> pageHeight = (contentWidth / <span class="number">592.28</span>) * <span class="number">841.89</span>;</span><br><span class="line">      <span class="comment">// 未生成pdf的html页面高度</span></span><br><span class="line">      <span class="keyword">const</span> leftHeight = contentHeight;</span><br><span class="line">      pageArr[index] = &#123;</span><br><span class="line">        <span class="attr">pageData</span>: pageData,</span><br><span class="line">        <span class="attr">pageHeight</span>: pageHeight,</span><br><span class="line">        <span class="attr">leftHeight</span>: leftHeight,</span><br><span class="line">        <span class="attr">imgWidth</span>: imgWidth,</span><br><span class="line">        <span class="attr">imgHeight</span>: imgHeight,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">if</span> (++count === element.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// 转换完毕，可进行下一步处理 pageDataArr</span></span><br><span class="line">        <span class="keyword">let</span> counts = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> data <span class="keyword">of</span> pageArr) &#123;</span><br><span class="line">          <span class="comment">// 页面偏移</span></span><br><span class="line">          <span class="keyword">let</span> position = <span class="number">0</span>;</span><br><span class="line">          <span class="comment">// 转换完毕，save保存名称后浏览器会自动下载</span></span><br><span class="line">          <span class="comment">// 当内容未超过pdf一页显示的范围，无需分页</span></span><br><span class="line">          <span class="keyword">if</span> (data.<span class="property">leftHeight</span> &lt; data.<span class="property">pageHeight</span>) &#123;</span><br><span class="line">            <span class="comment">// addImage(pageData, &#x27;JPEG&#x27;, 左，上，宽度，高度)设置</span></span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">addImage</span>(</span><br><span class="line">              data.<span class="property">pageData</span>,</span><br><span class="line">              <span class="string">&quot;JPEG&quot;</span>,</span><br><span class="line">              <span class="number">0</span>,</span><br><span class="line">              <span class="number">0</span>,</span><br><span class="line">              data.<span class="property">imgWidth</span>,</span><br><span class="line">              data.<span class="property">imgHeight</span></span><br><span class="line">            );</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 超过一页时，分页打印（每页高度841.89）</span></span><br><span class="line">            <span class="keyword">while</span> (data.<span class="property">leftHeight</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="variable constant_">PDF</span>.<span class="title function_">addImage</span>(</span><br><span class="line">                data.<span class="property">pageData</span>,</span><br><span class="line">                <span class="string">&quot;JPEG&quot;</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                position,</span><br><span class="line">                data.<span class="property">imgWidth</span>,</span><br><span class="line">                data.<span class="property">imgHeight</span></span><br><span class="line">              );</span><br><span class="line">              data.<span class="property">leftHeight</span> -= data.<span class="property">pageHeight</span>;</span><br><span class="line">              position -= <span class="number">841.89</span>;</span><br><span class="line">              <span class="keyword">if</span> (data.<span class="property">leftHeight</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable constant_">PDF</span>.<span class="title function_">addPage</span>();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (++counts === pageArr.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">save</span>(pdfFileName + <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 未转换到最后一页时，pdf增加一页</span></span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">addPage</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：给要导出的盒子标签添加id"><a href="#步骤3：给要导出的盒子标签添加id" class="headerlink" title="步骤3：给要导出的盒子标签添加id"></a>步骤3：给要导出的盒子标签添加id</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：引用方法并使用"><a href="#步骤4：引用方法并使用" class="headerlink" title="步骤4：引用方法并使用"></a>步骤4：引用方法并使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> &#123;getPdfFromHtml&#125; <span class="keyword">from</span> <span class="string">&#x27;../../utils/htmlToPdfClick&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出pdf按钮点击方法</span></span><br><span class="line"><span class="title function_">getPdfClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">getPdfFromHtml</span>(<span class="string">&#x27;app-container&#x27;</span>,<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>视频上传封装组件使用</title>
    <url>/2022/06/08/52%E5%89%8D%E7%AB%AF%E5%B0%81%E8%A3%85%E8%A7%86%E9%A2%91%E4%B8%8A%E4%BC%A0%20/</url>
    <content><![CDATA[<h1 id="视频上传封装组件使用"><a href="#视频上传封装组件使用" class="headerlink" title="视频上传封装组件使用"></a>视频上传封装组件使用</h1><h2 id="步骤1：使用实例"><a href="#步骤1：使用实例" class="headerlink" title="步骤1：使用实例"></a>步骤1：使用实例</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Albumvideo v-else @sendData=&quot;sendData&quot; :isShow=&quot;form.carouselImage&quot;&gt;&lt;/Albumvideo&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：组件完整代码"><a href="#步骤2：组件完整代码" class="headerlink" title="步骤2：组件完整代码"></a>步骤2：组件完整代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editPage__video&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img__con&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span> <span class="attr">:action</span>=<span class="string">&quot;uploadImgUrl&quot;</span> <span class="attr">:data</span>=<span class="string">&quot;uploadImgData&quot;</span> <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-success</span>=<span class="string">&quot;handleAvatarSuccess&quot;</span> <span class="attr">:before-upload</span>=<span class="string">&quot;beforeAvatarUpload&quot;</span> <span class="attr">:on-progress</span>=<span class="string">&quot;uploadVideoProcess&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">video</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">controls</span>=<span class="string">&quot;controls&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;menuKey&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">source</span> <span class="attr">:src</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/mp4&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="comment">&lt;!-- &lt;img v-if=&quot;imageUrl&quot; :src=&quot;imageUrl&quot; class=&quot;avatar&quot; /&gt; --&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus avatar-uploader-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-progress</span> <span class="attr">v-if</span>=<span class="string">&quot;videoFlag == true&quot;</span> <span class="attr">type</span>=<span class="string">&quot;line&quot;</span> <span class="attr">:percentage</span>=<span class="string">&quot;videoUploadPercent&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&quot;margin-top: 30px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-progress</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        说明: 视频格式为 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; &#x27;mp4&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span>格式，每个视频大小不超过 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; &#x27;300m&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">isShow</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">imageUrl</span>: <span class="string">&#x27;&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 视频上传</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgUrl</span>: <span class="string">`<span class="subst">$&#123;process.env.VUE_APP_BASE_API&#125;</span>/common/upload`</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgData</span>: &#123; <span class="attr">busiName</span>: <span class="number">32</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 应付多个组件的情况 记录当前组件的key值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">componentKey</span>: <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">menuKey</span>: <span class="number">1</span>, <span class="comment">// 用来强制刷新</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">videoFlag</span>: <span class="literal">false</span>,  <span class="comment">// 进度条相关的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">videoUploadPercent</span>: <span class="number">0</span>,  <span class="comment">// 进度条相关的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="property">imageUrl</span> = <span class="variable language_">this</span>.<span class="property">isShow</span> ? <span class="variable language_">this</span>.<span class="property">isShow</span> : <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">watch</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">isShow</span>(<span class="params">val</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(val);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">imageUrl</span> = val ? val : <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传成功的函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleAvatarSuccess</span>(<span class="params">res, file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 进度条恢复到初始状态</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoFlag</span> = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoUploadPercent</span> = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      ++<span class="variable language_">this</span>.<span class="property">menuKey</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">imageUrl</span> = res.<span class="property">data</span>.<span class="property">url</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (res.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="title function_">sendData</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 这里是向父级传值，不需要就去掉</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// this.$emit(&quot;childRightFn&quot;, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...this.rightData,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...&#123; imageUrl: this.imageUrl &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...&#123; props: &#123; src: this.imageUrl &#125; &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">sendData</span>(<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;sendData&#x27;</span>, data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">beforeAvatarUpload</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   file.type === &quot;image/jpg&quot; ||</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   file.type === &quot;image/png&quot;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isMp4 = file.<span class="property">type</span> === <span class="string">&quot;video/mp4&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 限制文件最大不能超过 300M</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isLt2M = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">300</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isMp4) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;视频只能是mp4格式!&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isLt2M) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;上传头像图片大小不能超过 300MB!&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> isMp4 &amp;&amp; isLt2M;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//进度条</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">uploadVideoProcess</span>(<span class="params">event, file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoFlag</span> = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoUploadPercent</span> = <span class="built_in">parseInt</span>(file.<span class="property">percentage</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.editPage__video &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-tag">video</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">line-height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#d9d9d9</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">cursor</span>: pointer;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">position</span>: relative;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">overflow</span>: hidden;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border-color</span>: <span class="number">#409eff</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader-icon</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">text-align</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: auto;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: block;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.title</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.img__con</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-button</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span> <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>页面闪了一下的样式问题</title>
    <url>/2022/06/20/53%E9%A1%B5%E9%9D%A2%E9%97%AA%E4%BA%86%E4%B8%80%E4%B8%8B%E7%9A%84%E6%A0%B7%E5%BC%8F%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="页面闪了一下的样式问题"><a href="#页面闪了一下的样式问题" class="headerlink" title="页面闪了一下的样式问题"></a>页面闪了一下的样式问题</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//当样式闪一下是设置<span class="selector-tag">body</span>样式</span><br><span class="line">// 在<span class="selector-tag">body</span>标签样式下添加</span><br><span class="line">overflover：hidden</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>图片上传封装组件使用</title>
    <url>/2022/04/15/49%E5%89%8D%E7%AB%AF%E5%B0%81%E8%A3%85%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h1 id="图片上传封装组件使用"><a href="#图片上传封装组件使用" class="headerlink" title="图片上传封装组件使用"></a>图片上传封装组件使用</h1><h2 id="步骤1：使用实例"><a href="#步骤1：使用实例" class="headerlink" title="步骤1：使用实例"></a>步骤1：使用实例</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;image-upload v-model=&quot;form.carouselImage&quot; @input=&quot;inputFn&quot; :limit=&quot;1&quot; :fileSize=&quot;10&quot;&gt;&lt;/image-upload&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：组件完整代码"><a href="#步骤2：组件完整代码" class="headerlink" title="步骤2：组件完整代码"></a>步骤2：组件完整代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;component-upload-image&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">multiple</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:action</span>=<span class="string">&quot;uploadImgUrl&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">list-type</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-success</span>=<span class="string">&quot;handleUploadSuccess&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:before-upload</span>=<span class="string">&quot;handleBeforeUpload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:limit</span>=<span class="string">&quot;limit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-error</span>=<span class="string">&quot;handleUploadError&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-exceed</span>=<span class="string">&quot;handleExceed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">name</span>=<span class="string">&quot;file&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:show-file-list</span>=<span class="string">&quot;true&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:headers</span>=<span class="string">&quot;headers&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:file-list</span>=<span class="string">&quot;fileList&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-preview</span>=<span class="string">&quot;handlePictureCardPreview&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:class</span>=<span class="string">&quot;&#123;hide: this.fileList.length &gt;= this.limit&#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 上传提示 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__tip&quot;</span> <span class="attr">slot</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;showTip&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      请上传</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;fileSize&quot;</span>&gt;</span> 大小不超过 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; fileSize &#125;&#125;MB<span class="tag">&lt;/<span class="name">b</span>&gt;</span> <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;fileType&quot;</span>&gt;</span> 格式为 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; fileType.join(&quot;/&quot;) &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span> <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      的文件</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-dialog</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">title</span>=<span class="string">&quot;预览&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;800&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">append-to-body</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:src</span>=<span class="string">&quot;dialogImageUrl&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&quot;display: block; max-width: 100%; margin: 0 auto&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; getToken &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/auth&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">value</span>: [<span class="title class_">String</span>, <span class="title class_">Object</span>, <span class="title class_">Array</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 图片数量限制</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">limit</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 大小限制(MB)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fileSize</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">       <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件类型, 例如[&#x27;png&#x27;, &#x27;jpg&#x27;, &#x27;jpeg&#x27;]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fileType</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="function">() =&gt;</span> [<span class="string">&quot;png&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 是否显示提示</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">isShowTip</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">number</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadList</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dialogImageUrl</span>: <span class="string">&quot;&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dialogVisible</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">hideUpload</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">baseUrl</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgUrl</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span> + <span class="string">&quot;/common/upload&quot;</span>, <span class="comment">// 上传的图片服务器地址</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">headers</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// Authorization: &quot;Bearer &quot; + getToken(),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fileList</span>: []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">watch</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">value</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">handler</span>(<span class="params">val</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (val) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 首先将值转为数组</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">const</span> list = <span class="title class_">Array</span>.<span class="title function_">isArray</span>(val) ? val : <span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 然后将数组转为对象数组</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">fileList</span> = list.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&quot;string&quot;</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="keyword">if</span> (item.<span class="title function_">indexOf</span>(<span class="variable language_">this</span>.<span class="property">baseUrl</span>) === -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                  item = &#123; <span class="attr">name</span>: <span class="variable language_">this</span>.<span class="property">baseUrl</span> + item, <span class="attr">url</span>: <span class="variable language_">this</span>.<span class="property">baseUrl</span> + item &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                  item = &#123; <span class="attr">name</span>: item, <span class="attr">url</span>: item &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> item;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">fileList</span> = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">deep</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">immediate</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 是否显示提示</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">showTip</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">isShowTip</span> &amp;&amp; (<span class="variable language_">this</span>.<span class="property">fileType</span> || <span class="variable language_">this</span>.<span class="property">fileSize</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 删除图片</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> findex = <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">map</span>(<span class="function"><span class="params">f</span> =&gt;</span> f.<span class="property">name</span>).<span class="title function_">indexOf</span>(file.<span class="property">name</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>(findex &gt; -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">splice</span>(findex, <span class="number">1</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;input&quot;</span>, <span class="variable language_">this</span>.<span class="title function_">listToString</span>(<span class="variable language_">this</span>.<span class="property">fileList</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传成功回调</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUploadSuccess</span>(<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">uploadList</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: res.<span class="property">data</span>.<span class="property">originalFileName</span>, <span class="attr">url</span>: res.<span class="property">data</span>.<span class="property">fileName</span> &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">uploadList</span>.<span class="property">length</span> === <span class="variable language_">this</span>.<span class="property">number</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span> = <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">concat</span>(<span class="variable language_">this</span>.<span class="property">uploadList</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">uploadList</span> = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">number</span> = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;input&quot;</span>, <span class="variable language_">this</span>.<span class="title function_">listToString</span>(<span class="variable language_">this</span>.<span class="property">fileList</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">closeLoading</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传前loading加载</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleBeforeUpload</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> isImg = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fileType</span>.<span class="property">length</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> fileExtension = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          fileExtension = file.<span class="property">name</span>.<span class="title function_">slice</span>(file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        isImg = <span class="variable language_">this</span>.<span class="property">fileType</span>.<span class="title function_">some</span>(<span class="function"><span class="params">type</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">if</span> (file.<span class="property">type</span>.<span class="title function_">indexOf</span>(type) &gt; -<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">if</span> (fileExtension &amp;&amp; fileExtension.<span class="title function_">indexOf</span>(type) &gt; -<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        isImg = file.<span class="property">type</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;image&quot;</span>) &gt; -<span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isImg) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`文件格式不正确, 请上传<span class="subst">$&#123;<span class="variable language_">this</span>.fileType.join(<span class="string">&quot;/&quot;</span>)&#125;</span>图片格式文件!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fileSize</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> isLt = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="variable language_">this</span>.<span class="property">fileSize</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (!isLt) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`上传头像图片大小不能超过 <span class="subst">$&#123;<span class="variable language_">this</span>.fileSize&#125;</span> MB!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">loading</span>(<span class="string">&quot;正在上传图片，请稍候...&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">number</span>++;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件个数超出</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleExceed</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`上传文件数量不能超过 <span class="subst">$&#123;<span class="variable language_">this</span>.limit&#125;</span> 个!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传失败</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUploadError</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">&quot;上传图片失败，请重试&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">closeLoading</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 预览</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handlePictureCardPreview</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">dialogImageUrl</span> = file.<span class="property">url</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 对象转成指定字符串分隔</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">listToString</span>(<span class="params">list, separator</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(list);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> strs = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      separator = separator || <span class="string">&quot;,&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> list) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        strs += list[i].<span class="property">url</span>.<span class="title function_">replace</span>(<span class="variable language_">this</span>.<span class="property">baseUrl</span>, <span class="string">&quot;&quot;</span>) + separator;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> strs != <span class="string">&#x27;&#x27;</span> ? strs.<span class="title function_">substr</span>(<span class="number">0</span>, strs.<span class="property">length</span> - <span class="number">1</span>) : <span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">// <span class="selector-class">.el-upload--picture-card</span> 控制加号部分</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.hide .el-upload--picture-card &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">// 去掉动画效果</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-enter-active,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-leave-active &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">transition</span>: all <span class="number">0s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-enter, .el-list-leave-active &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>echarts饼图实现自动轮播</title>
    <url>/2022/07/17/54echarts%E9%A5%BC%E5%9B%BE%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E8%BD%AE%E6%92%AD/</url>
    <content><![CDATA[<h1 id="echarts饼图实现自动轮播"><a href="#echarts饼图实现自动轮播" class="headerlink" title="echarts饼图实现自动轮播"></a>echarts饼图实现自动轮播</h1><h2 id="废话不多说，完整代码整上"><a href="#废话不多说，完整代码整上" class="headerlink" title="废话不多说，完整代码整上"></a>废话不多说，完整代码整上</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;echarts&quot; :id=&quot;echartsId&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import * as echarts from &#x27;echarts&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    echartsId: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.initEcharts()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    initEcharts() &#123;</span><br><span class="line">      var chartDom = document.getElementById(this.echartsId);</span><br><span class="line">      var myChart = echarts.init(chartDom);</span><br><span class="line">      var option;</span><br><span class="line"></span><br><span class="line">      option = &#123;</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          trigger: &#x27;item&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">          top: &#x27;5%&#x27;,</span><br><span class="line">          left: &#x27;center&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            name: &#x27;Access From&#x27;,</span><br><span class="line">            type: &#x27;pie&#x27;,</span><br><span class="line">            radius: [&#x27;40%&#x27;, &#x27;70%&#x27;], // 通过设置内径与外径将饼图变为圆环饼图</span><br><span class="line">            avoidLabelOverlap: false,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderRadius: [8,8,8,8],// 设置圆环的圆角弧度</span><br><span class="line">              borderColor: &#x27;#fff&#x27;,</span><br><span class="line">              borderWidth: 2</span><br><span class="line">            &#125;,</span><br><span class="line">            label: &#123; // 设置图形标签样式</span><br><span class="line">              show: false, // 未高亮时不显示标签，否则高亮时显示的标签会与静态的标签重叠</span><br><span class="line">              position: &#x27;center&#x27;,</span><br><span class="line">              // 设置标签展示内容,其中&#123;d&#125;、&#123;b&#125;为echarts标签内容格式器</span><br><span class="line">              formatter: &#x27;&#123;d_style|&#123;d&#125;&#125;&#123;per_style|%&#125;\n&#123;b_style|&#123;b&#125;&#125;&#x27;,</span><br><span class="line">              // 为标签内容指定样式，只能设置series-pie.label支持的样式</span><br><span class="line">              rich: &#123;</span><br><span class="line">                d_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;,</span><br><span class="line">                per_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;,</span><br><span class="line">                b_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            emphasis: &#123; // 设置高亮时显示标签</span><br><span class="line">              label: &#123;</span><br><span class="line">                show: true</span><br><span class="line">              &#125;,</span><br><span class="line">              scale: true, // 设置高亮时放大图形</span><br><span class="line">              scaleSize: 20</span><br><span class="line">            &#125;,</span><br><span class="line">            data: [ // 饼图数据</span><br><span class="line">              &#123; value: 1048, name: &#x27;Search Engine&#x27; &#125;,</span><br><span class="line">              &#123; value: 735, name: &#x27;Direct&#x27; &#125;,</span><br><span class="line">              &#123; value: 580, name: &#x27;Email&#x27; &#125;,</span><br><span class="line">              &#123; value: 484, name: &#x27;Union Ads&#x27; &#125;,</span><br><span class="line">              &#123; value: 300, name: &#x27;Video Ads&#x27; &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      // 下面是自动轮播的处理函数----------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">      let currentIndex = -1; // 当前高亮图形在饼图数据中的下标</span><br><span class="line">      let changePieInterval = setInterval(selectPie, 1000); // 设置自动切换高亮图形的定时器</span><br><span class="line"></span><br><span class="line">      function highlightPie() &#123; // 取消所有高亮并高亮当前图形</span><br><span class="line">        for (var idx in option.series[0].data)</span><br><span class="line">          // 遍历饼图数据，取消所有图形的高亮效果</span><br><span class="line">          myChart.dispatchAction(&#123;</span><br><span class="line">            type: &#x27;downplay&#x27;,</span><br><span class="line">            seriesIndex: 0,</span><br><span class="line">            dataIndex: idx</span><br><span class="line">          &#125;);</span><br><span class="line">        // 高亮当前图形</span><br><span class="line">        myChart.dispatchAction(&#123;</span><br><span class="line">          type: &#x27;highlight&#x27;,</span><br><span class="line">          seriesIndex: 0,</span><br><span class="line">          dataIndex: currentIndex</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      myChart.on(&#x27;mouseover&#x27;, (params) =&gt; &#123; // 用户鼠标悬浮到某一图形时，停止自动切换并高亮鼠标悬浮的图形</span><br><span class="line">        clearInterval(changePieInterval);</span><br><span class="line">        currentIndex = params.dataIndex;</span><br><span class="line">        highlightPie();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      myChart.on(&#x27;mouseout&#x27;, (params) =&gt; &#123; // 用户鼠标移出时，重新开始自动切换</span><br><span class="line">        if (changePieInterval)</span><br><span class="line">          clearInterval(changePieInterval);</span><br><span class="line">        changePieInterval = setInterval(selectPie, 1000);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      function selectPie() &#123; // 高亮效果切换到下一个图形</span><br><span class="line">        var dataLen = option.series[0].data.length;</span><br><span class="line">        currentIndex = (currentIndex + 1) % dataLen;</span><br><span class="line">        highlightPie();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      option &amp;&amp; myChart.setOption(option);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>echarts</tag>
      </tags>
  </entry>
</search>
