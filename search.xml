<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>前端面试题总结</title>
    <url>/10000/01/01/00%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    <content><![CDATA[<h1 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><p><a href="https://blog.csdn.net/weixin_43299180/article/details/129562275">https://blog.csdn.net/weixin_43299180/article/details/129562275</a></p>
<h2 id="0：为什么要初始化-CSS-样式？"><a href="#0：为什么要初始化-CSS-样式？" class="headerlink" title="0：为什么要初始化 CSS 样式？"></a>0：为什么要初始化 CSS 样式？</h2><p>初始化 CSS 样式是为了将所有浏览器的默认样式设置为一致的标准，以便更好地控制页面的布局和样式。各种浏览器默认样式不同，如果不进行初始化，很可能会导致页面样式不一致的问题。通过初始化 CSS 样式，开发人员可以确保所有元素的样式以统一的方式呈现，并可以从头开始定义其他样式，从而更轻松地管理页面样式。</p>
<h2 id="1：盒子模型"><a href="#1：盒子模型" class="headerlink" title="1：盒子模型"></a>1：盒子模型</h2><blockquote>
<p>普通盒子（W3C）：box-sizeing：content-box；盒子宽度 &#x3D; content + padding + border + margin<br>怪异盒子（IE）：box-sizeing：border-box；盒子宽度 &#x3D; content + margin（padding 和 border 都会计算在 content 内部）<br>box-sizing:inherit; 规定应从父元素继承 box-sizing 属性的值。<br>offsetWidth、clientWidth、scrollWidth<br>常规盒子：<br>offsetWidth：width + padding + border<br>clientWidth：width + padding<br>scrollWidth：padding + 内容实际尺寸<br>怪异盒子：<br>offsetWidth：width （因为怪异盒子，width 包含padding + border）<br>clientWidth：width - border<br>scrollWidth：内容实际尺寸 - border</p>
</blockquote>
<p>解决问题：<a href="https://www.lmlphp.com/user/58199/article/item/1758557/">https://www.lmlphp.com/user/58199/article/item/1758557/</a></p>
<img src="/10000/01/01/00%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/01box.png" width="50%">

<h2 id="2：BFC"><a href="#2：BFC" class="headerlink" title="2：BFC"></a>2：BFC</h2><blockquote>
<p>BFC，为 Block Formatting Context 的缩写，中文翻译为<b>块级格式化上下文</b>。<br>BFC 是 Web 页面 CSS 渲染的一个机制，是块级盒子布局中产生的区域，是一个独立的渲染区域，让处于 BFC 内部的元素与外部的元素相互隔离，使内外元素的定位不会相互影响;</p>
</blockquote>
<p>解决问题：<a href="https://www.bilibili.com/read/cv17894058">https://www.bilibili.com/read/cv17894058</a></p>
<h3 id="2-1：触发条件"><a href="#2-1：触发条件" class="headerlink" title="2-1：触发条件:"></a>2-1：触发条件:</h3><blockquote>
<p>根元素，即HTML元素<br>定位元素 position: absolute&#x2F;fixed<br>行内块元素 display的值为inline-block、table、flex、inline-flex、grid、inline-grid<br>浮动元素：float值为left、right<br>overflow值不为 visible，为 auto、scroll、hidden</p>
</blockquote>
<h3 id="2-2：BFC-属于普通流"><a href="#2-2：BFC-属于普通流" class="headerlink" title="2-2：BFC 属于普通流"></a>2-2：BFC 属于普通流</h3><blockquote>
<p>普通流:默认，从上而下，行内元素水平排列，行满换行，块级元素渲染成一个新行。<br>浮动:先按普通流位置出现，然后根据浮动方向偏移。<br>绝对定位:元素具体位置由绝对定位坐标组成。</p>
</blockquote>
<h3 id="2-3：规则"><a href="#2-3：规则" class="headerlink" title="2-3：规则:"></a>2-3：规则:</h3><p>1：属于同一个 BFC 的两个相邻元素垂直排列<br>2：属于同一个 BFC 的两个相邻元素垂直方向上的的 margin 会发生重叠<br>3：BFC 的区域不会与外部 float 的元素区域重叠，浮动元素在下方；<br>4：计算 BFC 的高度时，浮动子元素也参与计算<br>5：文字层不会被浮动层覆盖，环绕于周围</p>
<h3 id="2-4：应用"><a href="#2-4：应用" class="headerlink" title="2-4：应用:"></a>2-4：应用:</h3><p>阻止margin重叠<br>防止父元素高度塌陷<br>可以包含浮动元素 —— 清除内部浮动(清除浮动的原理是两个div都位于同一个 BFC 区域之中)<br>自适应两栏布局<br>可以阻止元素被浮动元素覆盖</p>
<h2 id="3：清除浮动方式"><a href="#3：清除浮动方式" class="headerlink" title="3：清除浮动方式"></a>3：清除浮动方式</h2><blockquote>
<p>清除浮动主要为了解决父级元素因为子级浮动引起内部高度塌陷的问题<br>1：父级div定义height<br>2：子元素结尾处加空div标签clear:both<br>3：父级div定义伪类:after设置clear:both<br>4：父级div定义overflow:hidden<br>5：父级div也浮动，需要定义宽度</p>
</blockquote>
<h2 id="4：link与-import的区别"><a href="#4：link与-import的区别" class="headerlink" title="4：link与@import的区别"></a>4：link与@import的区别</h2><p>1：从属关系区别<br>@import是 CSS 提供的语法规则，只有导入样式表的作用；link是HTML提供的标签，不仅可以加载 CSS 文件，还可以定义 RSS：rel 连接属性等。</p>
<p>2：加载顺序区别<br>加载页面时，link标签引入的 CSS 被同时加载；@import引入的 CSS 将在页面加载完毕后被加载。</p>
<p>3：兼容性区别<br>@import是 CSS2.1 才有的语法，故只可在 IE5+ 才能识别；link标签作为 HTML 元素，不存在兼容性问题。</p>
<p>4：DOM可控性区别<br>可以通过 JS 操作 DOM ，插入link标签来改变样式；由于 DOM 方法是基于文档的，无法使用@import的方式插入样式。</p>
<h2 id="5：css3"><a href="#5：css3" class="headerlink" title="5：css3"></a>5：css3</h2><blockquote>
<p>css，即层叠样式表（Cascading Style Sheets）的简称，是一种标记语言，由浏览器解释执行用来使页面变得更美观<br>css3是css的最新标准，是向后兼容的，CSS1&#x2F;2的特性在CSS3 里都是可以使用的<br>而CSS3 也增加了很多新特性，为开发带来了更佳的开发体验</p>
</blockquote>
<p>1：新增选择器<br>1-1：属性选择器<br>E[att^&#x3D;value]<br>E[att$&#x3D;value]<br>E[att*&#x3D;value]</p>
<p>1-2：伪类选择器<br>:root<br>:not<br>:only-child<br>:first-child和：last-child<br>:nth-child(n)和：nth-last-child(n)<br>:nth-of-type(n) 和:nth-last-of-type(n)<br>:target<br>:empty</p>
<p>2：新样式<br>边框阴影：box-shadow<br>边框图片：border-image<br>圆角边框：border-radius<br>背景的一些属性：background-origin、background-size，<br>文字效果：word-wrap、text-shadow，以提高网页字体的多样性。<br>颜色：rgba<br>3：transition 过渡<br>transition： CSS属性，花费时间，效果曲线(默认ease)，延迟时间(默认0)<br>4：transform 转换：旋转，缩放，倾斜或平移给定元素<br>5：animation 动画，可以制作简单的动画效果。<br>6：渐变：两个颜色之间平稳的过渡<br>7：布局：Flex弹性布局、Grid栅格布局<br>8：媒体查询 @media，可以让网页在不同的屏幕尺寸上适应不同的布局。</p>
<h2 id="6：有哪些方式（CSS）可以隐藏页面元素"><a href="#6：有哪些方式（CSS）可以隐藏页面元素" class="headerlink" title="6：有哪些方式（CSS）可以隐藏页面元素"></a>6：有哪些方式（CSS）可以隐藏页面元素</h2><p>opacity:0：本质上是将元素的透明度将为0，就看起来隐藏了，但是依然占据空间且可以交互<br>visibility:hidden: 与上一个方法类似的效果，占据空间，但是不可以交互了<br>overflow:hidden: 这个只隐藏元素溢出的部分，但是占据空间且不可交互<br>display:none: 这个是彻底隐藏了元素，元素从文档流中消失，既不占据空间也不交互，也不影响布局<br>z-index:-9999: 原理是将层级放到底部，这样就被覆盖了，看起来隐藏了<br>transform: scale(0,0): 平面变换，将元素缩放为0，但是依然占据空间，但不可交互</p>
<h2 id="7：em-x2F-px-x2F-rem-x2F-vh-x2F-vw-x2F-区别"><a href="#7：em-x2F-px-x2F-rem-x2F-vh-x2F-vw-x2F-区别" class="headerlink" title="7：em&#x2F;px&#x2F;rem&#x2F;vh&#x2F;vw&#x2F;%区别"></a>7：em&#x2F;px&#x2F;rem&#x2F;vh&#x2F;vw&#x2F;%区别</h2><p>1：px<br>px是像素单位。它是代表显示器上每一个显示的像素点，根据用户屏幕显示器的分辨率决定。<br>2：em<br>em为相对单位，相对于当前元素内文本的字体尺寸。如果当前元素没有指定字体尺寸，那么以浏览器默认的字体尺寸为准。<br>例如，当前元素设置了字体尺寸为24px，那么2em就代表48px。<br>3：rem<br>rem为相对单位，相对于<HTML>元素文本的字体尺寸。如果<HTML>元素没有指定字体尺寸，那么以浏览器默认的字体尺寸为准。<br>例如，<HTML>元素设置了字体尺寸为24px，那么2rem就代表48px。<br>4：vw和vh<br>vw和vh是相对单位，相对于当前视口。<br>例如，10vw代表当前视口宽度的10%，20vh代表当前视口高度的20%。<br>5：%<br>%是相对单位，相对于父元素的相关尺寸。</HTML></HTML></HTML></p>
<h2 id="8：LVHA-的解释"><a href="#8：LVHA-的解释" class="headerlink" title="8：LVHA 的解释"></a>8：LVHA 的解释</h2><p>LVHA的全称:Link Visited Hover Active (CSS anchor sequence) | 中文意思:───链接悬停访问活动(CSS定位序列)<br>a标签有四种状态：链接访问前、链接访问后、鼠标滑过、激活，分别对应四种伪类:link、:visited、:hover、:active；<br>a:link：未访问链接、a:visited：已访问链接、a:active：激活时(链接获得焦点时)链接的颜色、a:hover：鼠标移到链接上时</p>
<p>1、当鼠标滑过a链接时，满足:link和:hover两种状态；<br>2、当鼠标点击激活a链接时，同时满足:link、:hover、:active三种状态；<br>3、当链接访问过时，情况基本同上，只不过需要将:link换成:visited；</p>
<h2 id="9：伪类和伪元素的区别"><a href="#9：伪类和伪元素的区别" class="headerlink" title="9：伪类和伪元素的区别"></a>9：伪类和伪元素的区别</h2><p>伪类：用于向某些选择器添加特殊的效果，比如：:hover、:link、:active、:focus、:first-child 等；</p>
<p>伪元素：用于将特殊效果添加到某些选择器中；不存在在DOM文档中，是新创建的虚拟元素，代表某个元素的子元素，这个子元素虽然在逻辑上存在，但却并不实际存在于DOM树中；比如：::before、::after、::first-line、::fiest-letter 等；</p>
<p>区别：<br>1、根本区别在于是否创造了新的元素，这个新创造的元素就叫伪元素；<br>2、使用：伪类用单冒号，伪元素用双冒号；<br>3、伪类可以同时有多个，伪元素同时只能有一个；<br>4、伪类作用整个元素，伪元素作用于元素的一部分；</p>
<h2 id="10：CSS加载问题"><a href="#10：CSS加载问题" class="headerlink" title="10：CSS加载问题"></a>10：CSS加载问题</h2><p>css加载会不会阻塞dom解析？（不会，两者并行构建）<br>css加载会不会阻塞dom渲染？（会，需要两者协助）<br>dom树和css结构体一起形成一个renderTree然后再渲染的。<br>css加载会不会阻塞js执行？（会）<br>js和css的进程是互斥的，浏览器里面有个机制，css会先执行，js后执行，保证结果的可控性。<br>按钮css里面设置为蓝色，js里面设置为红色，正常执行的情况下，最后按钮是展示红色的。</p>
<h2 id="11：页面置灰"><a href="#11：页面置灰" class="headerlink" title="11：页面置灰"></a>11：页面置灰</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">	<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>); <span class="comment">/* 百分比或者 0~1 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12：重绘和回流"><a href="#12：重绘和回流" class="headerlink" title="12：重绘和回流"></a>12：重绘和回流</h2><blockquote>
<p>重绘：当render tree中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如background-color。则就叫称为重绘(改变样式)。<br>回流：当render tree中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流(改变大小)。<br>注：回流必将引起重绘，而重绘不一定会引起回流。<br><a href="https://baijiahao.baidu.com/s?id=1757771749150832752&wfr=spider&for=pc">https://baijiahao.baidu.com/s?id=1757771749150832752&amp;wfr=spider&amp;for=pc</a></p>
</blockquote>
<h3 id="如何最小化重绘和回流："><a href="#如何最小化重绘和回流：" class="headerlink" title="如何最小化重绘和回流："></a>如何最小化重绘和回流：</h3><blockquote>
<p>避免频繁使用 style，而是采用修改class的方式。<br>将动画效果应用到position属性为absolute或fixed的元素上。<br>批量操作 DOM，比如读取某元素 offsetWidth 属性存到一个临时变量，再去使用，而不是频繁使用这个计算属性；又比如利用 document.createDocumentFragment() 来添加要被添加的节点，处理完之后再插入到实际 DOM 中<br>也可以先为元素设置display: none，操作结束后再把它显示出来。因为在display属性为none的元素上进行的DOM操作不会引发回流和重绘<br>对于 resize、scroll 等进行防抖&#x2F;节流处理。<br>避免频繁读取会引发回流&#x2F;重绘的属性，如果确实需要多次使用，就用一个变量缓存起来。<br>利用 CSS3 的transform、opacity、filter这些属性可以实现合成的效果，也就是CPU加速。</p>
</blockquote>
<h2 id="13：响应式布局"><a href="#13：响应式布局" class="headerlink" title="13：响应式布局"></a>13：响应式布局</h2><p>头部必须有meta声明viewport；<br>1、媒体查询<br>可以通过给不同分辨率的设备编写不同的样式来实现响应式的布局</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen (<span class="attribute">min-width</span>: <span class="number">375px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">600px</span>) &#123;<span class="selector-tag">body</span>: &#123;<span class="attribute">font-size</span>: <span class="number">18px</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>2、百分比<br>浏览器的宽度或者高度发生变化时，通过百分比单位，可以使得浏览器中的组件的宽和高随着浏览器的变化而变化，从而实现响应式的效果；（布局的复杂度比较大，不建议使用）<br>3、vw&#x2F;vh<br>vw表示相对于视图窗口的宽度，vh表示相对于视图窗口高度。 任意层级元素，在使用vw单位的情况下，1vw都等于视图宽度的百分之一<br>4、rem<br>rem是相对于根元素html的font-size属性，默认情况下浏览器字体大小为16px，此时1rem &#x3D; 16px；可以利用前面提到的媒体查询，针对不同设备分辨率改变font-size的值；</p>
<h2 id="14：css-预编译，区别"><a href="#14：css-预编译，区别" class="headerlink" title="14：css 预编译，区别"></a>14：css 预编译，区别</h2><p>CSS 预处理器是一种语言用来为 CSS 增加一些编程的的特性，无需考虑浏览器的兼容性问题，例如你可以在 CSS 中使用变量、简单的程序逻辑、函数等等在编程语言中的一些基本技巧，可以让CSS 更见简洁，适应性更强，代码更直观等诸多好处。</p>
<p>预处理器扩充了 Css 语言，增加了诸如变量、混合（mixin）、函数等功能，让 Css 更易维护、方便；本质上，预处理是Css的超集；最终会通过解析器，编译生成对应的 Css 文件；</p>
<p>常见的有 sass 、less 、stylus；</p>
<p>优势：<br>1、嵌套<br>三者的嵌套语法都是一致的，甚至连引用父级选择器的标记 &amp; 也相同；区别只是 Sass 和 Stylus 可以用没有大括号的方式书写；</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scss</span></span><br><span class="line"><span class="selector-tag">nav</span> &#123; </span><br><span class="line">    <span class="selector-tag">ul</span> &#123; </span><br><span class="line">       <span class="attribute">margin</span>: <span class="number">0</span>; </span><br><span class="line">       <span class="attribute">padding</span>: <span class="number">0</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="selector-tag">li</span> &#123; </span><br><span class="line">       <span class="attribute">display</span>: inline-block; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// css</span></span><br><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">ul</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; </span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、变量：为 Css 增加了一种有效的复用方式；<br>less声明的变量必须以@开头，后面紧跟变量名和变量值，而且变量名和变量值需要使用冒号:分隔开；</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@maincolor :</span> <span class="number">#092873</span>;</span><br><span class="line"><span class="variable">@siteWidth :</span> <span class="number">1024px</span>;</span><br><span class="line"><span class="variable">@borderStyle :</span> dotted;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@maincolor</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="variable">@borderStyle</span> <span class="variable">@mainColor</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">@siteWidth</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sass声明的变量跟less十分的相似，只是变量名前面使用$开头；</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="variable">$maincolor</span> : <span class="number">#092873</span>;</span><br><span class="line"><span class="variable">$siteWidth</span> : <span class="number">1024px</span>;</span><br><span class="line"><span class="variable">$borderStyle</span> : dotted;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$maincolor</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="variable">$borderStyle</span> <span class="variable">$mainColor</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">$siteWidth</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>stylus声明的变量没有任何的限定，可以使用$开头，结尾的分号;可有可无，但变量与变量值之间需要使用&#x3D;。在stylus中我们不建议使用@符号开头声明变量；</p>
<figure class="highlight styl"><table><tr><td class="code"><pre><span class="line">maincolor = <span class="number">#092873</span></span><br><span class="line">siteWidth = <span class="number">1024px</span></span><br><span class="line">borderStyle = dotted</span><br><span class="line"><span class="selector-tag">body</span> </span><br><span class="line">  <span class="attribute">color</span> maincolor</span><br><span class="line">  <span class="attribute">border</span> <span class="number">1px</span> borderStyle mainColor</span><br><span class="line">  <span class="attribute">max-width</span> siteWidth</span><br></pre></td></tr></table></figure>
<p>3、作用域<br>sass中不存在全局变量，所以，在sass中最好不要定义相同的变量名；<br>less与stylus的作用域跟javascript十分的相似，首先会查找局部定义的变量，如果没有找到，会像冒泡一样，一级一级往下查找，直到根为止；<br>4、混入<br>在less中，混合的用法是指将定义好的ClassA中引入另一个已经定义的Class，也能使用够传递参数，参数变量为@声明；</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.error</span>(<span class="variable">@borderWidth</span>: <span class="number">2px</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">@borderWidth</span> solid <span class="number">#F00</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#F00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.generic-error</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="selector-class">.error</span>(); <span class="comment">//这里调用默认 border: 2px solid #F00;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.login-error</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="selector-class">.error</span>(<span class="number">5px</span>); <span class="comment">//这里调用 border:5px solid #F00;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Sass声明mixins时需要使用@mixin，后面紧跟mixin的名，也可以设置参数，参数名为变量$声明的形式；</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> error(<span class="variable">$borderWidth</span>: <span class="number">2px</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$borderWidth</span> solid <span class="number">#F00</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#F00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.generic-error</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">4px</span>;</span><br><span class="line">  @ include error(); <span class="comment">//这里调用默认 border: 2px solid #F00;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.login-error</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  @ include error(<span class="number">5px</span>); <span class="comment">//这里调用 border:5px solid #F00;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>stylus中的混合和前两款Css预处理器语言的混合略有不同，他可以不使用任何符号，就是直接声明Mixins名，然后在定义参数和默认值之间用等号（&#x3D;）来连接；</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error(borderWidth= 2px) &#123;</span><br><span class="line">  border: borderWidth solid #F00;</span><br><span class="line">  color: #F00;</span><br><span class="line">&#125;</span><br><span class="line">.generic-error &#123;</span><br><span class="line">  padding: 20px;</span><br><span class="line">  margin: 4px;</span><br><span class="line">  error(); </span><br><span class="line">&#125;</span><br><span class="line">.login-error &#123;</span><br><span class="line">  left: 12px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 20px;</span><br><span class="line">  error(5px); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、模块化：将Css代码分成一个个模块<br>很多 CSS 开发者对导入的做法都不太感冒，因为它需要多次的 HTTP 请求。但是在 CSS 预处理器中的导入操作则不同，它只是在语义上包含了不同的文件，但最终结果是一个单一的 CSS 文件，如果你是通过 @ import “file.css”; 导入 CSS 文件，那效果跟普通的 CSS 导入一样。<br>都可以只有 @import 引入一个 css 模块；</p>
<p>6、CSS 预处理器一般都会内置一些颜色处理函数用来对颜色值进行处理，例如加亮、变暗、颜色梯度等。<br>sass的颜色处理函数：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="variable">$colors</span>:(light:<span class="number">#fff</span>,bark:<span class="number">#000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">@function</span> <span class="attribute">color</span>(<span class="variable">$key</span>)&#123;</span><br><span class="line">	<span class="comment">// 返回数据</span></span><br><span class="line">	<span class="keyword">@return</span> map-get(<span class="variable">$colors</span>,<span class="variable">$key</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.asa&#123;</span><br><span class="line">	<span class="comment">// 调用</span></span><br><span class="line">	<span class="attribute">color</span>: <span class="built_in">color</span>(bark);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ================================</span></span><br><span class="line"><span class="built_in">lighten</span>($color, <span class="number">10%</span>); </span><br><span class="line"><span class="built_in">darken</span>($color, <span class="number">10%</span>);  </span><br><span class="line"><span class="built_in">saturate</span>($color, <span class="number">10%</span>);   </span><br><span class="line"><span class="built_in">desaturate</span>($color, <span class="number">10%</span>);</span><br><span class="line"><span class="built_in">grayscale</span>($color);  </span><br><span class="line"><span class="built_in">complement</span>($color); </span><br><span class="line"><span class="built_in">invert</span>($color); </span><br><span class="line"><span class="built_in">mix</span>($color1, $color2, <span class="number">50%</span>); </span><br><span class="line"><span class="comment">// 实例如下：</span></span><br><span class="line"><span class="variable">$color</span>: <span class="number">#0982C1</span>;</span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">$color</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">3px</span> solid <span class="built_in">darken</span>(<span class="variable">$color</span>, <span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Less css颜色处理函数：</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">lighten</span>(<span class="variable">@color</span>, <span class="number">10%</span>); </span><br><span class="line"><span class="selector-tag">darken</span>(<span class="variable">@color</span>, <span class="number">10%</span>);  </span><br><span class="line"><span class="selector-tag">saturate</span>(<span class="variable">@color</span>, <span class="number">10%</span>);  </span><br><span class="line"><span class="selector-tag">desaturate</span>(<span class="variable">@color</span>, <span class="number">10%</span>); </span><br><span class="line"><span class="selector-tag">spin</span>(<span class="variable">@color</span>, <span class="number">10</span>); </span><br><span class="line"><span class="selector-tag">spin</span>(<span class="variable">@color</span>, -<span class="number">10</span>); </span><br><span class="line"><span class="selector-tag">mix</span>(<span class="variable">@color1</span>, <span class="variable">@color2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &lt;!-- 示例如下： --&gt;</span></span><br><span class="line"></span><br><span class="line">@<span class="selector-tag">color</span>: <span class="selector-id">#0982C1</span>;</span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">@color</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">3px</span> solid <span class="built_in">darken</span>(<span class="variable">@color</span>, <span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Stylus颜色处理函数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lighten(color, 10%); </span><br><span class="line">darken(color, 10%);  </span><br><span class="line">saturate(color, 10%);  </span><br><span class="line">desaturate(color, 10%); </span><br><span class="line"></span><br><span class="line">示例如下;</span><br><span class="line"></span><br><span class="line">color = #0982C1 </span><br><span class="line">h1</span><br><span class="line">  background color</span><br><span class="line">  border 3px solid darken(color, 50%)</span><br></pre></td></tr></table></figure>

<p>7、继承</p>
<blockquote>
<p>当我们需要为多个元素定义相同样式的时候，我们可以考虑使用继承的做法.</p>
</blockquote>
<p>sass<br>sass可通过@extend来实现代码组合声明，使代码更加优越简洁。</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-class">.message</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.success</span> &#123;</span><br><span class="line">  <span class="keyword">@extend</span> .message;</span><br><span class="line">  <span class="attribute">border-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Less：<br>但是在这方面 Less 表现的稍微弱一些，更像是混入写法：</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.message</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.success</span> &#123;</span><br><span class="line">  <span class="selector-class">.message</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>8.高级语法sass</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// @if---------------------</span></span><br><span class="line"><span class="variable">$use-info</span>:true;</span><br><span class="line"><span class="variable">$theme</span>:<span class="string">&#x27;dark&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.as</span>&#123;</span><br><span class="line">	<span class="keyword">@if</span> <span class="variable">$use-info</span>&#123;</span><br><span class="line">		<span class="attribute">background-color</span>: green;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @for--------------------</span></span><br><span class="line"><span class="variable">$columns</span>:<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//从一到四</span></span><br><span class="line"><span class="keyword">@for</span> <span class="variable">$i</span> from <span class="number">1</span> through <span class="variable">$columns</span>&#123;</span><br><span class="line">	<span class="selector-class">.col-</span>#&#123;<span class="variable">$i</span>&#125;&#123;</span><br><span class="line">		<span class="attribute">width</span>: <span class="number">100%</span> / <span class="variable">$columns</span> * <span class="variable">$i</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15、Canvas和svg的区别"><a href="#15、Canvas和svg的区别" class="headerlink" title="15、Canvas和svg的区别"></a>15、Canvas和svg的区别</h2><p>1、canvas是H5提供的新绘图方法，svg很早就出现了；<br>2、canvas基于像素点，是位图，放大缩小会失真，svg是用html标签绘制，放大缩小不会失真；<br>3、canvas在js里面绘制，svg在html里面；<br>4、canvas支持颜色比svg多；<br>5、canvas无法修改已经绘制的图像，svg可以获取到标签进行修改；</p>
<blockquote>
<p>Canvas 是一个矩形区域的画布，可以用 JavaScript 在上面绘画。控制其每一个像素。<br>canvas 标签使用 JavaScript 在网页上绘制图像，本身不具备绘图功能。<br>canvas 拥有多种绘制路径、矩形、圆形、字符以及添加图像的方法。<br>HTML5 之前的 web 页面只能用一些固定样式的标签：比如 p、div、h1 等</p>
</blockquote>
<h2 id="16、position定位有哪些方式，有什么不同"><a href="#16、position定位有哪些方式，有什么不同" class="headerlink" title="16、position定位有哪些方式，有什么不同"></a>16、position定位有哪些方式，有什么不同</h2><blockquote>
<p>static：元素默认状态，可以将设置position的元素回到文档流中，对设置 z-index 的元素无效；<br>relative：相对定位，不脱离文档流，并按照文档流中的顺序进行排列；一般作为绝对定位的定位父元素；<br>absolute：绝对定位，脱离文档流，参照物为第一个定位祖先或根元素；<br>fixed：固定定位，脱离文档流，以浏览器可视窗口作为参照物；<br>sticky：不脱离文档流，仍然保留元素原本在文档流中的位置；当元素在容器（相对定位）中被滚动超过指定的偏移值时，元素在容器内固定在指定位置。</p>
</blockquote>
<h2 id="17、为什么要初始化CSS样式"><a href="#17、为什么要初始化CSS样式" class="headerlink" title="17、为什么要初始化CSS样式?"></a>17、为什么要初始化CSS样式?</h2><p>不同浏览器标签的默认值是不一样的，不初始化，不同浏览器渲染出来的效果会有差异；</p>
<h2 id="18、CSS性能优化是指通过采取一系列技术和最佳实践来提升CSS代码的加载速度、渲染性能和用户体验。CSS在网页中扮演着关键的角色，因此提高CSS性能可以显著改善网页性能，并减少用户等待时间。以下是一些常见的CSS性能优化技巧："><a href="#18、CSS性能优化是指通过采取一系列技术和最佳实践来提升CSS代码的加载速度、渲染性能和用户体验。CSS在网页中扮演着关键的角色，因此提高CSS性能可以显著改善网页性能，并减少用户等待时间。以下是一些常见的CSS性能优化技巧：" class="headerlink" title="18、CSS性能优化是指通过采取一系列技术和最佳实践来提升CSS代码的加载速度、渲染性能和用户体验。CSS在网页中扮演着关键的角色，因此提高CSS性能可以显著改善网页性能，并减少用户等待时间。以下是一些常见的CSS性能优化技巧："></a>18、CSS性能优化是指通过采取一系列技术和最佳实践来提升CSS代码的加载速度、渲染性能和用户体验。CSS在网页中扮演着关键的角色，因此提高CSS性能可以显著改善网页性能，并减少用户等待时间。以下是一些常见的CSS性能优化技巧：</h2><p>减少选择器的复杂性：使用简单的选择器，并避免嵌套层数过深。复杂的选择器会增加渲染时间。</p>
<p>压缩和合并CSS文件：通过消除空格、注释和无用的代码，减少CSS文件的尺寸。此外，将多个CSS文件合并成一个文件可以减少HTTP请求的数量。</p>
<p>使用合适的CSS预处理器：CSS预处理器（如Sass或Less）可以提供更强大和可维护的CSS编写方式。预处理器提供了变量、嵌套、混合等功能，但在编译为最终的CSS文件时，要确保生成的CSS代码是简洁且高效的。</p>
<p>避免使用昂贵的CSS属性：一些CSS属性（如box-shadow和text-shadow）可能会导致性能问题，特别是在大量重复使用或动态更新的情况下。尽量减少使用这些属性或使用更简单的替代方案。</p>
<p>使用CSS Sprites：将多个小图标合并成一个大图，然后使用背景定位来显示需要的图标。这样可以减少HTTP请求的数量，并提高图标的加载速度。</p>
<p>对CSS进行异步加载：使用异步加载CSS的方法，如将CSS放在页面底部或使用preload和async属性。</p>
<p>使用媒体查询进行响应式设计：通过在不同的屏幕尺寸上应用不同的CSS样式，可以减少不必要的样式渲染和布局计算。</p>
<p>使用硬件加速：对于一些复杂的CSS动画效果，可以利用CSS属性transform和opacity触发硬件加速（GPU加速），以提高动画的流畅度和性能。</p>
<p>避免使用@import导入样式表：@import会导致样式表的延迟加载，建议使用<link>标签来引入外部样式表。</p>
<p>使用适当的选择器权重：选择器的权重决定了CSS规则的优先级。避免过度使用通用选择器和后代选择器，以减少不必要的样式计算。</p>
<h1 id="js"><a href="#js" class="headerlink" title="js"></a>js</h1><h1 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h1><h1 id="vue2"><a href="#vue2" class="headerlink" title="vue2"></a>vue2</h1><h1 id="vue3"><a href="#vue3" class="headerlink" title="vue3"></a>vue3</h1><h1 id="小程序"><a href="#小程序" class="headerlink" title="小程序"></a>小程序</h1><h1 id="three-js"><a href="#three-js" class="headerlink" title="three.js"></a>three.js</h1>]]></content>
      <tags>
        <tag>面试题</tag>
      </tags>
  </entry>
  <entry>
    <title>修改ElementUI文本域的placeholder颜色</title>
    <url>/2021/01/01/01%E4%BF%AE%E6%94%B9%E6%96%87%E6%9C%AC%E5%9F%9F%E7%9A%84placeholder%E9%A2%9C%E8%89%B2/</url>
    <content><![CDATA[<h1 id="修改文本域的placeholder颜色并取消拖拽"><a href="#修改文本域的placeholder颜色并取消拖拽" class="headerlink" title="修改文本域的placeholder颜色并取消拖拽"></a>修改文本域的placeholder颜色并取消拖拽</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.el-textarea</span> /deep/<span class="selector-class">.el-textarea__inner</span> &#123;</span><br><span class="line"> &amp;<span class="selector-pseudo">::placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#bfc4cc</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: MicrosoftYaHei, PingFangSC-Regular, HiraginoSansGB-W3,</span><br><span class="line">   HelveticaNeue, Helvetica, Arial;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//禁止拖拽</span><br><span class="line"><span class="selector-tag">textarea</span>&#123;</span><br><span class="line"> <span class="attribute">resize</span>:none;  <span class="comment">/* 取消拖拽 */</span></span><br><span class="line"> <span class="attribute">outline</span>: none;<span class="comment">/* 取消选中高亮 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>文本域</tag>
      </tags>
  </entry>
  <entry>
    <title>ip4/6及ip段的正则表达式校验</title>
    <url>/2021/01/03/02ip%E5%8F%8Aip%E6%AE%B5%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="ip4-x2F-6的正则表达式校验规则"><a href="#ip4-x2F-6的正则表达式校验规则" class="headerlink" title="ip4&#x2F;6的正则表达式校验规则"></a>ip4&#x2F;6的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ip4</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">validIp4</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入ip&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> ipv4 =</span><br><span class="line">          <span class="string">&quot;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)&quot;</span>;</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^(<span class="subst">$&#123;ipv4&#125;</span>)$`</span>);</span><br><span class="line">          <span class="comment">//let reg = /^($&#123;ipv4&#125;)$/</span></span><br><span class="line">        <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;ip格式不正确&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ip6</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">validIp6</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (value) &#123;</span><br><span class="line">    <span class="keyword">const</span> ipv6 =</span><br><span class="line">      <span class="string">&quot;([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|::([\\da-fA-F]&#123;1,4&#125;:)&#123;0,4&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:):([\\da-fA-F]&#123;1,4&#125;:)&#123;0,3&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,2&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,1&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;:((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|([\\da-fA-F]&#123;1,4&#125;:)&#123;7&#125;[\\da-fA-F]&#123;1,4&#125;|:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,6&#125;|:)|[\\da-fA-F]&#123;1,4&#125;:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|:)|([\\da-fA-F]&#123;1,4&#125;:)&#123;5&#125;:([\\da-fA-F]&#123;1,4&#125;)?|([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;:&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^(<span class="subst">$&#123;ipv6&#125;</span>)$`</span>);</span><br><span class="line">    <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;ip格式不正确&quot;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h1 id="ip4-x2F-6段的正则表达式校验规则"><a href="#ip4-x2F-6段的正则表达式校验规则" class="headerlink" title="ip4&#x2F;6段的正则表达式校验规则"></a>ip4&#x2F;6段的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">validIp</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入ip段&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> semicolon = <span class="string">&quot;[;；]&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> ipv4 =</span><br><span class="line">          <span class="string">&quot;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> mask = <span class="string">&quot;([1-9]|[1-2][0-9]|3[0-2])&quot;</span>;</span><br><span class="line">        <span class="keyword">const</span> ipv6WithMask =</span><br><span class="line">          <span class="string">&quot;([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|::([\\da-fA-F]&#123;1,4&#125;:)&#123;0,4&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:):([\\da-fA-F]&#123;1,4&#125;:)&#123;0,3&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,2&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;:([\\da-fA-F]&#123;1,4&#125;:)&#123;0,1&#125;((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;:((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.)&#123;3&#125;(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;7&#125;[\\da-fA-F]&#123;1,4&#125;(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,6&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|[\\da-fA-F]&#123;1,4&#125;:((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;2&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;3&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;4&#125;((:[\\da-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|:)(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;5&#125;:([\\da-fA-F]&#123;1,4&#125;)?(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))|([\\da-fA-F]&#123;1,4&#125;:)&#123;6&#125;:(\\/([1-9]|[1-9]\\d|1[01]\\d|12[0-8]))&quot;</span>;</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(</span><br><span class="line">          <span class="string">`^((<span class="subst">$&#123;ipv4&#125;</span>\\/<span class="subst">$&#123;mask&#125;</span>)|(<span class="subst">$&#123;ipv6WithMask&#125;</span>))(<span class="subst">$&#123;semicolon&#125;</span>((<span class="subst">$&#123;ipv4&#125;</span>\\/<span class="subst">$&#123;mask&#125;</span>)|(<span class="subst">$&#123;ipv6WithMask&#125;</span>)))*$`</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (!reg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;格式不正确&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>端口域名的正则表达式校验</title>
    <url>/2021/01/04/03%E7%AB%AF%E5%8F%A3%E5%9F%9F%E5%90%8D%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="端口域名的正则表达式校验规则"><a href="#端口域名的正则表达式校验规则" class="headerlink" title="端口域名的正则表达式校验规则"></a>端口域名的正则表达式校验规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在rules配置域名domain字段的正则表达式校验</span></span><br><span class="line"><span class="attr">rules</span>: &#123;</span><br><span class="line">  <span class="attr">domain</span>: [</span><br><span class="line">          <span class="comment">// 支持 泛域名 *.ctyun.cn</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">              <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span>,</span><br><span class="line">              <span class="attr">pattern</span>: <span class="regexp">/^(\*\.|\*)?([a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?\.)+[a-zA-Z]&#123;2,6&#125;$/</span>,</span><br><span class="line">              <span class="attr">message</span>: <span class="string">&quot;请输入正确的域名&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          ],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置端口正则表达式校验的处理函数</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title function_">valiPost</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (value == <span class="string">&quot;&quot;</span> || value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;请输入端口数字值&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title class_">Post</span> =<span class="regexp">/^([0-9]|[1-9]\d|[1-9]\d&#123;2&#125;|[1-9]\d&#123;3&#125;|[1-5]\d&#123;4&#125;|6[0-4]\d&#123;3&#125;|65[0-4]\d&#123;2&#125;|655[0-2]\d|6553[0-5])$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title class_">Post</span>.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;端口不在合法范围&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>前端获取响应头返回的字段</title>
    <url>/2021/01/10/04%E5%89%8D%E7%AB%AF%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E5%A4%B4%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AD%97%E6%AE%B5/</url>
    <content><![CDATA[<h1 id="前端获取响应头返回的字段"><a href="#前端获取响应头返回的字段" class="headerlink" title="前端获取响应头返回的字段"></a>前端获取响应头返回的字段</h1><p>1：在导出文件的时候，有些文件名需要后端那边动态展示，后端便会在响应头返回某字段<br>2：前端需要知道怎么获取<br>3：有些后端也没有试过怎么从响应头返回字段，有些仅以为写某些字段在响应头就行<br>4：前端现在只看得到，去拿不到<br>4：此时后端需要在响应头上设置 Access-Control-Expose-Headers</p>
<p><img src="/2021/01/10/04%E5%89%8D%E7%AB%AF%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E5%A4%B4%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AD%97%E6%AE%B5/01.png"></p>
]]></content>
      <tags>
        <tag>响应头</tag>
      </tags>
  </entry>
  <entry>
    <title>去掉空格、换行的正则表达式</title>
    <url>/2021/01/13/05%E5%8E%BB%E6%8E%89%E7%A9%BA%E6%A0%BC%E6%A0%A1%E9%AA%8C-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="去掉空格、换行的正则表达式"><a href="#去掉空格、换行的正则表达式" class="headerlink" title="去掉空格、换行的正则表达式"></a>去掉空格、换行的正则表达式</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//去除空格 </span></span><br><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">Trim</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">replace</span>(<span class="regexp">/\s+/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除换行 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ClearBr</span>(<span class="params">key</span>) &#123; </span><br><span class="line">key = key.<span class="title function_">replace</span>(<span class="regexp">/&lt;\/?.+?&gt;/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">key = key.<span class="title function_">replace</span>(<span class="regexp">/[\r\n]/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line"><span class="keyword">return</span> key; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除左侧空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LTrim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/^\s*/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去右空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RTrim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/\s*$/g</span>,<span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去掉字符串两端的空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/(^\s*)|(\s*$)/g</span>, <span class="string">&quot;&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//去除字符串中间空格 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CTim</span>(<span class="params">str</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>空格</tag>
      </tags>
  </entry>
  <entry>
    <title>验证码流字符串转图片（*js-base64*）</title>
    <url>/2021/01/20/06%E9%AA%8C%E8%AF%81%E7%A0%81%E6%B5%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="验证码流字符串转图片（js-base64）"><a href="#验证码流字符串转图片（js-base64）" class="headerlink" title="验证码流字符串转图片（js-base64）"></a>验证码流字符串转图片（<em>js-base64</em>）</h1><p>1：下载第三方包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i js-base64</span><br></pre></td></tr></table></figure>


<h2 id="js-base64常规方法：编码-解码-乱码"><a href="#js-base64常规方法：编码-解码-乱码" class="headerlink" title="js-base64常规方法：编码-解码-乱码"></a>js-base64常规方法：编码-解码-乱码</h2><p>（官方文档<a href="https://www.npmjs.com/package/js-base64%EF%BC%89">https://www.npmjs.com/package/js-base64）</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 编码base64</span></span><br><span class="line"> <span class="title function_">getEncode64</span>(<span class="params">str</span>)&#123;</span><br><span class="line">     <span class="comment">// 对字符串进行编码</span></span><br><span class="line">     <span class="keyword">var</span> encode = <span class="built_in">encodeURI</span>(str);</span><br><span class="line">     <span class="comment">// 对编码的字符串转化base64</span></span><br><span class="line">     <span class="keyword">var</span> base64 = <span class="title function_">btoa</span>(encode);</span><br><span class="line">     <span class="keyword">return</span> base64;</span><br><span class="line">   &#125;,</span><br><span class="line">       </span><br><span class="line"><span class="comment">// base64转字符串解码</span></span><br><span class="line">   <span class="title function_">getDecode</span>(<span class="params">str</span>)&#123;</span><br><span class="line">      <span class="comment">// 对base64转编码</span></span><br><span class="line">      <span class="keyword">var</span> decode = <span class="title function_">atob</span>(base64);</span><br><span class="line">      <span class="comment">// 编码转字符串</span></span><br><span class="line">      <span class="keyword">var</span> str = <span class="built_in">decodeURI</span>(decode);</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">  &#125;,</span><br><span class="line">      </span><br><span class="line"><span class="comment">//问题：</span></span><br><span class="line">用上述的编码和解码，自己前端操作编译和解码中文都是没有问题的，但是由于需要后台，编码后传输到后台，后台返回编码格式再解码的时候就会出现中文乱码。</span><br><span class="line"></span><br><span class="line">原因：</span><br><span class="line">一番查找下来，可能是由于 常规的encode方法虽然界面上转的是utf-<span class="number">8</span>，但是实际上传输存储的时候格式还是utf-<span class="number">16</span>，后台返回的是utf-<span class="number">8</span>格式，用decode界面实际上转的是utf-<span class="number">16</span>,转utf-<span class="number">8</span>会出现中文乱码。也就是说上述的编码和解码，适用于页面本身编码解码，不适合传输用。</span><br><span class="line"></span><br><span class="line"><span class="comment">//解决解码中文乱码：</span></span><br><span class="line"><span class="title function_">getEncode64</span>(<span class="params">str</span>)&#123;   </span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">btoa</span>(<span class="built_in">encodeURIComponent</span>(str).<span class="title function_">replace</span>(<span class="regexp">/%([0-9A-F]&#123;2&#125;)/g</span>,</span><br><span class="line">          <span class="keyword">function</span> <span class="title function_">toSolidBytes</span>(<span class="params">match, p1</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="string">&#x27;0x&#x27;</span> + p1);</span><br><span class="line">         &#125;));</span><br><span class="line">            </span><br><span class="line">  &#125;,</span><br><span class="line">      </span><br><span class="line"><span class="title function_">getDecode</span>(<span class="params">str</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(<span class="title function_">atob</span>(str).<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&#x27;%&#x27;</span> + (<span class="string">&#x27;00&#x27;</span> + c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>).<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">slice</span>(-<span class="number">2</span>);</span><br><span class="line">      &#125;).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <tags>
        <tag>验证码</tag>
      </tags>
  </entry>
  <entry>
    <title>this.$set(),对象和数组的注入方式</title>
    <url>/2021/01/24/07this.$set%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="this-set-对象和数组的注入方式"><a href="#this-set-对象和数组的注入方式" class="headerlink" title="this.$set(),对象和数组的注入方式"></a>this.$set(),对象和数组的注入方式</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//对象</span></span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="string">&#x27;&#123;object&#125;&#x27;</span>,<span class="string">&#x27;要添加注入的属性名&#x27;</span>,<span class="string">&#x27;设置的属性值&#x27;</span>)</span><br><span class="line"><span class="comment">//数组</span></span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="string">&#x27;数组&#x27;</span>,<span class="title function_">index</span>(数组的下标),<span class="string">&#x27;要赋的值值&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>$set</tag>
      </tags>
  </entry>
  <entry>
    <title>表单enter阻止事件</title>
    <url>/2021/02/02/08%E8%A1%A8%E5%8D%95enter%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="表单enter阻止事件"><a href="#表单enter阻止事件" class="headerlink" title="表单enter阻止事件"></a>表单enter阻止事件</h1><p>1：需要添加 @submit.native.prevent 事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;el-form :inline=<span class="string">&quot;true&quot;</span> :model=<span class="string">&quot;search&quot;</span> @submit.<span class="property">native</span>.<span class="property">prevent</span>&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>vue传值EventBus的坑</title>
    <url>/2021/02/05/09vue%E4%BC%A0%E5%80%BCEventBus%E7%9A%84%E5%9D%91/</url>
    <content><![CDATA[<h1 id="vue传值EventBus的坑"><a href="#vue传值EventBus的坑" class="headerlink" title="vue传值EventBus的坑"></a>vue传值EventBus的坑</h1><h2 id="1：创建空js文件–src-utils-eventBus-js（路径）"><a href="#1：创建空js文件–src-utils-eventBus-js（路径）" class="headerlink" title="1：创建空js文件–src\utils\eventBus.js（路径）"></a>1：创建空js文件–src\utils\eventBus.js（路径）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vue</span>()</span><br></pre></td></tr></table></figure>

<h2 id="2：在需要传值的-兄弟组件1-中导入并使用传值"><a href="#2：在需要传值的-兄弟组件1-中导入并使用传值" class="headerlink" title="2：在需要传值的 兄弟组件1 中导入并使用传值"></a>2：在需要传值的 兄弟组件1 中导入并使用传值</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//导入（兄弟组件1）</span></span><br><span class="line"><span class="keyword">import</span> eventBus <span class="keyword">from</span> <span class="string">&#x27;@/utils/eventBus&#x27;</span></span><br><span class="line"><span class="comment">//兄弟组件1传值给兄弟组件2</span></span><br><span class="line">eventBus.$emit(<span class="string">&#x27;sendFieldTableData&#x27;</span>, value)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 兄弟组件2接收兄弟组件1的传值（兄弟组件2）</span></span><br><span class="line">eventBus.$on(<span class="string">&#x27;sendFieldTableData&#x27;</span>, <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">fieldTableData</span> = value</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3：eventBus的坑（每次使用需要-off来注销）"><a href="#3：eventBus的坑（每次使用需要-off来注销）" class="headerlink" title="3：eventBus的坑（每次使用需要$off来注销）"></a>3：eventBus的坑（每次使用需要$off来注销）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$on会多次触发</span></span><br><span class="line"><span class="comment">//在使用$on的组件必须要注销要不然会逐渐追加调用1+1+2+3</span></span><br><span class="line"><span class="title function_">creatr</span>(<span class="params"></span>)&#123;</span><br><span class="line">	eventBus.$on(<span class="string">&#x27;sendId&#x27;</span>, <span class="title function_">async</span>(item) =&gt; &#123;&#125;)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 销毁多次触发</span></span><br><span class="line">  eventBus.$off(<span class="string">&#x27;selfId&#x27;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>vue传值</tag>
      </tags>
  </entry>
  <entry>
    <title>判断数据类型的方法</title>
    <url>/2021/02/20/12%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="判断数据类型的方法"><a href="#判断数据类型的方法" class="headerlink" title="判断数据类型的方法"></a>判断数据类型的方法</h1><h3 id="下面是typeof、instanceof、constructor三种方法判断数据类型的用法"><a href="#下面是typeof、instanceof、constructor三种方法判断数据类型的用法" class="headerlink" title="下面是typeof、instanceof、constructor三种方法判断数据类型的用法"></a>下面是typeof、instanceof、constructor三种方法判断数据类型的用法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一种typeof</span></span><br><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>:<span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn=<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="number">1</span>);       <span class="comment">//number</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="string">&#x27;abc&#x27;</span>);   <span class="comment">//string</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">true</span>);    <span class="comment">//boolean</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">undefined</span>);  <span class="comment">//undefined </span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> fn);      <span class="comment">//function</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> (<span class="keyword">new</span> <span class="title class_">Date</span>) );  <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>);     <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);  <span class="comment">//object</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> obj);      <span class="comment">//object</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//instanceof</span></span><br><span class="line"> <span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line">        <span class="keyword">let</span> obj=&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>:<span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn=<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(arr <span class="keyword">instanceof</span> <span class="title class_">Array</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Object</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(fn <span class="keyword">instanceof</span> <span class="title class_">Function</span>);  <span class="comment">//true</span></span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="keyword">new</span> <span class="title class_">Date</span>) <span class="keyword">instanceof</span> <span class="title class_">Date</span>);  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//constructor</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">        <span class="keyword">let</span> obj = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;dawn&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是 function 类型&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="number">9</span>).<span class="property">constructor</span> === <span class="title class_">Number</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>.<span class="property">constructor</span> === <span class="title class_">String</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">true</span>.<span class="property">constructor</span> === <span class="title class_">Boolean</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(fn.<span class="property">constructor</span> === <span class="title class_">Function</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="property">constructor</span> === <span class="title class_">Date</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">constructor</span> === <span class="title class_">Object</span>);  <span class="comment">//true</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="property">constructor</span> === <span class="title class_">Array</span>);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>数据类型</tag>
      </tags>
  </entry>
  <entry>
    <title>数组里的对象怎么排序</title>
    <url>/2021/02/07/10%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%80%8E%E4%B9%88%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<h1 id="数组里的对象怎么排序sort"><a href="#数组里的对象怎么排序sort" class="headerlink" title="数组里的对象怎么排序sort()"></a>数组里的对象怎么排序sort()</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//一般数组排序事例：</span></span><br><span class="line"><span class="keyword">var</span> presonArr = [<span class="number">2</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">22</span>,<span class="number">10</span>]</span><br><span class="line">presonArr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> a - b;	</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(presonArr);<span class="comment">//[1, 2, 3, 6, 9, 10, 22]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组里的对象排序</span></span><br><span class="line"><span class="keyword">var</span> presonArr = [</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;freddy&#x27;</span>, <span class="attr">age</span>:<span class="number">24</span>, <span class="attr">score</span>:<span class="number">97</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;nick&#x27;</span>, <span class="attr">age</span>:<span class="number">18</span>, <span class="attr">score</span>:<span class="number">87</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;mike&#x27;</span>, <span class="attr">age</span>:<span class="number">26</span>, <span class="attr">score</span>:<span class="number">80</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;james&#x27;</span>, <span class="attr">age</span>:<span class="number">34</span>, <span class="attr">score</span>:<span class="number">90</span> &#125;,</span><br><span class="line">	&#123; <span class="attr">name</span>:<span class="string">&#x27;curry&#x27;</span>, <span class="attr">age</span>:<span class="number">30</span>, <span class="attr">score</span>:<span class="number">83</span> &#125;</span><br><span class="line">];</span><br><span class="line">presonArr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> a.<span class="property">age</span> - b.<span class="property">age</span>;	</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(presonArr);</span><br></pre></td></tr></table></figure>
<p><img src="/2021/02/07/10%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%80%8E%E4%B9%88%E6%8E%92%E5%BA%8F/01.png"></p>
]]></content>
      <tags>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>给Element的el-table表头加必选星号</title>
    <url>/2021/02/10/11%E7%BB%99el-table%E8%A1%A8%E5%A4%B4%E5%8A%A0%E5%BF%85%E9%80%89%E6%98%9F%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="给Element的el-table表头加必选星号"><a href="#给Element的el-table表头加必选星号" class="headerlink" title="给Element的el-table表头加必选星号"></a>给Element的el-table表头加必选星号</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1：在el-table-column 上添加render-header属性。render-header指定列标题 Label 区域渲染使用的 Function</span></span><br><span class="line">&lt;el-table-column label=<span class="string">&quot;地域&quot;</span> align=<span class="string">&quot;center&quot;</span> :render-header=<span class="string">&quot;addRedStar&quot;</span>&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2：addRedStar函数</span></span><br><span class="line">  <span class="title function_">addRedStar</span>(<span class="params">h, &#123; column &#125;</span>) &#123; <span class="comment">// 给表头加必选标识</span></span><br><span class="line">     <span class="keyword">return</span> [<span class="title function_">h</span>(<span class="string">&#x27;span&#x27;</span>, &#123; <span class="attr">style</span>: <span class="string">&#x27;color: red&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>), <span class="title function_">h</span>(<span class="string">&#x27;span&#x27;</span>, <span class="string">&#x27; &#x27;</span> + column.<span class="property">label</span>)]</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>表格</tag>
      </tags>
  </entry>
  <entry>
    <title>封装下载/导出文件流的api</title>
    <url>/2021/02/24/13%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%B5%81%E7%9A%84api%E5%B0%81%E8%A3%85/</url>
    <content><![CDATA[<h1 id="封装下载-x2F-导出文件流的api"><a href="#封装下载-x2F-导出文件流的api" class="headerlink" title="封装下载&#x2F;导出文件流的api"></a>封装下载&#x2F;导出文件流的api</h1><h2 id="下载-x2F-导出-XXX-模板"><a href="#下载-x2F-导出-XXX-模板" class="headerlink" title="下载&#x2F;导出 XXX 模板"></a>下载&#x2F;导出 XXX 模板</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">downCancelTemplate</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/v1/download&#x27;</span>,<span class="comment">//导出url</span></span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">responseType</span>: <span class="string">&#x27;blob&#x27;</span><span class="comment">//转文件流（导出接口api一定要设置）</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下载-x2F-导出模板按钮使用参考代码"><a href="#下载-x2F-导出模板按钮使用参考代码" class="headerlink" title="下载&#x2F;导出模板按钮使用参考代码"></a>下载&#x2F;导出模板按钮使用参考代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">downloadTemplateFn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//接口请求</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">downCancelTemplate</span>()</span><br><span class="line">    <span class="comment">// 创建一个url</span></span><br><span class="line">    <span class="keyword">const</span> fileUrl = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res]))</span><br><span class="line">    <span class="comment">// 创建a标签</span></span><br><span class="line">    <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="comment">// 通过样式隐藏a标签</span></span><br><span class="line">    link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">    <span class="comment">// 把url放到a标签中</span></span><br><span class="line">    link.<span class="property">href</span> = fileUrl</span><br><span class="line">    link.<span class="property">download</span> = <span class="string">`XXX 模板.xlsx`</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link)</span><br><span class="line">    link.<span class="title function_">click</span>()</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link)</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(fileUrl)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(err.<span class="property">msg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>当文本行超出宽度时换行</title>
    <url>/2021/03/19/15%E5%BD%93%E6%96%87%E6%9C%AC%E8%A1%8C%E8%B6%85%E5%87%BA%E5%AE%BD%E5%BA%A6%E6%8D%A2%E8%A1%8C/</url>
    <content><![CDATA[<h1 id="当文本行超出宽度时换行"><a href="#当文本行超出宽度时换行" class="headerlink" title="当文本行超出宽度时换行"></a>当文本行超出宽度时换行</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给span添加属性</span></span><br><span class="line"> word-<span class="attr">break</span>: <span class="keyword">break</span>-all; <span class="regexp">/如果单词超过宽度了，整个单词打散，超过的部分换行 */</span></span><br><span class="line"> white-<span class="attr">space</span>: normal; <span class="regexp">/ 重点是这个属性 */</span></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>文本换行</tag>
      </tags>
  </entry>
  <entry>
    <title>阻止事件冒泡(@click.native.stop)</title>
    <url>/2021/03/10/14%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/</url>
    <content><![CDATA[<h1 id="阻止事件冒泡-click-native-stop"><a href="#阻止事件冒泡-click-native-stop" class="headerlink" title="阻止事件冒泡(@click.native.stop)"></a>阻止事件冒泡(@click.native.stop)</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;el-button @click.<span class="property">native</span>.<span class="property">stop</span>&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>事件冒泡</tag>
      </tags>
  </entry>
  <entry>
    <title>递归树排序</title>
    <url>/2021/04/01/16%E9%80%92%E5%BD%92%E6%A0%91%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<h1 id="递归树排序"><a href="#递归树排序" class="headerlink" title="递归树排序"></a>递归树排序</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 递归树排序</span></span><br><span class="line">    <span class="title function_">treeStore</span>(<span class="params">val</span>) &#123;</span><br><span class="line">      val.<span class="property">children</span> &amp;&amp; val.<span class="property">children</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item1</span> =&gt;</span> &#123;</span><br><span class="line">        item1.<span class="property">children</span> &amp;&amp; item1.<span class="property">children</span>.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">before, after</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> before.<span class="property">sort</span> - after.<span class="property">sort</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">treeStore</span>(item1)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>字体添加渐变颜色</title>
    <url>/2021/04/11/18%E5%AD%97%E4%BD%93%E6%B7%BB%E5%8A%A0%E6%B8%90%E5%8F%98%E9%A2%9C%E8%89%B2/</url>
    <content><![CDATA[<h1 id="字体添加渐变颜色"><a href="#字体添加渐变颜色" class="headerlink" title="字体添加渐变颜色"></a>字体添加渐变颜色</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//字体渐变</span><br><span class="line"><span class="selector-class">.text</span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="attribute">background-image</span>:<span class="built_in">-webkit-linear-gradient</span>(bottom,red,<span class="number">#fd8403</span>,yellow); </span><br><span class="line"></span><br><span class="line">    -webkit-<span class="attribute">background-clip</span>:text; </span><br><span class="line"></span><br><span class="line">    -webkit-text-fill-<span class="attribute">color</span>:transparent; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>vuex辅助函数使用方法</title>
    <url>/2021/04/08/17vuex%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="vuex辅助函数使用方法"><a href="#vuex辅助函数使用方法" class="headerlink" title="vuex辅助函数使用方法"></a>vuex辅助函数使用方法</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vuex辅助函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState，mapMutations，mapActions，mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;count&#x27;</span>])，</span><br><span class="line">    ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;filterList&#x27;</span>])</span><br><span class="line">  &#125;,</span><br><span class="line"> <span class="attr">methods</span>:&#123;</span><br><span class="line">     ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;addCount&#x27;</span>])，</span><br><span class="line">    ...<span class="title function_">mapActions</span>([<span class="string">&#x27;getAsyncCount&#x27;</span>])，</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>vuex</tag>
      </tags>
  </entry>
  <entry>
    <title>css实现文字循环滚动效果</title>
    <url>/2021/04/18/19css%E5%AE%9E%E7%8E%B0%E6%96%87%E5%AD%97%E5%BE%AA%E7%8E%AF%E6%BB%9A%E5%8A%A8%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="css实现文字循环滚动效果"><a href="#css实现文字循环滚动效果" class="headerlink" title="css实现文字循环滚动效果"></a>css实现文字循环滚动效果</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在公司项目，产品要求在首页上添加一个公告文本循环滚动</p>
<p><img src="/2021/04/18/19css%E5%AE%9E%E7%8E%B0%E6%96%87%E5%AD%97%E5%BE%AA%E7%8E%AF%E6%BB%9A%E5%8A%A8%E6%95%88%E6%9E%9C/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      css实现文字循环滚动效果css实现文字循环滚动效果css实现文字循环滚动效果</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">200px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">12s</span> wordsLoop linear infinite normal;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> wordsLoop &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> wordsLoop &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css鼠标悬停盒子放大效果</title>
    <url>/2021/05/10/22css%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C%E7%9B%92%E5%AD%90%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="css鼠标悬停盒子放大效果"><a href="#css鼠标悬停盒子放大效果" class="headerlink" title="css鼠标悬停盒子放大效果"></a>css鼠标悬停盒子放大效果</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在JQ项目中，产品要求把页面展示的卡片通过鼠标悬停的方式凸显&#x2F;放大的动效</p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加盒子样式测试："><a href="#在css添加盒子样式测试：" class="headerlink" title="在css添加盒子样式测试："></a>在css添加盒子样式测试：</h2><p>有两种效果可参考，后续美化可根据产品需求自行调整</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-item</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  // 效果一：</span><br><span class="line">  // <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.296</span>);</span><br><span class="line">  // -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">2px</span>, <span class="number">0</span>);</span><br><span class="line">  // <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">20px</span>, <span class="number">0</span>);</span><br><span class="line">  // <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  // 效果二：</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">1px</span> <span class="number">1px</span> <span class="number">15px</span> <span class="number">#c8c8c8</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css 省略号动画（请稍等...）</title>
    <url>/2021/04/25/20css%E7%9C%81%E7%95%A5%E5%8F%B7%E9%97%AA%E7%83%81%E5%8A%A8%E7%94%BB/</url>
    <content><![CDATA[<h1 id="css-省略号动画（请稍等…）"><a href="#css-省略号动画（请稍等…）" class="headerlink" title="css 省略号动画（请稍等…）"></a>css 省略号动画（请稍等…）</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在项目中，在某页面的控制台上需要添加（加载中，请稍等…）提示语，要求后面的省略号跳动</p>
<p><img src="/2021/04/25/20css%E7%9C%81%E7%95%A5%E5%8F%B7%E9%97%AA%E7%83%81%E5%8A%A8%E7%94%BB/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box-text&quot;</span>&gt;</span>加载中，请稍等<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;box-text-drop&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box-text-drop</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: simsun; <span class="comment">/*固定字体避免设置的宽度无效*/</span></span><br><span class="line">    <span class="attribute">animation</span>: dropMove <span class="number">1s</span> infinite step-start;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1.5em</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: bottom; <span class="comment">/*始终让省略号在文字的下面*/</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> dropMove &#123; <span class="comment">/*动态改变显示宽度, 但始终让总占据空间不变, 避免抖动*/</span></span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">width</span>: <span class="number">0</span>; <span class="attribute">margin-right</span>: <span class="number">1.5em</span>; &#125;</span><br><span class="line">    <span class="number">33%</span> &#123; <span class="attribute">width</span>: .<span class="number">5em</span>; <span class="attribute">margin-right</span>: <span class="number">1em</span>; &#125;</span><br><span class="line">    <span class="number">66%</span> &#123; <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">margin-right</span>: .<span class="number">5em</span>; &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">width</span>: <span class="number">1.5em</span>; <span class="attribute">margin-right</span>: <span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>js将匹配到关键字使其变为红色</title>
    <url>/2021/05/07/21js%E5%B0%86%E5%8C%B9%E9%85%8D%E5%88%B0%E5%85%B3%E9%94%AE%E5%AD%97%E4%BD%BF%E5%85%B6%E5%8F%98%E4%B8%BA%E7%BA%A2%E8%89%B2/</url>
    <content><![CDATA[<h1 id="js将匹配到关键字使其变为红色"><a href="#js将匹配到关键字使其变为红色" class="headerlink" title="js将匹配到关键字使其变为红色"></a>js将匹配到关键字使其变为红色</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  项目中，产品要求在一段文字中将关键词加粗、变为红色</p>
<p><img src="/2021/05/07/21js%E5%B0%86%E5%8C%B9%E9%85%8D%E5%88%B0%E5%85%B3%E9%94%AE%E5%AD%97%E4%BD%BF%E5%85%B6%E5%8F%98%E4%B8%BA%E7%BA%A2%E8%89%B2/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-text&quot;&gt;&lt;p id=&quot;box-text-p&quot;&gt;&#123;&#123; changeKeyRed(text,&#x27;破浪&#x27;) &#125;&#125;&lt;/p&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在methods添加changeKeyRed处理函数："><a href="#在methods添加changeKeyRed处理函数：" class="headerlink" title="在methods添加changeKeyRed处理函数："></a>在methods添加changeKeyRed处理函数：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">changeKeyRed</span>(<span class="params">str, keyWord</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (str != <span class="literal">null</span> &amp;&amp; keyWord != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> substr = <span class="string">&#x27;/&#x27;</span> + keyWord + <span class="string">&#x27;/g&#x27;</span></span><br><span class="line">        <span class="keyword">var</span> replaceStr = str.<span class="title function_">replace</span>(<span class="built_in">eval</span>(substr), <span class="string">&quot;&lt;span style=&#x27;color:red;font-weight:bold&#x27;&gt;&quot;</span> + keyWord + <span class="string">&#x27;&lt;/span&gt;&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> inText = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">`box-text-p`</span>)</span><br><span class="line">          inText.<span class="property">innerHTML</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(replaceStr))</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> replaceStr</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> str</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>input输入框搜索处理不符合条件的校验</title>
    <url>/2021/06/01/25input%E6%90%9C%E7%B4%A2%E5%A4%84%E7%90%86%E4%B8%8D%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="input搜索处理不符合条件的校验"><a href="#input搜索处理不符合条件的校验" class="headerlink" title="input搜索处理不符合条件的校验"></a>input搜索处理不符合条件的校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><p>项目搜索条件有数字搜索的输入框，需要仅能输入数字</p>
<h2 id="处理方法："><a href="#处理方法：" class="headerlink" title="处理方法："></a>处理方法：</h2><blockquote>
<p>通过输入框的blur事件用replace()方法处理该需求</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a-input</span><br><span class="line">  v-model.trim=&quot;searchForm.refValueId&quot;</span><br><span class="line">  placeholder=&quot;请输入参考值标识&quot;</span><br><span class="line">  allow-clear</span><br><span class="line">  @blur=&quot;</span><br><span class="line">    () =&gt;</span><br><span class="line">      (searchForm.refValueId = searchForm.refValueId.replace(</span><br><span class="line">        /[^0-9]/g,</span><br><span class="line">        &#x27;&#x27;</span><br><span class="line">      ))</span><br><span class="line">  &quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>js计算当前时间的前一天</title>
    <url>/2021/05/25/24js%E8%AE%A1%E7%AE%97%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E7%9A%84%E5%89%8D%E4%B8%80%E5%A4%A9/</url>
    <content><![CDATA[<h1 id="js计算当前时间的前一天"><a href="#js计算当前时间的前一天" class="headerlink" title="js计算当前时间的前一天"></a>js计算当前时间的前一天</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//js如何去当前时间前一天的时间</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Date</span> countDate = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> preDate = <span class="keyword">new</span> <span class="title class_">Date</span>(countDate.<span class="title function_">getTime</span>() - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>); <span class="comment">//前一天</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nextDate = <span class="keyword">new</span> <span class="title class_">Date</span>(countDate.<span class="title function_">getTime</span>() + <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>); <span class="comment">//后一天</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>ant组件可以通过尾部图标显示字数</title>
    <url>/2021/07/08/28ant%E7%BB%84%E4%BB%B6%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E5%B0%BE%E9%83%A8%E5%9B%BE%E6%A0%87%E6%98%BE%E7%A4%BA%E5%AD%97%E6%95%B0/</url>
    <content><![CDATA[<h1 id="ant组件可以通过尾部图标显示字数"><a href="#ant组件可以通过尾部图标显示字数" class="headerlink" title="ant组件可以通过尾部图标显示字数"></a>ant组件可以通过尾部图标显示字数</h1><h2 id="在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置"><a href="#在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置" class="headerlink" title="在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置"></a>在ant组件中vue2版本，没有在输入框查看可输入限制字数，可以通过suffix设置</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;a-input</span><br><span class="line">  v-model=<span class="string">&quot;form.rule_name&quot;</span></span><br><span class="line">  :maxLength=<span class="string">&quot;30&quot;</span></span><br><span class="line">  allowClear</span><br><span class="line">  :suffix=<span class="string">&quot;(form.rule_name.length || 0) + &#x27;/30&#x27;&quot;</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>css给箭头添加向上的动效</title>
    <url>/2021/05/20/23%E7%BB%99%E7%AE%AD%E5%A4%B4%E6%B7%BB%E5%8A%A0%E5%90%91%E4%B8%8A%E7%9A%84%E5%8A%A8%E6%95%88/</url>
    <content><![CDATA[<h1 id="css给箭头添加向上的动效"><a href="#css给箭头添加向上的动效" class="headerlink" title="css给箭头添加向上的动效"></a>css给箭头添加向上的动效</h1><h2 id="产品需求："><a href="#产品需求：" class="headerlink" title="产品需求："></a>产品需求：</h2><p>  在JQ项目，产品要求把两个箭头添加向上的一个动效效果</p>
<p><img src="/2021/05/20/23%E7%BB%99%E7%AE%AD%E5%A4%B4%E6%B7%BB%E5%8A%A0%E5%90%91%E4%B8%8A%E7%9A%84%E5%8A%A8%E6%95%88/01.png"></p>
<h2 id="页面结构："><a href="#页面结构：" class="headerlink" title="页面结构："></a>页面结构：</h2><p>(本次模拟用三角形来模拟，后续项目可以更替为图片，效果一样的)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box-item&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


<h2 id="在css添加animation并引用："><a href="#在css添加animation并引用：" class="headerlink" title="在css添加animation并引用："></a>在css添加animation并引用：</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 三角形的一个样式处理 */</span></span><br><span class="line"><span class="selector-class">.box-item</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">50px</span> <span class="number">100px</span> <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: transparent transparent <span class="number">#00adb5</span> transparent;</span><br><span class="line">  <span class="attribute">animation</span>: breathDown <span class="number">1.0s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> breathDown &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">10%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>利用ES6 Set去重（ES6中最常用）</title>
    <url>/2021/07/12/29%E5%88%A9%E7%94%A8ES6%20Set%E5%8E%BB%E9%87%8D%EF%BC%88ES6%E4%B8%AD%E6%9C%80%E5%B8%B8%E7%94%A8%EF%BC%89/</url>
    <content><![CDATA[<h1 id="利用ES6-Set去重（ES6中最常用）"><a href="#利用ES6-Set去重（ES6中最常用）" class="headerlink" title="利用ES6 Set去重（ES6中最常用）"></a>利用ES6 Set去重（ES6中最常用）</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//利用ES6 Set去重（ES6中最常用）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span> (arr) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(arr))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>, <span class="literal">null</span>,<span class="literal">null</span>, <span class="title class_">NaN</span>, <span class="title class_">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">unique</span>(arr))</span><br><span class="line"> <span class="comment">//[1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;&#125;, &#123;&#125;]</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>遍历的表单项如何添加校验</title>
    <url>/2021/07/18/30%E9%81%8D%E5%8E%86%E7%9A%84%E8%A1%A8%E5%8D%95%E9%A1%B9%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="遍历的表单项如何添加校验"><a href="#遍历的表单项如何添加校验" class="headerlink" title="遍历的表单项如何添加校验"></a>遍历的表单项如何添加校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面新增某属性时，可以添加多条，此时就会添加多个相同的表单项，校验方式也是发生改变</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>通过 + index + 的方法来实现<br>例：:prop&#x3D;”‘domains.’ + index + ‘.paramType’”</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">&quot;dynamicValidateForm&quot;</span> <span class="attr">:model</span>=<span class="string">&quot;dynamicValidateForm&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;inline&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-row</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in dynamicValidateForm.domains&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">label</span>=<span class="string">&quot;城市&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.paramType&#x27;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:rules</span>=<span class="string">&quot;rules.paramType&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;item.paramType&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择城市&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;shanghai&quot;</span>&gt;</span> shanghai <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;beijing&quot;</span>&gt;</span> beijing <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span> <span class="attr">:offset</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">label</span>=<span class="string">&quot;类型&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.valueType&#x27;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">:rules</span>=<span class="string">&quot;rules.valueType&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;item.valueType&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择类型&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;Zone one&quot;</span>&gt;</span> Zone one <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">value</span>=<span class="string">&quot;Zone two&quot;</span>&gt;</span> Zone two <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;6&quot;</span> <span class="attr">:offset</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: flex&quot;</span> <span class="attr">:prop</span>=<span class="string">&quot;&#x27;domains.&#x27; + index + &#x27;.value&#x27;&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules.value&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;item.value&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入内容&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 引入</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 注册</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">components</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dynamicValidateForm</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">domains</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">paramType</span>: <span class="literal">undefined</span>, <span class="attr">valueType</span>: <span class="literal">undefined</span>, <span class="attr">value</span>: <span class="literal">undefined</span> &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 校验</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">rules</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">value</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">message</span>: <span class="string">&#x27;请选择城市&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">valueType</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">message</span>: <span class="string">&#x27;请选择类型&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">paramType</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入内容&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.box</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>获取屏幕缩放倍数</title>
    <url>/2021/07/03/27%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E7%BC%A9%E6%94%BE%E5%80%8D%E6%95%B0/</url>
    <content><![CDATA[<h1 id="获取屏幕缩放倍数"><a href="#获取屏幕缩放倍数" class="headerlink" title="获取屏幕缩放倍数"></a>获取屏幕缩放倍数</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 屏幕缩放大小</span></span><br><span class="line">    <span class="title function_">detectZoom</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> ratio = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">const</span> screen = <span class="variable language_">window</span>.<span class="property">screen</span>;</span><br><span class="line">      <span class="keyword">const</span> ua = navigator.<span class="property">userAgent</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        ratio = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (~ua.<span class="title function_">indexOf</span>(<span class="string">&quot;msie&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (screen.<span class="property">deviceXDPI</span> &amp;&amp; screen.<span class="property">logicalXDPI</span>) &#123;</span><br><span class="line">          ratio = screen.<span class="property">deviceXDPI</span> / screen.<span class="property">logicalXDPI</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">outerWidth</span> !== <span class="literal">undefined</span> &amp;&amp;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">innerWidth</span> !== <span class="literal">undefined</span></span><br><span class="line">      ) &#123;</span><br><span class="line">        ratio = <span class="variable language_">window</span>.<span class="property">outerWidth</span> / <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (ratio) &#123;</span><br><span class="line">        ratio = <span class="title class_">Math</span>.<span class="title function_">round</span>(ratio * <span class="number">100</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ratio;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="title function_">detectZoom</span>()) <span class="comment">//打印出来的结果要和你电脑本地设置的缩放大小计算（本地放大倍数*浏览器放大倍数/100）</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p><img src="/2021/07/03/27%E8%8E%B7%E5%8F%96%E5%B1%8F%E5%B9%95%E7%BC%A9%E6%94%BE%E5%80%8D%E6%95%B0/01.png"></p>
]]></content>
      <tags>
        <tag>浏览器</tag>
      </tags>
  </entry>
  <entry>
    <title>表格中的表单项如何添加校验</title>
    <url>/2021/07/24/31%E8%A1%A8%E6%A0%BC%E4%B8%AD%E7%9A%84%E8%A1%A8%E5%8D%95%E9%A1%B9%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="表格中的表单项如何添加校验"><a href="#表格中的表单项如何添加校验" class="headerlink" title="表格中的表单项如何添加校验"></a>表格中的表单项如何添加校验</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面的表格项需要添加表单填写，并提交。</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>也是和表单遍历处理的方式差不多，:prop&#x3D;”‘list.’+scope.$index+’.name’”</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;el-form ref=&quot;tableformRef&quot; :model=&quot;form&quot;&gt;</span><br><span class="line">      &lt;el-table :data=&quot;form.list&quot;&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;姓名&quot;</span><br><span class="line">          prop=&quot;name&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.name&#x27;&quot; :rules=&quot;rules.name&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.name&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;性别&quot;</span><br><span class="line">          prop=&quot;sex&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.sex&#x27;&quot; :rules=&quot;rules.sex&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.sex&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;年龄&quot;</span><br><span class="line">          prop=&quot;age&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.age&#x27;&quot; :rules=&quot;rules.age&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.age&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">          label=&quot;等级&quot;</span><br><span class="line">          prop=&quot;level&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-form-item :prop=&quot;&#x27;list.&#x27;+scope.$index+&#x27;.level&#x27;&quot; :rules=&quot;rules.level&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;scope.row.level&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">      &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button @click=&quot;handleSubmit&quot;&gt;提交&lt;/el-button&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入</span><br><span class="line">export default &#123;</span><br><span class="line">  // 注册</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    const validatorAge = (rule, value, callback) =&gt; &#123;</span><br><span class="line">      if (!value) &#123;</span><br><span class="line">        callback(new Error(&#x27;年龄不能为空&#x27;))</span><br><span class="line">      &#125; else if (value &lt; 20 || value &gt; 50) &#123;</span><br><span class="line">        callback(new Error(&#x27;年龄输入错误&#x27;))</span><br><span class="line">      &#125; else callback()</span><br><span class="line">    &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">      form: &#123;</span><br><span class="line">        list: [</span><br><span class="line">          &#123; id: &#x27;1&#x27;, name: &#x27;唐僧&#x27;, sex: &#x27;1&#x27;, age: &#x27;35&#x27;, level: 1, describe: &#x27;他是师傅&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;2&#x27;, name: &#x27;孙悟空&#x27;, sex: &#x27;2&#x27;, age: &#x27;20&#x27;, level: 2, describe: &#x27;他是大师兄&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;3&#x27;, name: &#x27;沙和尚&#x27;, sex: &#x27;1&#x27;, age: &#x27;30&#x27;, level: 4, describe: &#x27;他是三师弟&#x27; &#125;,</span><br><span class="line">          &#123; id: &#x27;4&#x27;, name: &#x27;猪八戒&#x27;, sex: &#x27;2&#x27;, age: &#x27;33&#x27;, level: 3, describe: &#x27;他是猪八戒&#x27; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      rules: &#123;</span><br><span class="line">        name: &#123; required: true, message: &#x27;姓名不能为空&#x27; &#125;,</span><br><span class="line">        sex: &#123; required: true, message: &#x27;性别不能为空&#x27; &#125;,</span><br><span class="line">        age: [</span><br><span class="line">          &#123; required: true, validator: validatorAge &#125;</span><br><span class="line">        ],</span><br><span class="line">        level: &#123; required: true, message: &#x27;等级不能为空&#x27; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleSubmit() &#123;</span><br><span class="line">      this.$refs.tableformRef.validate(async valid =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          this.$message.success(&#x27;提交成功&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>表单</tag>
      </tags>
  </entry>
  <entry>
    <title>el-tree组件在内容超出长度时出现提示框</title>
    <url>/2021/09/04/33el-tree%E7%BB%84%E4%BB%B6%E5%9C%A8%E5%86%85%E5%AE%B9%E8%B6%85%E5%87%BA%E9%95%BF%E5%BA%A6%E6%97%B6%E5%87%BA%E7%8E%B0%E6%8F%90%E7%A4%BA%E6%A1%86/</url>
    <content><![CDATA[<h1 id="el-tree组件在内容超出长度时出现提示框"><a href="#el-tree组件在内容超出长度时出现提示框" class="headerlink" title="el-tree组件在内容超出长度时出现提示框"></a>el-tree组件在内容超出长度时出现提示框</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>某页面的树形控件在超出规定长度时要省略号…,并且鼠标悬浮展示全部名称</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>可以通过mouseover事件处理</p>
</blockquote>
<h2 id="优化点："><a href="#优化点：" class="headerlink" title="优化点："></a>优化点：</h2><blockquote>
<p>处理好了样式可能有问题，当超出时，鼠标悬浮右边会出现滚动条，可以再body标签那边添加overflow: hidden;</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-tree&quot;&gt;</span><br><span class="line">      &lt;el-tree</span><br><span class="line">        ref=&quot;tree&quot;</span><br><span class="line">        :data=&quot;treeData&quot;</span><br><span class="line">        node-key=&quot;label&quot;</span><br><span class="line">        :props=&quot;defaultProps&quot;</span><br><span class="line">        class=&quot;tree-wrap&quot;</span><br><span class="line">        :indent=&quot;40&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;el-tooltip slot-scope=&quot;&#123; node &#125;&quot; :disabled=&quot;showTitle&quot; effect=&quot;dark&quot; :content=&quot;tooltipTitle&quot; placement=&quot;top&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;span-ellipsis&quot; @mouseover=&quot;onShowNameTipsMouseenter&quot;&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/el-tooltip&gt;</span><br><span class="line">      &lt;/el-tree&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      treeData: [&#123;</span><br><span class="line">        label: &#x27;一级 11111111111111111111111111111&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1111111111111111&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-11111111111111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 222222222222222222222222222&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-111111111111111111111&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-111111111111111111111111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;二级 2-222222222222222222222222222&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-2-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 3&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 3-1&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 3-1-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;二级 3-2&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 3-2-1&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;],</span><br><span class="line">      defaultProps: &#123;</span><br><span class="line">        children: &#x27;children&#x27;,</span><br><span class="line">        label: &#x27;label&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      showTitle: false,</span><br><span class="line">      tooltipTitle: undefined</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onShowNameTipsMouseenter(e) &#123;</span><br><span class="line">      var target = e.target</span><br><span class="line">      const textLength = target.clientWidth</span><br><span class="line">      const containerLength = target.scrollWidth</span><br><span class="line">      if (textLength &lt; containerLength) &#123;</span><br><span class="line">        this.tooltipTitle = e.target.innerText</span><br><span class="line">        this.showTitle = false</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.showTitle = true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 500px;</span><br><span class="line">&#125;</span><br><span class="line">.box-tree&#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 100%;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">&#125;</span><br><span class="line">.span-ellipsis &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  white-space: nowrap;</span><br><span class="line">  text-overflow: ellipsis;</span><br><span class="line">  margin-right: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>el-tree树控件</tag>
      </tags>
  </entry>
  <entry>
    <title>后端返回base64字符串转图片</title>
    <url>/2021/08/20/32%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9Ebase64%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="后端返回base64字符串转图片"><a href="#后端返回base64字符串转图片" class="headerlink" title="后端返回base64字符串转图片"></a>后端返回base64字符串转图片</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>后端返回的一串base64字符串，要求在页面展示图片</p>
</blockquote>
<h2 id="处理方式："><a href="#处理方式：" class="headerlink" title="处理方式："></a>处理方式：</h2><blockquote>
<p>可以通过图片标签的src路径前面添加 “data:image&#x2F;gif;base64,”</p>
</blockquote>
<h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img :src=&quot;&#x27;data:image/gif;base64,&#x27; + srcImg(后端返回的base64字符串)&quot; alt=&quot;&quot; style=&quot;width: 100px;height: 100px;&quot; ref=&quot;printform&quot; id=&quot;printform&quot;&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>单行和多行超出宽度添加省略号</title>
    <url>/2021/09/14/34%E5%8D%95%E8%A1%8C%E5%92%8C%E5%A4%9A%E8%A1%8C%E8%B6%85%E5%87%BA%E5%AE%BD%E5%BA%A6%E6%B7%BB%E5%8A%A0%E7%9C%81%E7%95%A5%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="单行和多行超出宽度添加省略号"><a href="#单行和多行超出宽度添加省略号" class="headerlink" title="单行和多行超出宽度添加省略号"></a>单行和多行超出宽度添加省略号</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaassssssssssssssssssdsdasdasdsd</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入</span><br><span class="line">export default &#123;</span><br><span class="line">  // 注册</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 500px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box-item &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  // 单行省略号</span><br><span class="line">  // white-space: nowrap;</span><br><span class="line">  // overflow: hidden;</span><br><span class="line">  // text-overflow: ellipsis;</span><br><span class="line">  // 多行的：</span><br><span class="line">  word-break: break-all;</span><br><span class="line">  text-overflow: ellipsis;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: -webkit-box;</span><br><span class="line">  -webkit-line-clamp: 2;//多少行添加省略号</span><br><span class="line">  -webkit-box-orient: vertical;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>根据数据嵌套的最后一级id找父集合的id</title>
    <url>/2021/09/25/35%E6%A0%B9%E6%8D%AE%E6%95%B0%E6%8D%AE%E5%B5%8C%E5%A5%97%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E7%BA%A7id%E6%89%BE%E7%88%B6%E9%9B%86%E5%90%88%E7%9A%84id/</url>
    <content><![CDATA[<h1 id="根据数据嵌套的最后一级id找父集合的id"><a href="#根据数据嵌套的最后一级id找父集合的id" class="headerlink" title="根据数据嵌套的最后一级id找父集合的id"></a>根据数据嵌套的最后一级id找父集合的id</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>在表单中有级联框需要回显所以要查找出id父集合<br>（数据嵌套，递归）</p>
</blockquote>
<h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      data: [&#123;</span><br><span class="line">        label: &#x27;一级 1&#x27;,</span><br><span class="line">        id: &#x27;1&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1&#x27;,</span><br><span class="line">          id: &#x27;11&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-1&#x27;,</span><br><span class="line">            id: &#x27;111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 2&#x27;,</span><br><span class="line">        id: &#x27;2&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-1&#x27;,</span><br><span class="line">          id: &#x27;21&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-1&#x27;,</span><br><span class="line">            id: &#x27;211&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.getHierarchyData(this.data, [&#x27;111&#x27;])</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    getHierarchyData(rawData, list) &#123;</span><br><span class="line">      const data = []</span><br><span class="line">      const find = (classifyList, id) =&gt; &#123;</span><br><span class="line">        const temp = [id]</span><br><span class="line">        const forFn = function(arr, id) &#123;</span><br><span class="line">          for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">            const item = arr[i]</span><br><span class="line">            if (item.children) &#123;</span><br><span class="line">              const data1 = item.children.find((item1) =&gt; item1.id === id)</span><br><span class="line">              if (data1) &#123;</span><br><span class="line">                temp.unshift(item.id)</span><br><span class="line">                forFn(classifyList, item.id)</span><br><span class="line">                break</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                forFn(item.children, id)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        forFn(classifyList, id)</span><br><span class="line">        return temp</span><br><span class="line">      &#125;</span><br><span class="line">      list.forEach((str) =&gt; &#123;</span><br><span class="line">        data.push(find(rawData, str))</span><br><span class="line">      &#125;)</span><br><span class="line">      return data</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript最简洁根据parentId将数据递归成树状</title>
    <url>/2021/10/22/37js%E6%A0%B9%E6%8D%AEparentId%E5%B0%86%E6%95%B0%E6%8D%AE%E9%80%92%E5%BD%92%E6%88%90%E6%A0%91%E7%8A%B6/</url>
    <content><![CDATA[<h1 id="JavaScript最简洁根据parentId将数据递归成树状"><a href="#JavaScript最简洁根据parentId将数据递归成树状" class="headerlink" title="JavaScript最简洁根据parentId将数据递归成树状"></a>JavaScript最简洁根据parentId将数据递归成树状</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      // 假设数据如下</span><br><span class="line">      data: [</span><br><span class="line">        &#123; id: 2, name: &#x27;研发部&#x27;, parentId: 1 &#125;,</span><br><span class="line">        &#123; id: 4, name: &#x27;行政人事部&#x27;, parentId: 1 &#125;,</span><br><span class="line">        &#123; id: 6, name: &#x27;行政人事部下面的行政&#x27;, parentId: 4 &#125;,</span><br><span class="line">        &#123; id: 7, name: &#x27;行政人事部下面的人力资源&#x27;, parentId: 4 &#125;,</span><br><span class="line">        &#123; id: 20, name: &#x27;研发下面的产品组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 21, name: &#x27;研发下面的测试组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 22, name: &#x27;研发下面的运维组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 23, name: &#x27;研发下面的前端组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 24, name: &#x27;研发下面的后台组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 25, name: &#x27;研发下面的移动开发组&#x27;, parentId: 2 &#125;,</span><br><span class="line">        &#123; id: 99, name: &#x27;移动组下面的组&#x27;, parentId: 25 &#125;,</span><br><span class="line">        &#123; id: 98, name: &#x27;移动组下面的组&#x27;, parentId: 25 &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.formatToTree(this.data, 1)</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    formatToTree(ary, pid) &#123;</span><br><span class="line">      return ary</span><br><span class="line">        .filter((item) =&gt;</span><br><span class="line">        // pid父级id</span><br><span class="line">        // 如果没有父id（第一次递归的时候）将所有父级查询出来</span><br><span class="line">        // 这里认为 item.parentId === 1 就是最顶层 需要根据业务调整</span><br><span class="line">          pid === undefined ? item.parentId === 1 : item.parentId === pid</span><br><span class="line">        )</span><br><span class="line">        .map((item) =&gt; &#123;</span><br><span class="line">          // 通过父节点ID查询所有子节点</span><br><span class="line">          item.children = this.formatToTree(ary, item.id)</span><br><span class="line">          return item</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>根据最后一级id找name，或者根据最后一级name找id</title>
    <url>/2021/10/12/36%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%90%8E%E4%B8%80%E7%BA%A7id%E6%89%BEname/</url>
    <content><![CDATA[<h1 id="根据最后一级id找name，或者根据最后一级name找id"><a href="#根据最后一级id找name，或者根据最后一级name找id" class="headerlink" title="根据最后一级id找name，或者根据最后一级name找id"></a>根据最后一级id找name，或者根据最后一级name找id</h1><h2 id="完整的代码展示"><a href="#完整的代码展示" class="headerlink" title="完整的代码展示"></a>完整的代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box-item&quot;&gt;</span><br><span class="line">      &lt;el-button @click=&quot;handleClick&quot;&gt;测试按钮&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      data: [&#123;</span><br><span class="line">        label: &#x27;一级 1&#x27;,</span><br><span class="line">        id: &#x27;1&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 1-1&#x27;,</span><br><span class="line">          id: &#x27;11&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 1-1-1&#x27;,</span><br><span class="line">            id: &#x27;111&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        label: &#x27;一级 2&#x27;,</span><br><span class="line">        id: &#x27;2&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;二级 2-1&#x27;,</span><br><span class="line">          id: &#x27;21&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;三级 2-1-1&#x27;,</span><br><span class="line">            id: &#x27;211&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      const ids = this.getGroupName(this.data, &#x27;111&#x27;)</span><br><span class="line">      console.log(ids)</span><br><span class="line">    &#125;,</span><br><span class="line">    getGroupName(data, idval) &#123;</span><br><span class="line">      let result = &#x27;&#x27;</span><br><span class="line">      if (!data) &#123;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      for (const item of data) &#123;</span><br><span class="line">        if (item.id === idval) &#123;</span><br><span class="line">          result = item.label</span><br><span class="line">          break</span><br><span class="line">        &#125; else if (item.children &amp;&amp; item.children.length &gt; 0) &#123;</span><br><span class="line">          const res = this.getGroupName(item.children, idval)</span><br><span class="line">          if (res) &#123; result = res; break &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return result</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>判断两数组是否一样</title>
    <url>/2021/11/02/38%E5%88%A4%E6%96%AD%E4%B8%A4%E6%95%B0%E7%BB%84%E6%98%AF%E5%90%A6%E4%B8%80%E6%A0%B7/</url>
    <content><![CDATA[<h1 id="判断两数组是否一样"><a href="#判断两数组是否一样" class="headerlink" title="判断两数组是否一样"></a>判断两数组是否一样</h1><h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// arr1//数组1</span></span><br><span class="line"><span class="comment">// arr2//数组2</span></span><br><span class="line">arr1.<span class="property">length</span> === arr2.<span class="property">length</span> &amp;&amp; arr1.<span class="title function_">every</span>(<span class="keyword">function</span>(<span class="params">v, i</span>) &#123; <span class="keyword">return</span> v === arr2[i] &#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>数据类型</tag>
      </tags>
  </entry>
  <entry>
    <title>vue请求后台JFIF格式文件流</title>
    <url>/2022/01/05/40vue%E8%AF%B7%E6%B1%82%E5%90%8E%E5%8F%B0JFIF%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6%E6%B5%81/</url>
    <content><![CDATA[<h1 id="vue请求后台JFIF格式文件流"><a href="#vue请求后台JFIF格式文件流" class="headerlink" title="vue请求后台JFIF格式文件流"></a>vue请求后台JFIF格式文件流</h1><h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//封装请求api（封装方式1）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getValidataCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/captcha.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    <span class="attr">responseType</span>: <span class="string">&#x27;arraybuffer&#x27;</span><span class="comment">//重要设置</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 封装方式2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getJFIF</span>(<span class="params">url, params</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span>&#123;</span><br><span class="line">        axios.<span class="title function_">get</span>(url, &#123;</span><br><span class="line">            <span class="attr">params</span>: params,</span><br><span class="line">            <span class="attr">responseType</span>: <span class="string">&#x27;arraybuffer&#x27;</span></span><br><span class="line">        &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err.<span class="property">data</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入封装方式1</span></span><br><span class="line"><span class="keyword">import</span> &#123;getValidataCode &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/login&#x27;</span></span><br><span class="line"><span class="comment">/* 获取验证码图片 */</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getCaptcha</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getValidataCode</span>()</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">captchaImg</span> = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res]))</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>文件流</tag>
      </tags>
  </entry>
  <entry>
    <title>锚点简单案例</title>
    <url>/2022/01/25/41%E9%94%9A%E7%82%B9%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B/</url>
    <content><![CDATA[<h1 id="锚点简单案例"><a href="#锚点简单案例" class="headerlink" title="锚点简单案例"></a>锚点简单案例</h1><h2 id="完整代码展示"><a href="#完整代码展示" class="headerlink" title="完整代码展示"></a>完整代码展示</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;anchor-point&quot;&gt;</span><br><span class="line">    &lt;!-- 滚动区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;scroll-content&quot; @scroll=&quot;onScroll&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: #3a8ee6;&quot;&gt;一层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: red;&quot;&gt;二层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 500px;background: #42b983&quot;&gt;三层&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;scroll-item&quot; style=&quot;height: 1000px;background: yellow;&quot;&gt;四层&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 按钮 --&gt;</span><br><span class="line">    &lt;div class=&quot;operation-btn&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        v-for=&quot;(item, index) in [&#x27;一层&#x27;,&#x27;二层&#x27;,&#x27;三层&#x27;,&#x27;四层&#x27;]&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        :style=&quot;&#123;background: activeStep === index ? &#x27;red&#x27; : &#x27;#ffffff&#x27;&#125;&quot;</span><br><span class="line">        @click=&quot;jump(index)&quot;</span><br><span class="line">      &gt;&#123;&#123; item &#125;&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      activeStep: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 滚动触发按钮高亮</span><br><span class="line">    onScroll(e) &#123;</span><br><span class="line">      const scrollItems = document.querySelectorAll(&#x27;.scroll-item&#x27;)</span><br><span class="line">      console.log(e, scrollItems)</span><br><span class="line">      for (let i = scrollItems.length - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">        // 判断滚动条滚动距离是否大于当前滚动项可滚动距离</span><br><span class="line">        const judge = e.target.scrollTop &gt;= scrollItems[i].offsetTop - scrollItems[0].offsetTop</span><br><span class="line">        if (judge) &#123;</span><br><span class="line">          this.activeStep = i</span><br><span class="line">          break</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    // 点击切换锚点</span><br><span class="line">    jump(index) &#123;</span><br><span class="line">      const target = document.querySelector(&#x27;.scroll-content&#x27;)</span><br><span class="line">      const scrollItems = document.querySelectorAll(&#x27;.scroll-item&#x27;)</span><br><span class="line">      // 判断滚动条是否滚动到底部</span><br><span class="line">      if (target.scrollHeight &lt;= target.scrollTop + target.clientHeight) &#123;</span><br><span class="line">        this.activeStep = index</span><br><span class="line">      &#125;</span><br><span class="line">      const total = scrollItems[index].offsetTop - scrollItems[0].offsetTop // 锚点元素距离其offsetParent(这里是body)顶部的距离(待滚动的距离)</span><br><span class="line">      let distance = document.querySelector(&#x27;.scroll-content&#x27;).scrollTop // 滚动条距离滚动区域顶部的距离</span><br><span class="line">      // let distance = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset // 滚动条距离滚动区域顶部的距离(滚动区域为窗口)</span><br><span class="line">      // 滚动动画实现, 使用setTimeout的递归实现平滑滚动，将距离细分为50小段，10ms滚动一次</span><br><span class="line">      // 计算每一小段的距离</span><br><span class="line">      let step = total / 50</span><br><span class="line">      if (total &gt; distance) &#123;</span><br><span class="line">        smoothDown(document.querySelector(&#x27;.scroll-content&#x27;))</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        const newTotal = distance - total</span><br><span class="line">        step = newTotal / 50</span><br><span class="line">        smoothUp(document.querySelector(&#x27;.scroll-content&#x27;))</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 参数element为滚动区域</span><br><span class="line">      function smoothDown(element) &#123;</span><br><span class="line">        if (distance &lt; total) &#123;</span><br><span class="line">          distance += step</span><br><span class="line">          element.scrollTop = distance</span><br><span class="line">          setTimeout(smoothDown.bind(this, element), 10)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          element.scrollTop = total</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 参数element为滚动区域</span><br><span class="line">      function smoothUp(element) &#123;</span><br><span class="line">        if (distance &gt; total) &#123;</span><br><span class="line">          distance -= step</span><br><span class="line">          element.scrollTop = distance</span><br><span class="line">          setTimeout(smoothUp.bind(this, element), 10)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          element.scrollTop = total</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // document.querySelectorAll(&#x27;.scroll-item&#x27;).forEach((item, index1) =&gt; &#123;</span><br><span class="line">      //   if (index === index1) &#123;</span><br><span class="line">      //     item.scrollIntoView(&#123;</span><br><span class="line">      //       block: &#x27;start&#x27;,</span><br><span class="line">      //       behavior: &#x27;smooth&#x27;</span><br><span class="line">      //     &#125;)</span><br><span class="line">      //   &#125;</span><br><span class="line">      // &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.anchor-point &#123;</span><br><span class="line">flex-basis: 100%;</span><br><span class="line">display: flex;</span><br><span class="line">overflow: hidden;</span><br><span class="line">.scroll-content &#123;</span><br><span class="line">  height: 500px;</span><br><span class="line">  width: 90%;</span><br><span class="line">  overflow: scroll;</span><br><span class="line">&#125;</span><br><span class="line">.operation-btn &#123;</span><br><span class="line">  width: 10%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>锚点</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue-count-to(数字滚动计时)</title>
    <url>/2021/06/25/26Vue-count-to(%E6%95%B0%E5%AD%97%E6%BB%9A%E5%8A%A8%E8%AE%A1%E6%97%B6)/</url>
    <content><![CDATA[<h1 id="Vue-count-to-数字滚动计时"><a href="#Vue-count-to-数字滚动计时" class="headerlink" title="Vue-count-to(数字滚动计时)"></a>Vue-count-to(数字滚动计时)</h1><h2 id="项目需求："><a href="#项目需求：" class="headerlink" title="项目需求："></a>项目需求：</h2><blockquote>
<p>项目首页的数量展示需要添加一个从 0-获取回来数量 的滚动效果</p>
</blockquote>
<h2 id="使用vue-count-to（数字滚动插件）："><a href="#使用vue-count-to（数字滚动插件）：" class="headerlink" title="使用vue-count-to（数字滚动插件）："></a>使用vue-count-to（数字滚动插件）：</h2><blockquote>
<p>官网：<a href="https://www.npmjs.com/package/vue-count-to">https://www.npmjs.com/package/vue-count-to</a></p>
</blockquote>
<p>1：下载插件依赖</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install vue-count-to</span><br></pre></td></tr></table></figure>
<p>2：页面使用插件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入</span></span><br><span class="line"><span class="keyword">import</span> countTo <span class="keyword">from</span> <span class="string">&quot;vue-count-to&quot;</span>;</span><br><span class="line"><span class="comment">//注册</span></span><br><span class="line"><span class="attr">components</span>: &#123;</span><br><span class="line">    countTo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line">&lt;countTo :startVal=<span class="string">&#x27;startVal&#x27;</span> :endVal=<span class="string">&#x27;endVal&#x27;</span> :duration=<span class="string">&#x27;3000&#x27;</span>&gt;&lt;/countTo&gt;</span><br><span class="line"><span class="comment">//startVal开始值，endVal结束值，duration时间</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>插件</tag>
      </tags>
  </entry>
  <entry>
    <title>iframe嵌套合作伙伴项目</title>
    <url>/2022/02/18/42iframe%E5%B5%8C%E5%A5%97%E5%90%88%E4%BD%9C%E4%BC%99%E4%BC%B4%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<h1 id="iframe嵌套合作伙伴项目"><a href="#iframe嵌套合作伙伴项目" class="headerlink" title="iframe嵌套合作伙伴项目"></a>iframe嵌套合作伙伴项目</h1><h2 id="ifram之间的传值"><a href="#ifram之间的传值" class="headerlink" title="ifram之间的传值"></a>ifram之间的传值</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;iframe</span><br><span class="line">      key=<span class="string">&quot;jiesuan&quot;</span></span><br><span class="line">      ref=<span class="string">&quot;child&quot;</span></span><br><span class="line">      id=<span class="string">&quot;settlementCenter&quot;</span></span><br><span class="line">      <span class="keyword">class</span>=<span class="string">&quot;layadmin-iframe iframe-main settlementCenter&quot;</span></span><br><span class="line">      :src=<span class="string">&quot;`http://(合作伙伴ip地址)?clientId=SETTLE-CENTER&amp;responseType=code&amp;token=$&#123;token&#125;`&quot;</span> <span class="comment">//和后端第定义传的参数</span></span><br><span class="line">      width=<span class="string">&quot;100%&quot;</span></span><br><span class="line">      height=<span class="string">&quot;100%&quot;</span></span><br><span class="line">      marginwidth=<span class="string">&quot;0&quot;</span></span><br><span class="line">      marginheight=<span class="string">&quot;0&quot;</span></span><br><span class="line">      scrolling=<span class="string">&quot;yes&quot;</span></span><br><span class="line">      allowtransparency=<span class="string">&quot;yes&quot;</span></span><br><span class="line">      frameborder=<span class="string">&quot;0&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//跨域通讯</span></span><br><span class="line"><span class="comment">// 子传父postMessage</span></span><br><span class="line"><span class="comment">// 子页面可在vue页面或者js文件写</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;token失效，请重新登录！&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"><span class="comment">// 父在iframe标签的页面写</span></span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 父接收子的信息-------------------------------------------------------------------</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(ev)</span><br><span class="line">    &#125;, <span class="literal">false</span>)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//父传子步骤</span></span><br><span class="line">$(<span class="string">&#x27;#my-iframe&#x27;</span>).<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;www&#x27;</span>,</span><br><span class="line">  <span class="attr">ctx</span>: <span class="string">&#x27;给你消息，收到了嘛?&#x27;</span></span><br><span class="line">&#125;), <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子项目接收</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(ev)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

<h2 id="之间的token值替换"><a href="#之间的token值替换" class="headerlink" title="之间的token值替换"></a>之间的token值替换</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//嵌入其他项目的页面时要去掉旧项目的token</span></span><br><span class="line"><span class="comment">// 路由配置在路由守卫处理</span></span><br><span class="line"><span class="comment">// &lt;!-- http://localhost:21444/sett/#/access_token=$&#123;token&#125;&amp;userName=admin --&gt;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NProgress</span> <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span> <span class="comment">// progress bar</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;nprogress/nprogress.css&#x27;</span> <span class="comment">// progress bar style</span></span><br><span class="line"><span class="keyword">import</span> &#123; getToken, setToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span> <span class="comment">// get token from cookie</span></span><br><span class="line"><span class="keyword">import</span> getPageTitle <span class="keyword">from</span> <span class="string">&#x27;@/utils/get-page-title&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; sleep &#125; <span class="keyword">from</span> <span class="string">&#x27;./authorities&#x27;</span></span><br><span class="line"><span class="title class_">NProgress</span>.<span class="title function_">configure</span>(&#123; <span class="attr">showSpinner</span>: <span class="literal">false</span> &#125;) <span class="comment">// NProgress Configuration</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span>(to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">20</span>)</span><br><span class="line">  <span class="comment">// 检查hash中的token</span></span><br><span class="line">  <span class="comment">// 检查hash中的token</span></span><br><span class="line">  <span class="keyword">const</span> tokenMap = <span class="title function_">checkAndDealHashToken</span>()</span><br><span class="line">  tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>) &amp;&amp; <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;userName&#x27;</span>, tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>))</span><br><span class="line">  <span class="comment">// hash中的token需要处理掉</span></span><br><span class="line">  <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;success&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;userName&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">replace</span>(<span class="string">&#x27;sett/dashboard&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> === <span class="string">&#x27;agency&#x27;</span> &amp;&amp;</span><br><span class="line">      to.<span class="property">path</span> !== <span class="string">&#x27;/404&#x27;</span> &amp;&amp;</span><br><span class="line">      !to.<span class="property">path</span>.<span class="title function_">includes</span>(<span class="string">&#x27;agency&#x27;</span>)) &#123;</span><br><span class="line">        <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> + store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> + to.<span class="property">path</span>, <span class="attr">query</span>: to.<span class="property">query</span> &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 由于天翼物联嵌入内部系统，暂时不移除token</span></span><br><span class="line">    <span class="comment">// window.location.href = location.href.replace(location.hash, &#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> === <span class="string">&#x27;agency&#x27;</span> &amp;&amp;</span><br><span class="line">      to.<span class="property">path</span> !== <span class="string">&#x27;/404&#x27;</span> &amp;&amp;</span><br><span class="line">      !to.<span class="property">path</span>.<span class="title function_">includes</span>(<span class="string">&#x27;agency&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> + store.<span class="property">getters</span>.<span class="property">checkBaseUrl</span> + to.<span class="property">path</span>, <span class="attr">query</span>: to.<span class="property">query</span> &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ---------------------------------------------------------------------------------------------------</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeResolve</span>(<span class="title function_">async</span>(to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 从路由配置中取回menuCode</span></span><br><span class="line">  <span class="keyword">const</span> menuCode = to.<span class="property">meta</span>.<span class="property">menuCode</span></span><br><span class="line">  <span class="keyword">if</span> (menuCode) &#123;</span><br><span class="line">    <span class="comment">// 触发layout的菜单匹配</span></span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;checkBaseUrl/SET_BASE_URL&#x27;</span>, to.<span class="property">meta</span>.<span class="property">menuCode</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> setToken = <span class="title function_">getToken</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 权限点</span></span><br><span class="line">  <span class="comment">// start progress bar</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">start</span>()</span><br><span class="line">  <span class="comment">// set page title</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">title</span> = <span class="title function_">getPageTitle</span>(to.<span class="property">meta</span>.<span class="property">title</span>)</span><br><span class="line">  <span class="keyword">if</span> (!setToken &amp;&amp; to.<span class="property">path</span> !== <span class="string">&#x27;/Login&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// next(&#x27;/Login&#x27;)</span></span><br><span class="line">    <span class="comment">// removeToken()</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;token失效，请重新登录！&#x27;</span> &#125;, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (setToken &amp;&amp; to.<span class="property">path</span> === <span class="string">&#x27;/Login&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">next</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否有hash值并放入cookie</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkAndDealHashToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 后端定会返回带token和用户名的字符串</span></span><br><span class="line">  <span class="comment">// http://localhost:21444/sett/#/access_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTY3NzgzNzE0NCwiaWF0IjoxNjc3ODA4MzQ0LCJjcmVhdGVkIjoxNjc3ODA4MzQ0Mzg2LCJhdXRob3JpdGllcyI6W3siYXV0aG9yaXR5Ijoic3lzOnVzZXI6dmlldyJ9LHsiYXV0aG9yaXR5IjoiICJ9LHsiYXV0aG9yaXR5Ijoic3lzOnJvbGU6c2F2ZSJ9LHsiYXV0aG9yaXR5Ijoic3lzOnJvbGU6dmlldyJ9XX0.NrORHccsvkK8PyllHUfndV3Fd8olDuFfAlwVSed2NwQEMK9QXTBZY7mogvDPLGLrVUk-d4wdfJiJYP-4vArX5w&amp;userName=admin</span></span><br><span class="line">  <span class="comment">// &lt;1&gt; 获取 location 中的hash信息，也就是 #后边的内容</span></span><br><span class="line">  <span class="keyword">let</span> tokenStr = location.<span class="property">hash</span></span><br><span class="line">  <span class="comment">// 存储令牌信息</span></span><br><span class="line">  <span class="keyword">const</span> tokenMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  <span class="comment">// 默认失败</span></span><br><span class="line">  tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;success&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// 清除hash值，不然无限循环</span></span><br><span class="line">  <span class="keyword">if</span> (tokenStr !== <span class="literal">null</span> &amp;&amp; tokenStr !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 有hash值需要清理</span></span><br><span class="line">    tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;success&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// 去除第一个#号</span></span><br><span class="line">    <span class="keyword">if</span> (tokenStr.<span class="title function_">startsWith</span>(<span class="string">&#x27;#&#x27;</span>)) &#123;</span><br><span class="line">      tokenStr = tokenStr.<span class="title function_">replace</span>(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (tokenStr != <span class="literal">null</span> &amp;&amp; tokenStr !== <span class="literal">undefined</span> &amp;&amp; tokenStr !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 通过&amp;符号分割</span></span><br><span class="line">        <span class="keyword">const</span> tokenArray = tokenStr.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">        <span class="comment">// 转为key存储形式</span></span><br><span class="line">        tokenArray.<span class="title function_">forEach</span>(<span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> strArr = str.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">          tokenMap.<span class="title function_">set</span>(strArr[<span class="number">0</span>], strArr[<span class="number">1</span>])</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;/access_token&#x27;</span>) &amp;&amp; !<span class="title function_">getToken</span>()) &#123;</span><br><span class="line">          <span class="comment">// localStorage.setItem(&#x27;token&#x27;, tokenMap.get(&#x27;/access_token&#x27;))</span></span><br><span class="line">          <span class="title function_">setToken</span>(tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;/access_token&#x27;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// token放置到cookie</span></span><br><span class="line">        <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="comment">// const token = Cookies.get(&#x27;token&#x27;)</span></span><br><span class="line">          <span class="keyword">const</span> token = <span class="title function_">getToken</span>()</span><br><span class="line">          <span class="comment">// token不相等，重新替换</span></span><br><span class="line">          <span class="keyword">if</span> (tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>) !== token) &#123;</span><br><span class="line">            <span class="comment">// 存储</span></span><br><span class="line">            <span class="comment">// Cookies.set(&#x27;token&#x27;, tokenMap.get(&#x27;access_token&#x27;))</span></span><br><span class="line">            <span class="title function_">setToken</span>(tokenMap.<span class="title function_">get</span>(<span class="string">&#x27;access_token&#x27;</span>))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 放入cookie中的token到map中</span></span><br><span class="line">  tokenMap.<span class="title function_">set</span>(<span class="string">&#x27;access_token&#x27;</span>, <span class="title function_">getToken</span>())</span><br><span class="line">  <span class="keyword">return</span> tokenMap</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// finish progress bar</span></span><br><span class="line">  <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>iframe</tag>
      </tags>
  </entry>
  <entry>
    <title>拦截器写法(1)及封装请求方法</title>
    <url>/2022/02/24/43%E6%8B%A6%E6%88%AA%E5%99%A8%E5%86%99%E6%B3%95(1)%E5%8F%8A%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="拦截器写法-1-及封装请求方法"><a href="#拦截器写法-1-及封装请求方法" class="headerlink" title="拦截器写法(1)及封装请求方法"></a>拦截器写法(1)及封装请求方法</h1><blockquote>
<p>路径：src\utils\auth.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Cookies</span> <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TokenKey</span> = <span class="string">&#x27;hrToken&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">get</span>(<span class="title class_">TokenKey</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">setToken</span>(<span class="params">token</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">set</span>(<span class="title class_">TokenKey</span>, token)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">removeToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">remove</span>(<span class="title class_">TokenKey</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：src\utils\request.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Message</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serviceObj = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an axios instance</span></span><br><span class="line"><span class="comment">// 创建实例化</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">// 环境变量改变会随之改变----生成----开发----env文件</span></span><br><span class="line">  <span class="attr">baseURL</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>, <span class="comment">// url = base url + request url</span></span><br><span class="line">  <span class="comment">// withCredentials: true, // send cookies when cross-domain requests</span></span><br><span class="line">  <span class="comment">// 超时时间</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// request interceptor请求拦截器</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) &#123;</span><br><span class="line">    <span class="comment">// 主动介入</span></span><br><span class="line">    <span class="keyword">const</span> loginTime = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;setTimeOut&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> loginTimeOut = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">    <span class="keyword">const</span> isTimeOut = (loginTimeOut - loginTime) &gt; <span class="number">864000000</span></span><br><span class="line">    <span class="comment">// 判断是否超时退出登录</span></span><br><span class="line">    <span class="keyword">if</span> (isTimeOut) &#123;</span><br><span class="line">      store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/logout&#x27;</span>)</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;已超时(主动)&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果token存在 注入token</span></span><br><span class="line">    config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;store.getters.token&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 一定要返回值</span></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line">,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// do something with request error</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error) <span class="comment">// for debug</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// response interceptor响应拦截器 两个参数</span></span><br><span class="line">service.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 成功的回调(网络层面)解构出请求成功的布尔值和token</span></span><br><span class="line">  <span class="keyword">const</span> &#123; success, data, message &#125; = res.<span class="property">data</span></span><br><span class="line">  <span class="keyword">if</span> (success) &#123;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 失败</span></span><br><span class="line">    <span class="title class_">Message</span>.<span class="title function_">error</span>(message)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 被动处理退出登录</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">response</span> &amp;&amp; err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">code</span> === <span class="number">10002</span>) &#123;</span><br><span class="line">    store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/logout&#x27;</span>)</span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 失败的回调(网络层面)</span></span><br><span class="line">  <span class="title class_">Message</span>.<span class="title function_">error</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// 则停止当前执行请求--直接走到catch抛出错误</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="number">39</span>, err))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">serviceObj.<span class="property">get</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">get</span>(url, &#123; <span class="attr">params</span>: data,</span><br><span class="line">      <span class="attr">responseType</span>: options &amp;&amp; options.<span class="property">responseType</span> ? options.<span class="property">responseType</span> : <span class="string">&#x27;text&#x27;</span> &#125;, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">post</span> = <span class="keyword">function</span>(<span class="params">url, data = &#123;&#125;, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">post</span>(url, data, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: options &amp;&amp; options.<span class="property">timeOut</span> ? options.<span class="property">timeOut</span> : <span class="number">60000</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: options &amp;&amp; options.<span class="property">contentType</span> ? options.<span class="property">contentType</span> : <span class="string">&#x27;application/json;charset=utf-8&#x27;</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">patch</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">patch</span>(url, data, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">delete</span> = <span class="keyword">function</span>(<span class="params">url, data, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    service.<span class="title function_">delete</span>(url, &#123; <span class="attr">data</span>: data &#125;, &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60000</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(response)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">error</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logOut</span>(<span class="params">message</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (message === <span class="string">&#x27;登陆超时&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// sessionStorage.clear()</span></span><br><span class="line">    <span class="comment">// window.location.href = &#x27;/login&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">serviceObj.<span class="property">downLoads</span> = <span class="keyword">function</span>(<span class="params">url, data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">axios</span>(&#123;</span><br><span class="line">      <span class="attr">baseURL</span>: baseURL,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">      <span class="attr">url</span>: url,</span><br><span class="line">      <span class="attr">headers</span>: &#123; <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`Bearer <span class="subst">$&#123;getSessionToken()&#125;</span>`</span> &#125;,</span><br><span class="line">      <span class="attr">responseType</span>: <span class="string">&#x27;blob&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: data</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> file = res.<span class="property">headers</span>[<span class="string">&#x27;content-disposition&#x27;</span>]</span><br><span class="line">      file = file ? file.<span class="title function_">split</span>(<span class="string">&#x27;filename=&#x27;</span>)[<span class="number">1</span>] : <span class="string">&#x27;无描述文件.xls&#x27;</span></span><br><span class="line">      file = <span class="built_in">decodeURI</span>(file)</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">navigator</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="property">msSaveOrOpenBlob</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> csvData = <span class="keyword">new</span> <span class="title class_">Blob</span>([res.<span class="property">data</span>], &#123; <span class="attr">type</span>: <span class="string">&#x27;application/vnd.ms-excel&#x27;</span> &#125;)</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="title function_">msSaveOrOpenBlob</span>(csvData, file)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> url = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([res.<span class="property">data</span>]))</span><br><span class="line">        <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        link.<span class="property">href</span> = url</span><br><span class="line">        link.<span class="property">download</span> = file</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link)</span><br><span class="line">        link.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link)</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(url)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// handlerResponseError(error.response.data)</span></span><br><span class="line">      <span class="comment">// console.log(error.response.data)</span></span><br><span class="line">      <span class="comment">// Message.error(error.message)</span></span><br><span class="line">      <span class="title function_">logOut</span>(error.<span class="property">message</span>)</span><br><span class="line">      <span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：.env.development（环境变量文件配置）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># just a flag</span><br><span class="line">ENV = &#x27;development&#x27;</span><br><span class="line"></span><br><span class="line"># base api</span><br><span class="line">VUE_APP_BASE_API = &#x27;/api&#x27;</span><br><span class="line"></span><br><span class="line">port=8080</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：vue.config.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> defaultSettings = <span class="built_in">require</span>(<span class="string">&#x27;./src/settings.js&#x27;</span>)</span><br><span class="line"><span class="comment">// 排除 elementUI xlsx  和 vue</span></span><br><span class="line"><span class="keyword">const</span> externals =</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="string">&#x27;vue&#x27;</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;element-ui&#x27;</span>: <span class="string">&#x27;ELEMENT&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;xlsx&#x27;</span>: <span class="string">&#x27;XLSX&#x27;</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cdn = &#123;</span><br><span class="line">  <span class="attr">css</span>: [</span><br><span class="line">    <span class="comment">// element-ui css</span></span><br><span class="line">    <span class="string">&#x27;https://unpkg.com/element-ui/lib/theme-chalk/index.css&#x27;</span> <span class="comment">// 样式表</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">js</span>: [</span><br><span class="line">    <span class="comment">// vue must at first!</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.bootcdn.net/ajax/libs/vue/2.6.10/vue.common.dev.js&#x27;</span>, <span class="comment">// vuejs</span></span><br><span class="line">    <span class="comment">// element-ui js</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.3/index.js&#x27;</span>, <span class="comment">// elementUI</span></span><br><span class="line">    <span class="string">&#x27;https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/jszip.min.js&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/xlsx.full.min.js&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resolve</span>(<span class="params">dir</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> path.<span class="title function_">join</span>(__dirname, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 网站标题名称</span></span><br><span class="line"><span class="keyword">const</span> name = defaultSettings.<span class="property">title</span> || <span class="string">&#x27;vue Admin Template&#x27;</span> <span class="comment">// page title</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// If your port is set to 80,</span></span><br><span class="line"><span class="comment">// use administrator privileges to execute the command line.</span></span><br><span class="line"><span class="comment">// For example, Mac: sudo npm run</span></span><br><span class="line"><span class="comment">// You can change the port by the following methods:</span></span><br><span class="line"><span class="comment">// port = 9528 npm run dev OR npm run dev --port = 9528</span></span><br><span class="line"><span class="comment">// 端口</span></span><br><span class="line"><span class="keyword">const</span> port = process.<span class="property">env</span>.<span class="property">port</span> || process.<span class="property">env</span>.<span class="property">npm_config_port</span> || <span class="number">9528</span> <span class="comment">// dev port</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// All configuration item explanations can be find in https://cli.vuejs.org/config/</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * You will need to set publicPath if you plan to deploy your site under a sub path,</span></span><br><span class="line"><span class="comment">   * for example GitHub Pages. If you plan to deploy your site to https://foo.github.io/bar/,</span></span><br><span class="line"><span class="comment">   * then publicPath should be set to &quot;/bar/&quot;.</span></span><br><span class="line"><span class="comment">   * In most cases please use &#x27;/&#x27; !!!</span></span><br><span class="line"><span class="comment">   * Detail: https://cli.vuejs.org/config/#publicpath</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">publicPath</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="attr">outputDir</span>: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">  <span class="attr">assetsDir</span>: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">  <span class="attr">lintOnSave</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">productionSourceMap</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: port,</span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">overlay</span>: &#123;</span><br><span class="line">      <span class="attr">warnings</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">errors</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://ihrm-java.itheima.net/&#x27;</span>,</span><br><span class="line">        <span class="comment">// target: &#x27;http://192.168.108.90:3000&#x27;,</span></span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">configureWebpack</span>: &#123;</span><br><span class="line">    externals,</span><br><span class="line">    <span class="comment">// provide the app&#x27;s title in webpack&#x27;s name field, so that</span></span><br><span class="line">    <span class="comment">// it can be accessed in index.html to inject the correct title.</span></span><br><span class="line">    <span class="attr">name</span>: name,</span><br><span class="line">    <span class="attr">resolve</span>: &#123;</span><br><span class="line">      <span class="attr">alias</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;@&#x27;</span>: <span class="title function_">resolve</span>(<span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">chainWebpack</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    config.<span class="title function_">plugin</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">tap</span>(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">      args[<span class="number">0</span>].<span class="property">cdn</span> = cdn</span><br><span class="line">      <span class="keyword">return</span> args</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// it can improve the speed of the first screen, it is recommended to turn on preload</span></span><br><span class="line">    config.<span class="title function_">plugin</span>(<span class="string">&#x27;preload&#x27;</span>).<span class="title function_">tap</span>(<span class="function">() =&gt;</span> [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">rel</span>: <span class="string">&#x27;preload&#x27;</span>,</span><br><span class="line">        <span class="comment">// to ignore runtime.js</span></span><br><span class="line">        <span class="comment">// https://github.com/vuejs/vue-cli/blob/dev/packages/@vue/cli-service/lib/config/app.js#L171</span></span><br><span class="line">        <span class="attr">fileBlacklist</span>: [<span class="regexp">/\.map$/</span>, <span class="regexp">/hot-update\.js$/</span>, <span class="regexp">/runtime\..*\.js$/</span>],</span><br><span class="line">        <span class="attr">include</span>: <span class="string">&#x27;initial&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// when there are many pages, it will cause too many meaningless requests</span></span><br><span class="line">    config.<span class="property">plugins</span>.<span class="title function_">delete</span>(<span class="string">&#x27;prefetch&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set svg-sprite-loader</span></span><br><span class="line">    config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;svg&#x27;</span>)</span><br><span class="line">      .<span class="property">exclude</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">    config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;icons&#x27;</span>)</span><br><span class="line">      .<span class="title function_">test</span>(<span class="regexp">/\.svg$/</span>)</span><br><span class="line">      .<span class="property">include</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">      .<span class="title function_">use</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">loader</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">options</span>(&#123;</span><br><span class="line">        <span class="attr">symbolId</span>: <span class="string">&#x27;icon-[name]&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line"></span><br><span class="line">    config</span><br><span class="line">      .<span class="title function_">when</span>(process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">        <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">          config</span><br><span class="line">            .<span class="title function_">plugin</span>(<span class="string">&#x27;ScriptExtHtmlWebpackPlugin&#x27;</span>)</span><br><span class="line">            .<span class="title function_">after</span>(<span class="string">&#x27;html&#x27;</span>)</span><br><span class="line">            .<span class="title function_">use</span>(<span class="string">&#x27;script-ext-html-webpack-plugin&#x27;</span>, [&#123;</span><br><span class="line">              <span class="comment">// `runtime` must same as runtimeChunk name. default is `runtime`</span></span><br><span class="line">              <span class="attr">inline</span>: <span class="regexp">/runtime\..*\.js$/</span></span><br><span class="line">            &#125;])</span><br><span class="line">            .<span class="title function_">end</span>()</span><br><span class="line">          config</span><br><span class="line">            .<span class="property">optimization</span>.<span class="title function_">splitChunks</span>(&#123;</span><br><span class="line">              <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">              <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">                <span class="attr">libs</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-libs&#x27;</span>,</span><br><span class="line">                  <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">10</span>,</span><br><span class="line">                  <span class="attr">chunks</span>: <span class="string">&#x27;initial&#x27;</span> <span class="comment">// only package third parties that are initially dependent</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">elementUI</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-elementUI&#x27;</span>, <span class="comment">// split elementUI into a single package</span></span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">20</span>, <span class="comment">// the weight needs to be larger than libs and app or it will be packaged into libs or app</span></span><br><span class="line">                  <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]_?element-ui(.*)/</span> <span class="comment">// in order to adapt to cnpm</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">commons</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;chunk-commons&#x27;</span>,</span><br><span class="line">                  <span class="attr">test</span>: <span class="title function_">resolve</span>(<span class="string">&#x27;src/components&#x27;</span>), <span class="comment">// can customize your rules</span></span><br><span class="line">                  <span class="attr">minChunks</span>: <span class="number">3</span>, <span class="comment">//  minimum common number</span></span><br><span class="line">                  <span class="attr">priority</span>: <span class="number">5</span>,</span><br><span class="line">                  <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          <span class="comment">// https:// webpack.js.org/configuration/optimization/#optimizationruntimechunk</span></span><br><span class="line">          config.<span class="property">optimization</span>.<span class="title function_">runtimeChunk</span>(<span class="string">&#x27;single&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>路径：src\store\modules\user.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入登录接口</span></span><br><span class="line"><span class="keyword">import</span> &#123; login, getUserInfo, getUserById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"><span class="comment">// 导入cookie封装的函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; setToken, getToken, removeToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; resetRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"><span class="comment">// 定义公共数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="comment">// 定义token变量</span></span><br><span class="line">  <span class="attr">token</span>: <span class="title function_">getToken</span>() || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="comment">// 定义用户信息变量</span></span><br><span class="line">  <span class="attr">userInfo</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line"><span class="comment">// 修改token值--异步修改</span></span><br><span class="line">  <span class="title function_">changeToken</span>(<span class="params">state, data</span>) &#123;</span><br><span class="line">    <span class="comment">// 持久保存token</span></span><br><span class="line">    <span class="comment">// localStorage.setItem(&#x27;hrToken&#x27;, data)</span></span><br><span class="line">    <span class="title function_">setToken</span>(data)</span><br><span class="line">    state.<span class="property">token</span> = data</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 删除token</span></span><br><span class="line">  <span class="title function_">removeToken</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">token</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="title function_">removeToken</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 修改userInfo的值</span></span><br><span class="line">  <span class="title function_">changeUserInfo</span>(<span class="params">state, data</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = &#123; ...data &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 删除用户信息</span></span><br><span class="line">  <span class="title function_">removeuserInfo</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">userInfo</span> = &#123; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// 异步修改-必修通过mutations</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">store, data</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">login</span>(data)</span><br><span class="line">    <span class="comment">// //console.log(&#x27;成功&#x27;, res)</span></span><br><span class="line">    <span class="comment">// 修改通过mutations</span></span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;changeToken&#x27;</span>, res)</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;setTimeOut&#x27;</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>())</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserInfo</span>(<span class="params">store, data</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>(data)</span><br><span class="line">    <span class="keyword">const</span> userRes = <span class="keyword">await</span> <span class="title function_">getUserById</span>(res.<span class="property">userId</span>)</span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&#x27;changeUserInfo&#x27;</span>, &#123; ...res, ...userRes &#125;)</span><br><span class="line">    <span class="comment">// //console.log(&#123; ...res, ...userRes &#125;)</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">logout</span>(<span class="params">stroe</span>) &#123;</span><br><span class="line">    stroe.<span class="title function_">commit</span>(<span class="string">&#x27;removeToken&#x27;</span>)</span><br><span class="line">    stroe.<span class="title function_">commit</span>(<span class="string">&#x27;removeuserInfo&#x27;</span>)</span><br><span class="line">    <span class="title function_">resetRouter</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// getter文件</span></span><br><span class="line">    <span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="attr">token</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">user</span>.<span class="property">token</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters</span><br><span class="line"></span><br><span class="line"><span class="comment">// api文件</span></span><br><span class="line">    <span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/sys/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">     <span class="comment">// 点击登录按钮--</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleLogin</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">loginForm</span>.<span class="title function_">validate</span>()</span><br><span class="line">      <span class="comment">// 发起请求</span></span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/login&#x27;</span>, <span class="variable language_">this</span>.<span class="property">loginForm</span>)</span><br><span class="line">      <span class="comment">// 提示用户</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&#x27;登录成功&#x27;</span>)</span><br><span class="line">      <span class="comment">// 跳转页面</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <tags>
        <tag>api</tag>
      </tags>
  </entry>
  <entry>
    <title>响应拦截器的另一种写法</title>
    <url>/2022/03/18/44%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E5%86%99%E6%B3%95/</url>
    <content><![CDATA[<h1 id="响应拦截器的另一种写法"><a href="#响应拦截器的另一种写法" class="headerlink" title="响应拦截器的另一种写法"></a>响应拦截器的另一种写法</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// response interceptor</span></span><br><span class="line">https.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">getSessionToken</span>(<span class="string">&#x27;billing-token&#x27;</span>)</span><br><span class="line">    <span class="comment">// 从头部取token，根据项目实际情况做调整</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> response.<span class="property">data</span> === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        response.<span class="property">data</span>.<span class="property">token</span> = token</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// setToken(response.headers[&#x27;token&#x27;])</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">errorCode</span> &amp;&amp; response.<span class="property">data</span>.<span class="property">errorCode</span> === <span class="string">&#x27;408&#x27;</span>) &#123;</span><br><span class="line">      store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/getToken&#x27;</span>)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (res) &#123;</span><br><span class="line">            <span class="title function_">setSessionToken</span>(res)</span><br><span class="line">            response.<span class="property">config</span>.<span class="property">baseURL</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 重新请求无需baseURL</span></span><br><span class="line">            <span class="title function_">https</span>(response.<span class="property">config</span>) <span class="comment">// 重新发起失败请求</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.<span class="property">message</span> = response.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? response.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">            <span class="title function_">removeSessionToken</span>()</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">BssLayout</span>.<span class="property">console</span>.<span class="title function_">goLogin</span>()</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span> ? response.<span class="property">data</span> : &#123; <span class="attr">code</span>: <span class="string">&#x27;200&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;请求成功&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err &amp;&amp; err.<span class="property">response</span>) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (err.<span class="property">response</span>.<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;请求出错&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;登陆超时&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;拒绝访问&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;请求错误,未找到该资源&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          <span class="comment">// 权限不足不做拦截重新获取token  408 拦截无效和过期做重新请求token</span></span><br><span class="line">          <span class="keyword">if</span> (err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorCode</span> &amp;&amp; err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorCode</span> === <span class="string">&#x27;408&#x27;</span>) &#123;</span><br><span class="line">            store.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/getToken&#x27;</span>)</span><br><span class="line">              .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                  <span class="title function_">setSessionToken</span>(res)</span><br><span class="line">                  err.<span class="property">config</span>.<span class="property">baseURL</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 重新请求无需baseURL</span></span><br><span class="line">                  <span class="title function_">https</span>(err.<span class="property">config</span>) <span class="comment">// 重新发起失败请求</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">                  <span class="title function_">removeSessionToken</span>()</span><br><span class="line">                  <span class="variable language_">window</span>.<span class="property">BssLayout</span>.<span class="property">console</span>.<span class="title function_">goLogin</span>()</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            err.<span class="property">message</span> = err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> ? err.<span class="property">response</span>.<span class="property">data</span>.<span class="property">errorMsg</span> : <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">502</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;服务器端出错&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ECONNABORTED&#x27;</span>:</span><br><span class="line">          err.<span class="property">message</span> = <span class="string">&#x27;请求超时&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      err.<span class="property">message</span> = <span class="string">&#x27;连接服务器超时&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>api</tag>
      </tags>
  </entry>
  <entry>
    <title>this.$router.options.routes 可以拿到初始化时配置的路由规则</title>
    <url>/2022/03/20/45$router.options.routes/</url>
    <content><![CDATA[<h1 id="this-router-options-routes-可以拿到初始化时配置的路由规则"><a href="#this-router-options-routes-可以拿到初始化时配置的路由规则" class="headerlink" title="this.$router.options.routes 可以拿到初始化时配置的路由规则"></a>this.$router.options.routes 可以拿到初始化时配置的路由规则</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="property">options</span>.<span class="property">routes</span> 可以拿到初始化时配置的路由规则 </span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>router</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出图片</title>
    <url>/2022/04/12/48%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BA%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h1 id="纯前端导出图片"><a href="#纯前端导出图片" class="headerlink" title="纯前端导出图片"></a>纯前端导出图片</h1><h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>npm i html2canvas</p>
</blockquote>
<h2 id="步骤2：导入需要的插件"><a href="#步骤2：导入需要的插件" class="headerlink" title="步骤2：导入需要的插件"></a>步骤2：导入需要的插件</h2><blockquote>
<p>import html2canvas from “html2canvas”;</p>
</blockquote>
<h2 id="步骤3：给img标签添加ref"><a href="#步骤3：给img标签添加ref" class="headerlink" title="步骤3：给img标签添加ref"></a>步骤3：给img标签添加ref</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img :src=&quot;&#x27;data:image/gif;base64,&#x27;+srcImg&quot; alt=&quot;&quot; style=&quot;width: 100px;height: 100px;&quot; ref=&quot;printform&quot; id=&quot;printform&quot;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：点击函数封装"><a href="#步骤4：点击函数封装" class="headerlink" title="步骤4：点击函数封装"></a>步骤4：点击函数封装</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">html2canvas</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">printform</span>, &#123;<span class="comment">//this.$refs.printform图片节点</span></span><br><span class="line">        <span class="attr">allowTaint</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">taintTest</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">useCORS</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">dpi</span>: <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">4</span>, <span class="comment">//将分辨率提高到特定的DPI 提高四倍</span></span><br><span class="line">        <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">//按比例增加分辨率</span></span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        link.<span class="property">href</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/jpeg&quot;</span>, <span class="number">1.0</span>); <span class="comment">//下载链接</span></span><br><span class="line">        link.<span class="title function_">setAttribute</span>(</span><br><span class="line">          <span class="string">&quot;download&quot;</span>,</span><br><span class="line">          <span class="string">`头像.jpeg`</span></span><br><span class="line">        );</span><br><span class="line">        link.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>; <span class="comment">//a标签隐藏</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link);</span><br><span class="line">        link.<span class="title function_">click</span>();</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link) <span class="comment">// 下载完成移除元素</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出xlsx文件</title>
    <url>/2022/03/24/46%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BAxlsx%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="纯前端导出xlsx文件"><a href="#纯前端导出xlsx文件" class="headerlink" title="纯前端导出xlsx文件"></a>纯前端导出xlsx文件</h1><h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><blockquote>
<p>下载依赖：npm i file-saver <a href="mailto:&#x78;&#108;&#x73;&#120;&#x40;&#x30;&#x2e;&#x31;&#52;&#x2e;&#49;">&#x78;&#108;&#x73;&#120;&#x40;&#x30;&#x2e;&#x31;&#52;&#x2e;&#49;</a></p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><blockquote>
<p>在封装插件的文件夹下创建 Export2Excel.js</p>
</blockquote>
<p>下面代码全复制到Export2Excel.js中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="keyword">import</span> &#123; saveAs &#125; <span class="keyword">from</span> <span class="string">&#x27;file-saver&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="variable constant_">XLSX</span> <span class="keyword">from</span> <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">XLSX</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateArray</span>(<span class="params">table</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> out = [];</span><br><span class="line">  <span class="keyword">var</span> rows = table.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;tr&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> ranges = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R &lt; rows.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">var</span> outRow = [];</span><br><span class="line">    <span class="keyword">var</span> row = rows[R];</span><br><span class="line">    <span class="keyword">var</span> columns = row.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;td&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C &lt; columns.<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">var</span> cell = columns[C];</span><br><span class="line">      <span class="keyword">var</span> colspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&#x27;colspan&#x27;</span>);</span><br><span class="line">      <span class="keyword">var</span> rowspan = cell.<span class="title function_">getAttribute</span>(<span class="string">&#x27;rowspan&#x27;</span>);</span><br><span class="line">      <span class="keyword">var</span> cellValue = cell.<span class="property">innerText</span>;</span><br><span class="line">      <span class="keyword">if</span> (cellValue !== <span class="string">&quot;&quot;</span> &amp;&amp; cellValue == +cellValue) cellValue = +cellValue;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Skip ranges</span></span><br><span class="line">      ranges.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">range</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (R &gt;= range.<span class="property">s</span>.<span class="property">r</span> &amp;&amp; R &lt;= range.<span class="property">e</span>.<span class="property">r</span> &amp;&amp; outRow.<span class="property">length</span> &gt;= range.<span class="property">s</span>.<span class="property">c</span> &amp;&amp; outRow.<span class="property">length</span> &lt;= range.<span class="property">e</span>.<span class="property">c</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= range.<span class="property">e</span>.<span class="property">c</span> - range.<span class="property">s</span>.<span class="property">c</span>; ++i) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Row Span</span></span><br><span class="line">      <span class="keyword">if</span> (rowspan || colspan) &#123;</span><br><span class="line">        rowspan = rowspan || <span class="number">1</span>;</span><br><span class="line">        colspan = colspan || <span class="number">1</span>;</span><br><span class="line">        ranges.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">s</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">e</span>: &#123;</span><br><span class="line">            <span class="attr">r</span>: R + rowspan - <span class="number">1</span>,</span><br><span class="line">            <span class="attr">c</span>: outRow.<span class="property">length</span> + colspan - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Value</span></span><br><span class="line">      outRow.<span class="title function_">push</span>(cellValue !== <span class="string">&quot;&quot;</span> ? cellValue : <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Handle Colspan</span></span><br><span class="line">      <span class="keyword">if</span> (colspan)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; colspan - <span class="number">1</span>; ++k) outRow.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    out.<span class="title function_">push</span>(outRow);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [out, ranges];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">datenum</span>(<span class="params">v, date1904</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (date1904) v += <span class="number">1462</span>;</span><br><span class="line">  <span class="keyword">var</span> epoch = <span class="title class_">Date</span>.<span class="title function_">parse</span>(v);</span><br><span class="line">  <span class="keyword">return</span> (epoch - <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">UTC</span>(<span class="number">1899</span>, <span class="number">11</span>, <span class="number">30</span>))) / (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sheet_from_array_of_arrays</span>(<span class="params">data, opts</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ws = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> range = &#123;</span><br><span class="line">    <span class="attr">s</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">10000000</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">10000000</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">e</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">r</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> R = <span class="number">0</span>; R != data.<span class="property">length</span>; ++R) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> C = <span class="number">0</span>; C != data[R].<span class="property">length</span>; ++C) &#123;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">r</span> &gt; R) range.<span class="property">s</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &gt; C) range.<span class="property">s</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">r</span> &lt; R) range.<span class="property">e</span>.<span class="property">r</span> = R;</span><br><span class="line">      <span class="keyword">if</span> (range.<span class="property">e</span>.<span class="property">c</span> &lt; C) range.<span class="property">e</span>.<span class="property">c</span> = C;</span><br><span class="line">      <span class="keyword">var</span> cell = &#123;</span><br><span class="line">        <span class="attr">v</span>: data[R][C]</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">if</span> (cell.<span class="property">v</span> == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">var</span> cell_ref = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_cell</span>(&#123;</span><br><span class="line">        <span class="attr">c</span>: C,</span><br><span class="line">        <span class="attr">r</span>: R</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&#x27;number&#x27;</span>) cell.<span class="property">t</span> = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> cell.<span class="property">v</span> === <span class="string">&#x27;boolean&#x27;</span>) cell.<span class="property">t</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (cell.<span class="property">v</span> <span class="keyword">instanceof</span> <span class="title class_">Date</span>) &#123;</span><br><span class="line">        cell.<span class="property">t</span> = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">        cell.<span class="property">z</span> = <span class="variable constant_">XLSX</span>.<span class="property">SSF</span>.<span class="property">_table</span>[<span class="number">14</span>];</span><br><span class="line">        cell.<span class="property">v</span> = <span class="title function_">datenum</span>(cell.<span class="property">v</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> cell.<span class="property">t</span> = <span class="string">&#x27;s&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      ws[cell_ref] = cell;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (range.<span class="property">s</span>.<span class="property">c</span> &lt; <span class="number">10000000</span>) ws[<span class="string">&#x27;!ref&#x27;</span>] = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">encode_range</span>(range);</span><br><span class="line">  <span class="keyword">return</span> ws;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Workbook</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">Workbook</span>)) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Workbook</span>();</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">SheetNames</span> = [];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">Sheets</span> = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">s2ab</span>(<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(s.<span class="property">length</span>);</span><br><span class="line">  <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buf);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i != s.<span class="property">length</span>; ++i) view[i] = s.<span class="title function_">charCodeAt</span>(i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_table_to_excel</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> theTable = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line">  <span class="keyword">var</span> oo = <span class="title function_">generateArray</span>(theTable);</span><br><span class="line">  <span class="keyword">var</span> ranges = oo[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  <span class="keyword">var</span> data = oo[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add ranges to worksheet */</span></span><br><span class="line">  <span class="comment">// ws[&#x27;!cols&#x27;] = [&#x27;apple&#x27;, &#x27;banan&#x27;];</span></span><br><span class="line">  ws[<span class="string">&#x27;!merges&#x27;</span>] = ranges;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span>,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">saveAs</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">  &#125;), <span class="string">&quot;test.xlsx&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">export_json_to_excel</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">  multiHeader = [],</span></span><br><span class="line"><span class="params">  header,</span></span><br><span class="line"><span class="params">  data,</span></span><br><span class="line"><span class="params">  filename,</span></span><br><span class="line"><span class="params">  merges = [],</span></span><br><span class="line"><span class="params">  autoWidth = <span class="literal">true</span>,</span></span><br><span class="line"><span class="params">  bookType = <span class="string">&#x27;xlsx&#x27;</span></span></span><br><span class="line"><span class="params">&#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="comment">/* original data */</span></span><br><span class="line">  filename = filename || <span class="string">&#x27;excel-list&#x27;</span></span><br><span class="line">  data = [...data]</span><br><span class="line">  data.<span class="title function_">unshift</span>(header);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = multiHeader.<span class="property">length</span> - <span class="number">1</span>; i &gt; -<span class="number">1</span>; i--) &#123;</span><br><span class="line">    data.<span class="title function_">unshift</span>(multiHeader[i])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ws_name = <span class="string">&quot;SheetJS&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> wb = <span class="keyword">new</span> <span class="title class_">Workbook</span>(),</span><br><span class="line">    ws = <span class="title function_">sheet_from_array_of_arrays</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (merges.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ws[<span class="string">&#x27;!merges&#x27;</span>]) ws[<span class="string">&#x27;!merges&#x27;</span>] = [];</span><br><span class="line">    merges.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      ws[<span class="string">&#x27;!merges&#x27;</span>].<span class="title function_">push</span>(<span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">decode_range</span>(item))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (autoWidth) &#123;</span><br><span class="line">    <span class="comment">/*设置worksheet每列的最大宽度*/</span></span><br><span class="line">    <span class="keyword">const</span> colWidth = data.<span class="title function_">map</span>(<span class="function"><span class="params">row</span> =&gt;</span> row.<span class="title function_">map</span>(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/*先判断是否为null/undefined*/</span></span><br><span class="line">      <span class="keyword">if</span> (val == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: <span class="number">10</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/*再判断是否为中文*/</span></span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (val.<span class="title function_">toString</span>().<span class="title function_">charCodeAt</span>(<span class="number">0</span>) &gt; <span class="number">255</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: val.<span class="title function_">toString</span>().<span class="property">length</span> * <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="string">&#x27;wch&#x27;</span>: val.<span class="title function_">toString</span>().<span class="property">length</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="comment">/*以第一行为初始值*/</span></span><br><span class="line">    <span class="keyword">let</span> result = colWidth[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; colWidth.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; colWidth[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (result[j][<span class="string">&#x27;wch&#x27;</span>] &lt; colWidth[i][j][<span class="string">&#x27;wch&#x27;</span>]) &#123;</span><br><span class="line">          result[j][<span class="string">&#x27;wch&#x27;</span>] = colWidth[i][j][<span class="string">&#x27;wch&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ws[<span class="string">&#x27;!cols&#x27;</span>] = result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* add worksheet to workbook */</span></span><br><span class="line">  wb.<span class="property">SheetNames</span>.<span class="title function_">push</span>(ws_name);</span><br><span class="line">  wb.<span class="property">Sheets</span>[ws_name] = ws;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wbout = <span class="variable constant_">XLSX</span>.<span class="title function_">write</span>(wb, &#123;</span><br><span class="line">    <span class="attr">bookType</span>: bookType,</span><br><span class="line">    <span class="attr">bookSST</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">saveAs</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title function_">s2ab</span>(wbout)], &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">  &#125;), <span class="string">`<span class="subst">$&#123;filename&#125;</span>.<span class="subst">$&#123;bookType&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>在导出按钮的vue组件methods中封装导出函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data：&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">downloadLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">dataList</span>:[],<span class="comment">//表格列表</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;&#x27;</span>,<span class="comment">//导出名字</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span><span class="comment">//导出文件后缀xlsx,txt,csv</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleDownload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;@/components/vendor/Export2Excel&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> tHeader = [<span class="string">&#x27;鱼场名称&#x27;</span>, <span class="string">&#x27;鱼场类型&#x27;</span>, <span class="string">&#x27;详细地址&#x27;</span>, <span class="string">&#x27;经度&#x27;</span>, <span class="string">&#x27;纬度&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> filterVal = [<span class="string">&#x27;farmName&#x27;</span>, <span class="string">&#x27;farmType&#x27;</span>, <span class="string">&#x27;address&#x27;</span>, <span class="string">&#x27;longitude&#x27;</span>, <span class="string">&#x27;latitude&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">dataList</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="title function_">formatJson</span>(filterVal, list)</span><br><span class="line">        excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">          <span class="attr">header</span>: tHeader,</span><br><span class="line">          data,</span><br><span class="line">          <span class="attr">filename</span>: <span class="variable language_">this</span>.<span class="property">filename</span>,</span><br><span class="line">          <span class="attr">autoWidth</span>: <span class="variable language_">this</span>.<span class="property">autoWidth</span>,</span><br><span class="line">          <span class="attr">bookType</span>: <span class="variable language_">this</span>.<span class="property">bookType</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">formatJson</span>(<span class="params">filterVal, jsonData</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> jsonData.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> filterVal.<span class="title function_">map</span>(<span class="function"><span class="params">j</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (j === <span class="string">&#x27;timestamp&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">parseTime</span>(v[j])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> v[j]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4："><a href="#步骤4：" class="headerlink" title="步骤4："></a>步骤4：</h2><blockquote>
<p>表格头有合并状态的导出处理</p>
</blockquote>
<p><img src="/2022/03/24/46%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BAxlsx%E6%96%87%E4%BB%B6/01.png"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data：&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">downloadLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">dataList</span>:[],<span class="comment">//表格列表</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;&#x27;</span>,<span class="comment">//导出名字</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span><span class="comment">//导出文件后缀</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleDownload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> multiHeader = [[<span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;Main Information&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>]]</span><br><span class="line">        <span class="keyword">const</span> header = [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Author&#x27;</span>, <span class="string">&#x27;Readings&#x27;</span>, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> filterVal = [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;author&#x27;</span>, <span class="string">&#x27;pageviews&#x27;</span>, <span class="string">&#x27;display_time&#x27;</span>]</span><br><span class="line">        <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">list</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="title function_">formatJson</span>(filterVal, list)</span><br><span class="line">        <span class="keyword">const</span> merges = [<span class="string">&#x27;A1:A2&#x27;</span>, <span class="string">&#x27;B1:D1&#x27;</span>, <span class="string">&#x27;E1:E2&#x27;</span>]</span><br><span class="line">        excel.<span class="title function_">export_json_to_excel</span>(&#123;</span><br><span class="line">          multiHeader,</span><br><span class="line">          header,</span><br><span class="line">          merges,</span><br><span class="line">          data</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">downloadLoading</span> = <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">formatJson</span>(<span class="params">filterVal, jsonData</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> jsonData.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> filterVal.<span class="title function_">map</span>(<span class="function"><span class="params">j</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (j === <span class="string">&#x27;timestamp&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">parseTime</span>(v[j])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> v[j]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>上传xlsx文件及显示文件内容</title>
    <url>/2022/04/05/47%E4%B8%8A%E4%BC%A0xlsx%E6%96%87%E4%BB%B6%E5%8F%8A%E6%98%BE%E7%A4%BA%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/</url>
    <content><![CDATA[<h1 id="上传xlsx文件及显示文件内容"><a href="#上传xlsx文件及显示文件内容" class="headerlink" title="上传xlsx文件及显示文件内容"></a>上传xlsx文件及显示文件内容</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>产品要求上传xlsx时，展示文件名称和文件的sheet页数</p>
</blockquote>
<h2 id="步骤1：实现插件"><a href="#步骤1：实现插件" class="headerlink" title="步骤1：实现插件"></a>步骤1：实现插件</h2><blockquote>
<p>下载依赖：npm i <a href="mailto:&#120;&#x6c;&#115;&#120;&#64;&#48;&#x2e;&#49;&#x34;&#46;&#49;">&#120;&#x6c;&#115;&#120;&#64;&#48;&#x2e;&#49;&#x34;&#46;&#49;</a></p>
</blockquote>
<h2 id="步骤2：封装插件js"><a href="#步骤2：封装插件js" class="headerlink" title="步骤2：封装插件js"></a>步骤2：封装插件js</h2><blockquote>
<p>在封装插件的文件夹下创建 Excel.js</p>
</blockquote>
<p>下面代码全复制到Export2Excel.js中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; utils, writeFile, read &#125; <span class="keyword">from</span> <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line"><span class="comment">// vue中监听上传文件变化事件的第一个形参直接传入file即可，vue包装的对象符合格式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">importExcel</span>(<span class="params">files, cb</span>) &#123;</span><br><span class="line">  <span class="comment">// 通过FileReader对象读取文件</span></span><br><span class="line">  <span class="keyword">const</span> fileReader = <span class="keyword">new</span> <span class="title class_">FileReader</span>()</span><br><span class="line">  fileReader.<span class="property">onload</span> = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; result &#125; = event.<span class="property">target</span></span><br><span class="line">      <span class="comment">// 以二进制流方式读取得到整份excel表格对象</span></span><br><span class="line">      <span class="keyword">const</span> workbook = <span class="title function_">read</span>(result, &#123; <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span> &#125;)</span><br><span class="line">      <span class="keyword">let</span> data = [] <span class="comment">// 存储获取到的数据</span></span><br><span class="line">      <span class="comment">// 遍历每张工作表进行读取（这里默认只读取第一张表）</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> sheet <span class="keyword">in</span> workbook.<span class="property">Sheets</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (workbook.<span class="property">Sheets</span>.<span class="title function_">hasOwnProperty</span>(sheet)) &#123;</span><br><span class="line">          <span class="comment">// 利用 sheet_to_json 方法将 excel 转成 json 数据</span></span><br><span class="line"></span><br><span class="line">          data = data.<span class="title function_">concat</span>(utils.<span class="title function_">sheet_to_json</span>(workbook.<span class="property">Sheets</span>[sheet]))</span><br><span class="line">          <span class="comment">// break; // 如果只取第一张表，就取消注释这行</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (data)<span class="title function_">cb</span>(data)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="comment">// 这里可以抛出文件类型错误不正确的相关提示</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;参数或文件类型不正确&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 以二进制方式打开文件</span></span><br><span class="line">  fileReader.<span class="title function_">readAsBinaryString</span>(files[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headers 列 数组 [&#123;key:列名,title:excel显示列名&#125;]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 行数据 数组 [&#123;列名:值&#125;]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileName 文件名（包括后缀名）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">exportExcel</span>(<span class="params">headers, data, fileName = <span class="string">&#x27;项目导出.xlsx&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> _headers = headers</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">item, i</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, &#123; <span class="attr">key</span>: item.<span class="property">key</span>, <span class="attr">title</span>: item.<span class="property">title</span>, <span class="attr">position</span>: <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">65</span> + i) + <span class="number">1</span> &#125;))</span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prev, &#123; [next.<span class="property">position</span>]: &#123; <span class="attr">key</span>: next.<span class="property">key</span>, <span class="attr">v</span>: next.<span class="property">title</span> &#125;&#125;), &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> _data = data</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">item, i</span>) =&gt;</span> headers.<span class="title function_">map</span>(<span class="function">(<span class="params">key, j</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, &#123; <span class="attr">content</span>: item[key.<span class="property">key</span>], <span class="attr">position</span>: <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">65</span> + j) + (i + <span class="number">2</span>) &#125;)))</span><br><span class="line">  <span class="comment">// 对刚才的结果进行降维处理（二维数组变成一维数组）</span></span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> prev.<span class="title function_">concat</span>(next))</span><br><span class="line">  <span class="comment">// 转换成 worksheet 需要的结构</span></span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, next</span>) =&gt;</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prev, &#123; [next.<span class="property">position</span>]: &#123; <span class="attr">v</span>: next.<span class="property">content</span> &#125;&#125;), &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 合并 headers 和 data</span></span><br><span class="line">  <span class="keyword">const</span> output = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, _headers, _data)</span><br><span class="line">  <span class="comment">// 获取所有单元格的位置</span></span><br><span class="line">  <span class="keyword">const</span> outputPos = <span class="title class_">Object</span>.<span class="title function_">keys</span>(output)</span><br><span class="line">  <span class="comment">// 计算出范围 ,[&quot;A1&quot;,..., &quot;H2&quot;]</span></span><br><span class="line">  <span class="keyword">const</span> ref = <span class="string">`<span class="subst">$&#123;outputPos[<span class="number">0</span>]&#125;</span>:<span class="subst">$&#123;outputPos[outputPos.length - <span class="number">1</span>]&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构建 workbook 对象</span></span><br><span class="line">  <span class="keyword">const</span> wb = &#123;</span><br><span class="line">    <span class="title class_">SheetNames</span>: [<span class="string">&#x27;mySheet&#x27;</span>],</span><br><span class="line">    <span class="title class_">Sheets</span>: &#123;</span><br><span class="line">      <span class="attr">mySheet</span>: <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">        &#123;&#125;,</span><br><span class="line">        output,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&#x27;!ref&#x27;</span>: ref,</span><br><span class="line">          <span class="string">&#x27;!cols&#x27;</span>: [&#123; <span class="attr">wpx</span>: <span class="number">45</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">200</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">80</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">150</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">100</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">300</span> &#125;, &#123; <span class="attr">wpx</span>: <span class="number">300</span> &#125;]</span><br><span class="line">        &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 导出 Excel</span></span><br><span class="line">  <span class="title function_">writeFile</span>(wb, fileName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>封装导入组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;import&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-dialog</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">class</span>=<span class="string">&quot;dialog&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">title</span>=<span class="string">&quot;导入&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;40%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:close-on-click-modal</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:before-close</span>=<span class="string">&quot;handleClose&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:show-close</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&quot;upload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">v-loading</span>=<span class="string">&quot;loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">class</span>=<span class="string">&quot;upload-demo&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">drag</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:accept</span>=<span class="string">&quot;accept&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">action</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-success</span>=<span class="string">&quot;handleSuccess&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-exceed</span>=<span class="string">&quot;handleExceed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:http-request</span>=<span class="string">&quot;handleUpload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:before-remove</span>=<span class="string">&quot;beforeRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:limit</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-change</span>=<span class="string">&quot;handleChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-text</span>=<span class="string">&quot;正在导入中...&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-spinner</span>=<span class="string">&quot;el-icon-loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">element-loading-background</span>=<span class="string">&quot;rgba(0, 0, 0, 0.8)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">multiple</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-upload&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__text&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          将文件拖到此处，或<span class="tag">&lt;<span class="name">em</span>&gt;</span>点击上传<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: rgba(120, 130, 150, 0.5); font-size: 12px&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            支持&#123;&#123; accept &#125;&#125;文件，导入数据请勿超过XXXXX条</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__tip&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;downloadTemplate&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            下载导入模板</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;showInfo.length&quot;</span> <span class="attr">class</span>=<span class="string">&quot;showInfo&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in showInfo&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&quot;text-align: center; margin: 4px 0&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: #eb9e00&quot;</span>&gt;</span>sheet&#123;&#123; index + 1 &#125;&#125;：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>行数：&#123;&#123; item.list.length &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="comment">&lt;!-- &lt;div&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">          &lt;el-progress :percentage=&quot;50&quot; :format=&quot;format&quot;&gt;&lt;/el-progress&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">        &lt;/div&gt; --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClose&quot;</span>&gt;</span>取 消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          @<span class="attr">click</span>=<span class="string">&quot;handleDetermine&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span>确 定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; importExcel &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/Excel&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// import &#123; postMasterDataUploadApi &#125; from &#x27;@/api/masterDataManagement&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;Import&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">apiUpload</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 上传接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">dialogVisible</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 弹框</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件类型限制</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">acceptType</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">require</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="function">() =&gt;</span> [<span class="string">&#x27;.xlsx&#x27;</span>, <span class="string">&#x27;.xls&#x27;</span>]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fileList</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">file</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 覆盖上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">formUpload</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// formDdta上传格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">loading</span>: <span class="literal">false</span>, <span class="comment">// 懒加载</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">showInfo</span>: []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">accept</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">acceptType</span>.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">format</span>(<span class="params">percentage</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> percentage === <span class="number">100</span> ? <span class="string">&#x27;满&#x27;</span> : <span class="string">`<span class="subst">$&#123;percentage&#125;</span>%`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件删除钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleSuccess</span>(<span class="params">response, file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 上传成功的钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">beforeRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 删除文件前的钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> bool = <span class="variable language_">this</span>.$confirm(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">`请确认是否继续移除文件： <span class="subst">$&#123;file.name&#125;</span>？`</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="string">&#x27;提示&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">confirmButtonText</span>: <span class="string">&#x27;继 续&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取 消&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">confirmButtonClass</span>: <span class="string">&#x27;btnDelete&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      )</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> bool</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleExceed</span>(<span class="params">files, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 超出文件数钩子</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">&#x27;当前限制只能选择 1 个文件！&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleChange</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件改变</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> fileType = file.<span class="property">name</span>.<span class="title function_">substring</span>(file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;.&#x27;</span>))</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">acceptType</span>.<span class="title function_">includes</span>(fileType)) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">`只能上传后缀是【<span class="subst">$&#123;<span class="variable language_">this</span>.accept&#125;</span>】的文件`</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      importExcel([file.<span class="property">raw</span>], <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">showInfo</span> = data</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUpload</span>(<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 覆盖默认的上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">file</span> = data.<span class="property">file</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isLt2M = <span class="variable language_">this</span>.<span class="property">file</span>.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">20</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isLt2M) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;只能上传小于20M的文件&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 根据后台需求数据格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span> = <span class="keyword">new</span> <span class="title class_">FormData</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 文件对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span>.<span class="title function_">append</span>(<span class="string">&#x27;uploadFile&#x27;</span>, <span class="variable language_">this</span>.<span class="property">file</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleClose</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 关闭弹框</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;closeDialogVisible&#x27;</span>, <span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">showInfo</span> = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">file</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 覆盖上传行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">formUpload</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// formDdta上传格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">upload</span>.<span class="title function_">clearFiles</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">onUploadProgress</span>(<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> step = <span class="number">100</span> / e.<span class="property">total</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">loadbar</span> = e.<span class="property">loaded</span> * step</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">loadbar</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">handleDetermine</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 弹框确定按钮</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// const res = await postMasterDataUploadApi(</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.formUpload,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.onUploadProgress</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// )</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// this.loading = false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// if (res.result) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.success(res.msgTitle)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$emit(&#x27;updateList&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125; else &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.error(res.msgTitle)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">downloadTemplate</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 下载模板</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// try &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const res = await downCancelTemplate()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const fileUrl = window.URL.createObjectURL(new Blob([res]))</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const link = document.createElement(&#x27;a&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.style.display = &#x27;none&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.href = fileUrl</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   const date = moment().format(&#x27;YYYY_MM_DD&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.download = `后台类目模板_$&#123;date&#125;.xlsx`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   document.body.appendChild(link)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   link.click()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   document.body.removeChild(link)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   window.URL.revokeObjectURL(fileUrl)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125; catch (err) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   this.$message.error(err.msg)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.import &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.el-dialog__body</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload-list__item</span><span class="selector-pseudo">:first</span>-child &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#19c17e</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">background-color</span>: <span class="number">#19c17e17</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">16px</span> <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">height</span>: <span class="number">300px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.upload-demo</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">flex-direction</span>: column;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">align-items</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="selector-class">.el-upload-dragger</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">text-align</span>: center <span class="meta">!important</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload__text</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">text-align</span>: center <span class="meta">!important</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-upload__input</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.dialog-footer</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: flex;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">justify-content</span>: flex-end;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>图片上传封装组件使用</title>
    <url>/2022/04/15/49%E5%89%8D%E7%AB%AF%E5%B0%81%E8%A3%85%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h1 id="图片上传封装组件使用"><a href="#图片上传封装组件使用" class="headerlink" title="图片上传封装组件使用"></a>图片上传封装组件使用</h1><h2 id="步骤1：使用实例"><a href="#步骤1：使用实例" class="headerlink" title="步骤1：使用实例"></a>步骤1：使用实例</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;image-upload v-model=&quot;form.carouselImage&quot; @input=&quot;inputFn&quot; :limit=&quot;1&quot; :fileSize=&quot;10&quot;&gt;&lt;/image-upload&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：组件完整代码"><a href="#步骤2：组件完整代码" class="headerlink" title="步骤2：组件完整代码"></a>步骤2：组件完整代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;component-upload-image&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">multiple</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:action</span>=<span class="string">&quot;uploadImgUrl&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">list-type</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-success</span>=<span class="string">&quot;handleUploadSuccess&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:before-upload</span>=<span class="string">&quot;handleBeforeUpload&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:limit</span>=<span class="string">&quot;limit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-error</span>=<span class="string">&quot;handleUploadError&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-exceed</span>=<span class="string">&quot;handleExceed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">name</span>=<span class="string">&quot;file&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:show-file-list</span>=<span class="string">&quot;true&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:headers</span>=<span class="string">&quot;headers&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:file-list</span>=<span class="string">&quot;fileList&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:on-preview</span>=<span class="string">&quot;handlePictureCardPreview&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:class</span>=<span class="string">&quot;&#123;hide: this.fileList.length &gt;= this.limit&#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 上传提示 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;el-upload__tip&quot;</span> <span class="attr">slot</span>=<span class="string">&quot;tip&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;showTip&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      请上传</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;fileSize&quot;</span>&gt;</span> 大小不超过 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; fileSize &#125;&#125;MB<span class="tag">&lt;/<span class="name">b</span>&gt;</span> <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;fileType&quot;</span>&gt;</span> 格式为 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; fileType.join(&quot;/&quot;) &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span> <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      的文件</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-dialog</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">title</span>=<span class="string">&quot;预览&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;800&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">append-to-body</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:src</span>=<span class="string">&quot;dialogImageUrl&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&quot;display: block; max-width: 100%; margin: 0 auto&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; getToken &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/auth&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">value</span>: [<span class="title class_">String</span>, <span class="title class_">Object</span>, <span class="title class_">Array</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 图片数量限制</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">limit</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 大小限制(MB)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fileSize</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">       <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件类型, 例如[&#x27;png&#x27;, &#x27;jpg&#x27;, &#x27;jpeg&#x27;]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fileType</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="function">() =&gt;</span> [<span class="string">&quot;png&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 是否显示提示</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">isShowTip</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">number</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadList</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dialogImageUrl</span>: <span class="string">&quot;&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dialogVisible</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">hideUpload</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">baseUrl</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgUrl</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span> + <span class="string">&quot;/common/upload&quot;</span>, <span class="comment">// 上传的图片服务器地址</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">headers</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// Authorization: &quot;Bearer &quot; + getToken(),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fileList</span>: []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">watch</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">value</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">handler</span>(<span class="params">val</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (val) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 首先将值转为数组</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">const</span> list = <span class="title class_">Array</span>.<span class="title function_">isArray</span>(val) ? val : <span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 然后将数组转为对象数组</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">fileList</span> = list.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&quot;string&quot;</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="keyword">if</span> (item.<span class="title function_">indexOf</span>(<span class="variable language_">this</span>.<span class="property">baseUrl</span>) === -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                  item = &#123; <span class="attr">name</span>: <span class="variable language_">this</span>.<span class="property">baseUrl</span> + item, <span class="attr">url</span>: <span class="variable language_">this</span>.<span class="property">baseUrl</span> + item &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                  item = &#123; <span class="attr">name</span>: item, <span class="attr">url</span>: item &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> item;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">fileList</span> = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">deep</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">immediate</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 是否显示提示</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">showTip</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">isShowTip</span> &amp;&amp; (<span class="variable language_">this</span>.<span class="property">fileType</span> || <span class="variable language_">this</span>.<span class="property">fileSize</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 删除图片</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleRemove</span>(<span class="params">file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> findex = <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">map</span>(<span class="function"><span class="params">f</span> =&gt;</span> f.<span class="property">name</span>).<span class="title function_">indexOf</span>(file.<span class="property">name</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>(findex &gt; -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">splice</span>(findex, <span class="number">1</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;input&quot;</span>, <span class="variable language_">this</span>.<span class="title function_">listToString</span>(<span class="variable language_">this</span>.<span class="property">fileList</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传成功回调</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUploadSuccess</span>(<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">uploadList</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: res.<span class="property">data</span>.<span class="property">originalFileName</span>, <span class="attr">url</span>: res.<span class="property">data</span>.<span class="property">fileName</span> &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">uploadList</span>.<span class="property">length</span> === <span class="variable language_">this</span>.<span class="property">number</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">fileList</span> = <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">concat</span>(<span class="variable language_">this</span>.<span class="property">uploadList</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">uploadList</span> = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">number</span> = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;input&quot;</span>, <span class="variable language_">this</span>.<span class="title function_">listToString</span>(<span class="variable language_">this</span>.<span class="property">fileList</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">closeLoading</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传前loading加载</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleBeforeUpload</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> isImg = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fileType</span>.<span class="property">length</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> fileExtension = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          fileExtension = file.<span class="property">name</span>.<span class="title function_">slice</span>(file.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        isImg = <span class="variable language_">this</span>.<span class="property">fileType</span>.<span class="title function_">some</span>(<span class="function"><span class="params">type</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">if</span> (file.<span class="property">type</span>.<span class="title function_">indexOf</span>(type) &gt; -<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">if</span> (fileExtension &amp;&amp; fileExtension.<span class="title function_">indexOf</span>(type) &gt; -<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        isImg = file.<span class="property">type</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;image&quot;</span>) &gt; -<span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isImg) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`文件格式不正确, 请上传<span class="subst">$&#123;<span class="variable language_">this</span>.fileType.join(<span class="string">&quot;/&quot;</span>)&#125;</span>图片格式文件!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fileSize</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> isLt = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="variable language_">this</span>.<span class="property">fileSize</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (!isLt) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`上传头像图片大小不能超过 <span class="subst">$&#123;<span class="variable language_">this</span>.fileSize&#125;</span> MB!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">loading</span>(<span class="string">&quot;正在上传图片，请稍候...&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">number</span>++;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 文件个数超出</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleExceed</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">`上传文件数量不能超过 <span class="subst">$&#123;<span class="variable language_">this</span>.limit&#125;</span> 个!`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传失败</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleUploadError</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">msgError</span>(<span class="string">&quot;上传图片失败，请重试&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$modal</span>.<span class="title function_">closeLoading</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 预览</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handlePictureCardPreview</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">dialogImageUrl</span> = file.<span class="property">url</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 对象转成指定字符串分隔</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">listToString</span>(<span class="params">list, separator</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(list);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> strs = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      separator = separator || <span class="string">&quot;,&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> list) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        strs += list[i].<span class="property">url</span>.<span class="title function_">replace</span>(<span class="variable language_">this</span>.<span class="property">baseUrl</span>, <span class="string">&quot;&quot;</span>) + separator;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> strs != <span class="string">&#x27;&#x27;</span> ? strs.<span class="title function_">substr</span>(<span class="number">0</span>, strs.<span class="property">length</span> - <span class="number">1</span>) : <span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">// <span class="selector-class">.el-upload--picture-card</span> 控制加号部分</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.hide .el-upload--picture-card &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">// 去掉动画效果</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-enter-active,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-leave-active &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">transition</span>: all <span class="number">0s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep .el-list-enter, .el-list-leave-active &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出pdf文件（简单粗暴式）</title>
    <url>/2022/05/08/50%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BApdf%E6%96%B9%E5%BC%8F1/</url>
    <content><![CDATA[<h1 id="纯前端导出pdf文件（简单粗暴式）"><a href="#纯前端导出pdf文件（简单粗暴式）" class="headerlink" title="纯前端导出pdf文件（简单粗暴式）"></a>纯前端导出pdf文件（简单粗暴式）</h1><h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>第一个.将页面html转换成图片<br>npm install html2canvas –save<br>第二个.将图片生成pdf<br>npm install jspdf –save</p>
</blockquote>
<h2 id="步骤2：方法封装"><a href="#步骤2：方法封装" class="headerlink" title="步骤2：方法封装"></a>步骤2：方法封装</h2><blockquote>
<p>在utils创建htmlToPdfClick.js文件<br>下面完整代码可粘贴</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2Canvas <span class="keyword">from</span> <span class="string">&#x27;html2canvas&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JsPDF</span> <span class="keyword">from</span> <span class="string">&#x27;jspdf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPdfFromHtml</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="comment">// 可设置页边距，滚动有影响，需要设置滚动置顶</span></span><br><span class="line">  <span class="comment">// 能解决图片导出问题</span></span><br><span class="line">  ele = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;pdfDom&#x27;</span>)</span><br><span class="line">  pdfFileName = pdfFileName || <span class="string">&#x27;pdf&#x27;</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">pageYoffset</span> = <span class="number">0</span>; <span class="comment">// 滚动置顶</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// ele.style.fontFamily=&#x27;宋体&#x27;;</span></span><br><span class="line">  <span class="comment">// ele.style.padding=&#x27;30px&#x27;;</span></span><br><span class="line">  <span class="keyword">let</span> scale = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">2</span></span><br><span class="line">  <span class="title function_">html2Canvas</span>(ele, &#123;</span><br><span class="line">    <span class="comment">// dpi: 300,</span></span><br><span class="line">    <span class="attr">dpi</span>: <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> * <span class="number">4</span>, <span class="comment">//将分辨率提高到特定的DPI 提高四倍</span></span><br><span class="line">    <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">//按比例增加分辨率</span></span><br><span class="line">    <span class="attr">logging</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// scale:scale,</span></span><br><span class="line">    <span class="attr">useCORS</span>: <span class="literal">true</span>,<span class="comment">//允许canvas画布内可以跨域请求外部链接图片, 允许跨域请求。</span></span><br><span class="line">    <span class="attr">allowTaint</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">height</span>: ele.<span class="property">offsetHeight</span>, <span class="comment">// 导出的dom宽高</span></span><br><span class="line">    <span class="attr">width</span>: ele.<span class="property">offsetWidth</span>, <span class="comment">// 导出的dom宽高</span></span><br><span class="line">    <span class="attr">windowWidth</span>: <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollWidth</span>, <span class="comment">// 浏览器所有内容的宽高，不是弹框的</span></span><br><span class="line">    <span class="attr">windowHeight</span>: <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>, <span class="comment">// 浏览器所有内容的宽高，不是弹框的</span></span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&#x27;#fff&#x27;</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">canvas</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> _this = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="comment">// 未生成pdf的html页面高度</span></span><br><span class="line">    <span class="keyword">var</span> leftHeight = canvas.<span class="property">height</span> <span class="comment">// 即弹框里面所有内容</span></span><br><span class="line">    <span class="keyword">var</span> a4Width = <span class="number">592</span> <span class="comment">// 原A4宽 592 因为要设置边距 20 ,这里要减掉 40</span></span><br><span class="line">    <span class="keyword">var</span> a4Height = <span class="number">821</span> <span class="comment">// 原A4高   841 因为要设置边距 20 ,这里要减掉 40</span></span><br><span class="line">    <span class="comment">// 一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">    <span class="comment">//var a4HeightRef = 4450 // 即A4的内容</span></span><br><span class="line">    <span class="keyword">var</span> a4HeightRef = <span class="title class_">Math</span>.<span class="title function_">floor</span>(canvas.<span class="property">width</span> / a4Width * a4Height);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//pdf页面偏移</span></span><br><span class="line">    <span class="keyword">var</span> position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pageData = canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pdf = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;pt&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">1</span>,</span><br><span class="line">      canvas1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>),</span><br><span class="line">      height;</span><br><span class="line">    pdf.<span class="title function_">setDisplayMode</span>(<span class="string">&#x27;fullwidth&#x27;</span>, <span class="string">&#x27;continuous&#x27;</span>, <span class="string">&#x27;FullScreen&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">createImpl</span>(<span class="params">canvas</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        index++;</span><br><span class="line">        <span class="keyword">var</span> checkCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (leftHeight &gt; a4HeightRef) &#123;</span><br><span class="line">          <span class="keyword">var</span> i = position + a4HeightRef;</span><br><span class="line">          <span class="keyword">for</span> (i = position + a4HeightRef; i &gt;= position; i--) &#123;</span><br><span class="line">            <span class="keyword">var</span> isWrite = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; canvas.<span class="property">width</span>; j++) &#123;</span><br><span class="line">              <span class="keyword">var</span> c = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>).<span class="title function_">getImageData</span>(j, i, <span class="number">1</span>, <span class="number">1</span>).<span class="property">data</span></span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (c[<span class="number">0</span>] != <span class="number">0xff</span> || c[<span class="number">1</span>] != <span class="number">0xff</span> || c[<span class="number">2</span>] != <span class="number">0xff</span>) &#123;</span><br><span class="line">                isWrite = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (isWrite) &#123;</span><br><span class="line">              checkCount++</span><br><span class="line">              <span class="keyword">if</span> (checkCount &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              checkCount = <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          height = <span class="title class_">Math</span>.<span class="title function_">round</span>(i - position) || <span class="title class_">Math</span>.<span class="title function_">min</span>(leftHeight, a4HeightRef);</span><br><span class="line">          <span class="keyword">if</span> (height &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            height = a4HeightRef;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          height = leftHeight;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        canvas1.<span class="property">width</span> = canvas.<span class="property">width</span>;</span><br><span class="line">        canvas1.<span class="property">height</span> = height;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// console.log(index, &#x27;height:&#x27;, height, &#x27;pos&#x27;, position);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> ctx = canvas1.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">        ctx.<span class="title function_">drawImage</span>(canvas, <span class="number">0</span>, position, canvas.<span class="property">width</span>, height, <span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, height); <span class="comment">// 边距这里设置0，不然又黑边</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> pageHeight = <span class="title class_">Math</span>.<span class="title function_">round</span>(a4Width / canvas.<span class="property">width</span> * height);</span><br><span class="line">        <span class="comment">// pdf.setPageSize(null, pageHeight)</span></span><br><span class="line">        <span class="keyword">if</span> (position != <span class="number">0</span>) &#123;</span><br><span class="line">          pdf.<span class="title function_">addPage</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 设置 20px 边距</span></span><br><span class="line">        pdf.<span class="title function_">addImage</span>(canvas1.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>), <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">20</span>, <span class="number">20</span>, a4Width, a4Width / canvas1.<span class="property">width</span> * height);</span><br><span class="line">        leftHeight -= height;</span><br><span class="line">        position += height;</span><br><span class="line">        <span class="comment">// $(&#x27;.pdfProgress&#x27;).text(index + 1);</span></span><br><span class="line">        <span class="comment">// $(&#x27;.pdfTotal&#x27;).text(index + Math.ceil(leftHeight / a4HeightRef));</span></span><br><span class="line">        <span class="keyword">if</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">//添加全屏水印</span></span><br><span class="line">          <span class="keyword">const</span> base64 = <span class="string">&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAArCAYAAADIWo5HAAACLUlEQVR42u2Zy2sCMRDGV9tbtVJKrQ/0JBWLvbgsaOttQQqreO5R6GHP/v+HZiEDQ9i8k33YDHyXbcxufpN8maRRFCJEiBAhQoTgRIfoh+hKNBe0G9I2GVG3om9bEl2I9rcIoE/77Cq8Myd6sn2ZSBgAr80YARhI+gOwCdGW6EB/d6R9XDUGFrsAf2Fe7Fswk1JBmzMd1DNKgI2EywQyUKYjkxFeOwwxkwgAvBJNqEa0DzaTHcn3qWrXdA/ocQD8m11ABUDfQF0fpujjI2QAeoZetdYdfOzB9HgGNEF6owM8Ec3Q8wEDgP07T6ktgNyB8YgAqGZ0b+gRsS2AtQP/iAUAHlAdsEW7TY6eFVrVNQN8A2AjlZho5R5wYjJhoqMiADy4DFWLPJMcKBhv3AYThFi4yJyrAAAfDrY/1SVQVhLDOWDowIwzSQ1TqwfA1P5CU3yJlsPY8fmjcTMgptmeIwB3aFbsLCvM2BRAFR4AZXYxuEdmn38hmjoosY0B5IonxLNhIYTNby0odMoAJJL1/k10bwpgQztZKaxb2YXFRnAUhexDHzoAUsGxu3j+awNA5+RmcxW1UCx1eQB4SyI1AaBrbiMEYGrwexgYBlgrgGtU/ZUY3AlGhgByTvV5MQGgW1SomqBOUWLiATy1wgNsABQz51PzWHxTALzWAW0F0EM+MKPmnLj6x0lbAPDuC5zfNPsCcChZ25DZd4VBJCW7wrRp1+whQoQIESJEg+IPRa38G55TPkQAAAAASUVORK5CYII=&#x27;</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">              <span class="keyword">const</span> left = (j * <span class="number">120</span>) + <span class="number">20</span>;</span><br><span class="line">              <span class="comment">// pdf.addImage(base64,&#x27;JPEG&#x27;, left, i*150, 20, 30); // 关掉水印</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="built_in">setTimeout</span>(createImpl, <span class="number">500</span>, canvas);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          pdf.<span class="title function_">save</span>(pdfFileName + <span class="string">&#x27;.pdf&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当内容未超过pdf一页显示的范围，无需分页</span></span><br><span class="line">    <span class="keyword">if</span> (leftHeight &lt; a4HeightRef) &#123;</span><br><span class="line">      pdf.<span class="title function_">addImage</span>(pageData, <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">20</span>, <span class="number">20</span>, a4Width, a4Width / canvas.<span class="property">width</span> * leftHeight);</span><br><span class="line">      pdf.<span class="title function_">save</span>(pdfFileName + <span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        pdf.<span class="title function_">deletePage</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">setTimeout</span>(createImpl, <span class="number">500</span>, canvas);</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：给要导出的盒子标签添加id"><a href="#步骤3：给要导出的盒子标签添加id" class="headerlink" title="步骤3：给要导出的盒子标签添加id"></a>步骤3：给要导出的盒子标签添加id</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：引用方法并使用"><a href="#步骤4：引用方法并使用" class="headerlink" title="步骤4：引用方法并使用"></a>步骤4：引用方法并使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> &#123;getPdfFromHtml&#125; <span class="keyword">from</span> <span class="string">&#x27;../../utils/htmlToPdfClick&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出pdf按钮点击方法</span></span><br><span class="line"><span class="title function_">getPdfClick</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="title function_">getPdfFromHtml</span>()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>视频上传封装组件使用</title>
    <url>/2022/06/08/52%E5%89%8D%E7%AB%AF%E5%B0%81%E8%A3%85%E8%A7%86%E9%A2%91%E4%B8%8A%E4%BC%A0%20/</url>
    <content><![CDATA[<h1 id="视频上传封装组件使用"><a href="#视频上传封装组件使用" class="headerlink" title="视频上传封装组件使用"></a>视频上传封装组件使用</h1><h2 id="步骤1：使用实例"><a href="#步骤1：使用实例" class="headerlink" title="步骤1：使用实例"></a>步骤1：使用实例</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Albumvideo v-else @sendData=&quot;sendData&quot; :isShow=&quot;form.carouselImage&quot;&gt;&lt;/Albumvideo&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：组件完整代码"><a href="#步骤2：组件完整代码" class="headerlink" title="步骤2：组件完整代码"></a>步骤2：组件完整代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editPage__video&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img__con&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span> <span class="attr">:action</span>=<span class="string">&quot;uploadImgUrl&quot;</span> <span class="attr">:data</span>=<span class="string">&quot;uploadImgData&quot;</span> <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">:on-success</span>=<span class="string">&quot;handleAvatarSuccess&quot;</span> <span class="attr">:before-upload</span>=<span class="string">&quot;beforeAvatarUpload&quot;</span> <span class="attr">:on-progress</span>=<span class="string">&quot;uploadVideoProcess&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">video</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">controls</span>=<span class="string">&quot;controls&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;menuKey&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">source</span> <span class="attr">:src</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/mp4&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="comment">&lt;!-- &lt;img v-if=&quot;imageUrl&quot; :src=&quot;imageUrl&quot; class=&quot;avatar&quot; /&gt; --&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus avatar-uploader-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-progress</span> <span class="attr">v-if</span>=<span class="string">&quot;videoFlag == true&quot;</span> <span class="attr">type</span>=<span class="string">&quot;line&quot;</span> <span class="attr">:percentage</span>=<span class="string">&quot;videoUploadPercent&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&quot;margin-top: 30px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-progress</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        说明: 视频格式为 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; &#x27;mp4&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span>格式，每个视频大小不超过 <span class="tag">&lt;<span class="name">b</span> <span class="attr">style</span>=<span class="string">&quot;color: #f56c6c&quot;</span>&gt;</span>&#123;&#123; &#x27;300m&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">isShow</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">imageUrl</span>: <span class="string">&#x27;&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 视频上传</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgUrl</span>: <span class="string">`<span class="subst">$&#123;process.env.VUE_APP_BASE_API&#125;</span>/common/upload`</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">uploadImgData</span>: &#123; <span class="attr">busiName</span>: <span class="number">32</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 应付多个组件的情况 记录当前组件的key值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">componentKey</span>: <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">menuKey</span>: <span class="number">1</span>, <span class="comment">// 用来强制刷新</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">videoFlag</span>: <span class="literal">false</span>,  <span class="comment">// 进度条相关的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">videoUploadPercent</span>: <span class="number">0</span>,  <span class="comment">// 进度条相关的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="property">imageUrl</span> = <span class="variable language_">this</span>.<span class="property">isShow</span> ? <span class="variable language_">this</span>.<span class="property">isShow</span> : <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">watch</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">isShow</span>(<span class="params">val</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(val);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">imageUrl</span> = val ? val : <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 上传成功的函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleAvatarSuccess</span>(<span class="params">res, file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 进度条恢复到初始状态</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoFlag</span> = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoUploadPercent</span> = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      ++<span class="variable language_">this</span>.<span class="property">menuKey</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">imageUrl</span> = res.<span class="property">data</span>.<span class="property">url</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (res.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="title function_">sendData</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 这里是向父级传值，不需要就去掉</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// this.$emit(&quot;childRightFn&quot;, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...this.rightData,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...&#123; imageUrl: this.imageUrl &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   ...&#123; props: &#123; src: this.imageUrl &#125; &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">sendData</span>(<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;sendData&#x27;</span>, data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">beforeAvatarUpload</span>(<span class="params">file</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   file.type === &quot;image/jpg&quot; ||</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//   file.type === &quot;image/png&quot;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isMp4 = file.<span class="property">type</span> === <span class="string">&quot;video/mp4&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 限制文件最大不能超过 300M</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> isLt2M = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">300</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isMp4) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;视频只能是mp4格式!&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!isLt2M) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;上传头像图片大小不能超过 300MB!&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="title function_">sendData</span>(<span class="literal">false</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> isMp4 &amp;&amp; isLt2M;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//进度条</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">uploadVideoProcess</span>(<span class="params">event, file, fileList</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoFlag</span> = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">videoUploadPercent</span> = <span class="built_in">parseInt</span>(file.<span class="property">percentage</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">::v-deep.editPage__video &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-tag">video</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">line-height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#d9d9d9</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">cursor</span>: pointer;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">position</span>: relative;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">overflow</span>: hidden;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">border-color</span>: <span class="number">#409eff</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar-uploader-icon</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: <span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">text-align</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.avatar</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>: <span class="number">350px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>: auto;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">display</span>: block;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.title</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="selector-class">.img__con</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.el-button</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span> <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>上传</tag>
      </tags>
  </entry>
  <entry>
    <title>页面闪了一下的样式问题</title>
    <url>/2022/06/20/53%E9%A1%B5%E9%9D%A2%E9%97%AA%E4%BA%86%E4%B8%80%E4%B8%8B%E7%9A%84%E6%A0%B7%E5%BC%8F%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="页面闪了一下的样式问题"><a href="#页面闪了一下的样式问题" class="headerlink" title="页面闪了一下的样式问题"></a>页面闪了一下的样式问题</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//当样式闪一下是设置<span class="selector-tag">body</span>样式</span><br><span class="line">// 在<span class="selector-tag">body</span>标签样式下添加</span><br><span class="line">overflover：hidden</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>纯前端导出pdf文件（多个class导出）</title>
    <url>/2022/05/28/51%E7%BA%AF%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BApdf%E6%96%B9%E5%BC%8F2/</url>
    <content><![CDATA[<h1 id="纯前端导出pdf文件（多个class导出）"><a href="#纯前端导出pdf文件（多个class导出）" class="headerlink" title="纯前端导出pdf文件（多个class导出）"></a>纯前端导出pdf文件（多个class导出）</h1><blockquote>
<p>注：<br>1：当页面缩放时，下载pdf字体跟样式变小，可以用两个dom，应该定位最上面展示，另外一个真正下载的写死宽度<br>2：当发现断层时，你可以根据内容高度修改class标签内包含的内容（动动你的小脑袋，你是最聪明的！！！）</p>
</blockquote>
<h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>第一个.将页面html转换成图片<br>npm install html2canvas –save<br>第二个.将图片生成pdf<br>npm install jspdf –save</p>
</blockquote>
<h2 id="步骤2：方法封装"><a href="#步骤2：方法封装" class="headerlink" title="步骤2：方法封装"></a>步骤2：方法封装</h2><blockquote>
<p>在utils创建htmlToPdfClick.js文件<br>下面完整代码可粘贴</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2Canvas <span class="keyword">from</span> <span class="string">&#x27;html2canvas&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JsPDF</span> <span class="keyword">from</span> <span class="string">&#x27;jspdf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPdfFromHtml</span>(<span class="params">ele, pdfFileName</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">`.<span class="subst">$&#123;ele&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">PDF</span> = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;pt&quot;</span>, <span class="string">&quot;a4&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> pageArr = [];</span><br><span class="line">  <span class="keyword">const</span> opts = &#123;</span><br><span class="line">    <span class="attr">scale</span>: <span class="number">4</span>, <span class="comment">// 缩放比例，提高生成图片清晰度</span></span><br><span class="line">    <span class="attr">useCORS</span>: <span class="literal">true</span>, <span class="comment">// 允许加载跨域的图片</span></span><br><span class="line">    <span class="attr">allowTaint</span>: <span class="literal">false</span>, <span class="comment">// 允许图片跨域，和 useCORS 二者不可共同使用</span></span><br><span class="line">    <span class="attr">tainttest</span>: <span class="literal">true</span>, <span class="comment">// 检测每张图片已经加载完成</span></span><br><span class="line">    <span class="attr">logging</span>: <span class="literal">true</span>, <span class="comment">// 日志开关，发布的时候记得改成 false</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> index <span class="keyword">in</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(element)) &#123;</span><br><span class="line">    <span class="title function_">html2Canvas</span>(element[index], opts).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高</span></span><br><span class="line">      <span class="keyword">const</span> contentWidth = canvas.<span class="property">width</span>;</span><br><span class="line">      <span class="keyword">const</span> contentHeight = canvas.<span class="property">height</span>;</span><br><span class="line">      <span class="keyword">const</span> imgWidth = <span class="number">595.28</span>;</span><br><span class="line">      <span class="keyword">const</span> imgHeight = (<span class="number">592.28</span> / contentWidth) * contentHeight;</span><br><span class="line">      <span class="keyword">const</span> pageData = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/jpeg&quot;</span>, <span class="number">1.0</span>);</span><br><span class="line">      <span class="comment">// 一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">      <span class="keyword">const</span> pageHeight = (contentWidth / <span class="number">592.28</span>) * <span class="number">841.89</span>;</span><br><span class="line">      <span class="comment">// 未生成pdf的html页面高度</span></span><br><span class="line">      <span class="keyword">const</span> leftHeight = contentHeight;</span><br><span class="line">      pageArr[index] = &#123;</span><br><span class="line">        <span class="attr">pageData</span>: pageData,</span><br><span class="line">        <span class="attr">pageHeight</span>: pageHeight,</span><br><span class="line">        <span class="attr">leftHeight</span>: leftHeight,</span><br><span class="line">        <span class="attr">imgWidth</span>: imgWidth,</span><br><span class="line">        <span class="attr">imgHeight</span>: imgHeight,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">if</span> (++count === element.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// 转换完毕，可进行下一步处理 pageDataArr</span></span><br><span class="line">        <span class="keyword">let</span> counts = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> data <span class="keyword">of</span> pageArr) &#123;</span><br><span class="line">          <span class="comment">// 页面偏移</span></span><br><span class="line">          <span class="keyword">let</span> position = <span class="number">0</span>;</span><br><span class="line">          <span class="comment">// 转换完毕，save保存名称后浏览器会自动下载</span></span><br><span class="line">          <span class="comment">// 当内容未超过pdf一页显示的范围，无需分页</span></span><br><span class="line">          <span class="keyword">if</span> (data.<span class="property">leftHeight</span> &lt; data.<span class="property">pageHeight</span>) &#123;</span><br><span class="line">            <span class="comment">// addImage(pageData, &#x27;JPEG&#x27;, 左，上，宽度，高度)设置</span></span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">addImage</span>(</span><br><span class="line">              data.<span class="property">pageData</span>,</span><br><span class="line">              <span class="string">&quot;JPEG&quot;</span>,</span><br><span class="line">              <span class="number">0</span>,</span><br><span class="line">              <span class="number">0</span>,</span><br><span class="line">              data.<span class="property">imgWidth</span>,</span><br><span class="line">              data.<span class="property">imgHeight</span></span><br><span class="line">            );</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 超过一页时，分页打印（每页高度841.89）</span></span><br><span class="line">            <span class="keyword">while</span> (data.<span class="property">leftHeight</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="variable constant_">PDF</span>.<span class="title function_">addImage</span>(</span><br><span class="line">                data.<span class="property">pageData</span>,</span><br><span class="line">                <span class="string">&quot;JPEG&quot;</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                position,</span><br><span class="line">                data.<span class="property">imgWidth</span>,</span><br><span class="line">                data.<span class="property">imgHeight</span></span><br><span class="line">              );</span><br><span class="line">              data.<span class="property">leftHeight</span> -= data.<span class="property">pageHeight</span>;</span><br><span class="line">              position -= <span class="number">841.89</span>;</span><br><span class="line">              <span class="keyword">if</span> (data.<span class="property">leftHeight</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable constant_">PDF</span>.<span class="title function_">addPage</span>();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (++counts === pageArr.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">save</span>(pdfFileName + <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 未转换到最后一页时，pdf增加一页</span></span><br><span class="line">            <span class="variable constant_">PDF</span>.<span class="title function_">addPage</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：给要导出的盒子标签添加id"><a href="#步骤3：给要导出的盒子标签添加id" class="headerlink" title="步骤3：给要导出的盒子标签添加id"></a>步骤3：给要导出的盒子标签添加id</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;app-container&quot; id=&quot;pdfDom&quot;&gt;</span><br><span class="line">  ... //省略代码</span><br><span class="line">  &lt;el-button size=&quot;mini&quot; @click=&quot;getPdfClick&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤4：引用方法并使用"><a href="#步骤4：引用方法并使用" class="headerlink" title="步骤4：引用方法并使用"></a>步骤4：引用方法并使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> &#123;getPdfFromHtml&#125; <span class="keyword">from</span> <span class="string">&#x27;../../utils/htmlToPdfClick&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出pdf按钮点击方法</span></span><br><span class="line"><span class="title function_">getPdfClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">getPdfFromHtml</span>(<span class="string">&#x27;app-container&#x27;</span>,<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>导出</tag>
      </tags>
  </entry>
  <entry>
    <title>echarts饼图自定义中间字体展示</title>
    <url>/2022/07/25/55echarts%E9%A5%BC%E5%9B%BE%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E5%AD%97%E4%BD%93%E5%B1%95%E7%A4%BA/</url>
    <content><![CDATA[<h1 id="echarts饼图自定义中间字体展示"><a href="#echarts饼图自定义中间字体展示" class="headerlink" title="echarts饼图自定义中间字体展示"></a>echarts饼图自定义中间字体展示</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>项目首页的某饼图中间需要展示一个总数<br>实现方法可以在series中添加多一个对象，根据下层展示中间字段，上层不展示中间字段</p>
</blockquote>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;echarts&quot; :id=&quot;echartsId&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import * as echarts from &#x27;echarts&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    echartsId: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      // 饼图数据</span><br><span class="line">      data: [</span><br><span class="line">        &#123; value: 1048, name: &#x27;Search Engine&#x27; &#125;,</span><br><span class="line">        &#123; value: 735, name: &#x27;Direct&#x27; &#125;,</span><br><span class="line">        &#123; value: 580, name: &#x27;Email&#x27; &#125;,</span><br><span class="line">        &#123; value: 484, name: &#x27;Union Ads&#x27; &#125;,</span><br><span class="line">        &#123; value: 300, name: &#x27;Video Ads&#x27; &#125;</span><br><span class="line">      ],</span><br><span class="line">      // 自定义颜色</span><br><span class="line">      colorList: [</span><br><span class="line">        &quot;#FA8C09&quot;,</span><br><span class="line">        &quot;#FCDA15&quot;,</span><br><span class="line">        &quot;#006CFF&quot;,</span><br><span class="line">        &quot;#2bb172&quot;,</span><br><span class="line">        &quot;#EF2D2D&quot;,</span><br><span class="line">        &quot;#0BD4D1&quot;,</span><br><span class="line">        &quot;#5D2FF4&quot;,</span><br><span class="line">        &quot;#f3afb6&quot;,</span><br><span class="line">        &quot;#b3167c&quot;,</span><br><span class="line">        &quot;#b45454&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.initEcharts()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    initEcharts() &#123;</span><br><span class="line">      var chartDom = document.getElementById(this.echartsId);</span><br><span class="line">      var myChart = echarts.init(chartDom);</span><br><span class="line">      var option;</span><br><span class="line"></span><br><span class="line">      option = &#123;</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          trigger: &#x27;item&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">          top: &#x27;5%&#x27;,</span><br><span class="line">          left: &#x27;center&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            type: &quot;pie&quot;,</span><br><span class="line">            radius: [&quot;58%&quot;, &quot;78%&quot;],</span><br><span class="line">            color: this.colorList,</span><br><span class="line">            minAngle: 2,</span><br><span class="line">            startAngle: 20,</span><br><span class="line">            // center: [&quot;25%&quot;, &quot;50%&quot;],</span><br><span class="line">            avoidLabelOverlap: false,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderColor: &quot;#fff&quot;,</span><br><span class="line">              borderWidth: 3</span><br><span class="line">            &#125;,</span><br><span class="line">            label: &#123;</span><br><span class="line">              formatter: e =&gt; &#123;</span><br><span class="line">                if (!e.name) return &quot;&quot;;</span><br><span class="line">                if (e.name.length &gt; 4) &#123;</span><br><span class="line">                  e.name = e.name.slice(0, 4) + &quot;...&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                return e.name;</span><br><span class="line">              &#125;,</span><br><span class="line">              bleedMargin: 5</span><br><span class="line">            &#125;,</span><br><span class="line">            labelLine: &#123;</span><br><span class="line">              show: true,</span><br><span class="line">              length: 8,</span><br><span class="line">              length2: 10,</span><br><span class="line">              smooth: 0.4</span><br><span class="line">            &#125;,</span><br><span class="line">            data: JSON.parse(JSON.stringify(this.data))</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            color: this.colorList,</span><br><span class="line">            type: &quot;pie&quot;,</span><br><span class="line">            radius: [&quot;58%&quot;, &quot;78%&quot;],</span><br><span class="line">            minAngle: 2,</span><br><span class="line">            startAngle: 20,</span><br><span class="line">            // center: [&quot;25%&quot;, &quot;50%&quot;],</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderColor: &quot;#fff&quot;,</span><br><span class="line">              borderWidth: 3</span><br><span class="line">            &#125;,</span><br><span class="line">            label: &#123;</span><br><span class="line">              show: true,</span><br><span class="line">              position: &quot;center&quot;,</span><br><span class="line">              formatter: 100 + &#x27;\n\r&#x27; + &#x27;&#123;total|总数&#125;&#x27;,//自定义饼图中间字体</span><br><span class="line">              rich: &#123;</span><br><span class="line">                // 中间字体样式</span><br><span class="line">                total: &#123;</span><br><span class="line">                  fontSize: 16,</span><br><span class="line">                  // color: &#x27;#000&#x27;,</span><br><span class="line">                  fontWeight: 400</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              //自定义中间文字样式</span><br><span class="line">              //rich使用配置过滤样式</span><br><span class="line">            &#125;,</span><br><span class="line">            labelLine: &#123;</span><br><span class="line">              show: false</span><br><span class="line">            &#125;,</span><br><span class="line">            data: JSON.parse(JSON.stringify(this.data))</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      option &amp;&amp; myChart.setOption(option);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>echarts</tag>
      </tags>
  </entry>
  <entry>
    <title>echarts饼图实现自动轮播</title>
    <url>/2022/07/17/54echarts%E9%A5%BC%E5%9B%BE%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E8%BD%AE%E6%92%AD/</url>
    <content><![CDATA[<h1 id="echarts饼图实现自动轮播"><a href="#echarts饼图实现自动轮播" class="headerlink" title="echarts饼图实现自动轮播"></a>echarts饼图实现自动轮播</h1><h2 id="废话不多说，完整代码整上"><a href="#废话不多说，完整代码整上" class="headerlink" title="废话不多说，完整代码整上"></a>废话不多说，完整代码整上</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;echarts&quot; :id=&quot;echartsId&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import * as echarts from &#x27;echarts&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    echartsId: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.initEcharts()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    initEcharts() &#123;</span><br><span class="line">      var chartDom = document.getElementById(this.echartsId);</span><br><span class="line">      var myChart = echarts.init(chartDom);</span><br><span class="line">      var option;</span><br><span class="line"></span><br><span class="line">      option = &#123;</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          trigger: &#x27;item&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">          top: &#x27;5%&#x27;,</span><br><span class="line">          left: &#x27;center&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            name: &#x27;Access From&#x27;,</span><br><span class="line">            type: &#x27;pie&#x27;,</span><br><span class="line">            radius: [&#x27;40%&#x27;, &#x27;70%&#x27;], // 通过设置内径与外径将饼图变为圆环饼图</span><br><span class="line">            avoidLabelOverlap: false,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderRadius: [8,8,8,8],// 设置圆环的圆角弧度</span><br><span class="line">              borderColor: &#x27;#fff&#x27;,</span><br><span class="line">              borderWidth: 2</span><br><span class="line">            &#125;,</span><br><span class="line">            label: &#123; // 设置图形标签样式</span><br><span class="line">              show: false, // 未高亮时不显示标签，否则高亮时显示的标签会与静态的标签重叠</span><br><span class="line">              position: &#x27;center&#x27;,</span><br><span class="line">              // 设置标签展示内容,其中&#123;d&#125;、&#123;b&#125;为echarts标签内容格式器</span><br><span class="line">              formatter: &#x27;&#123;d_style|&#123;d&#125;&#125;&#123;per_style|%&#125;\n&#123;b_style|&#123;b&#125;&#125;&#x27;,</span><br><span class="line">              // 为标签内容指定样式，只能设置series-pie.label支持的样式</span><br><span class="line">              rich: &#123;</span><br><span class="line">                d_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;,</span><br><span class="line">                per_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;,</span><br><span class="line">                b_style: &#123;</span><br><span class="line">                  fontSize: 28</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            emphasis: &#123; // 设置高亮时显示标签</span><br><span class="line">              label: &#123;</span><br><span class="line">                show: true</span><br><span class="line">              &#125;,</span><br><span class="line">              scale: true, // 设置高亮时放大图形</span><br><span class="line">              scaleSize: 20</span><br><span class="line">            &#125;,</span><br><span class="line">            data: [ // 饼图数据</span><br><span class="line">              &#123; value: 1048, name: &#x27;Search Engine&#x27; &#125;,</span><br><span class="line">              &#123; value: 735, name: &#x27;Direct&#x27; &#125;,</span><br><span class="line">              &#123; value: 580, name: &#x27;Email&#x27; &#125;,</span><br><span class="line">              &#123; value: 484, name: &#x27;Union Ads&#x27; &#125;,</span><br><span class="line">              &#123; value: 300, name: &#x27;Video Ads&#x27; &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      // 下面是自动轮播的处理函数----------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">      let currentIndex = -1; // 当前高亮图形在饼图数据中的下标</span><br><span class="line">      let changePieInterval = setInterval(selectPie, 1000); // 设置自动切换高亮图形的定时器</span><br><span class="line"></span><br><span class="line">      function highlightPie() &#123; // 取消所有高亮并高亮当前图形</span><br><span class="line">        for (var idx in option.series[0].data)</span><br><span class="line">          // 遍历饼图数据，取消所有图形的高亮效果</span><br><span class="line">          myChart.dispatchAction(&#123;</span><br><span class="line">            type: &#x27;downplay&#x27;,</span><br><span class="line">            seriesIndex: 0,</span><br><span class="line">            dataIndex: idx</span><br><span class="line">          &#125;);</span><br><span class="line">        // 高亮当前图形</span><br><span class="line">        myChart.dispatchAction(&#123;</span><br><span class="line">          type: &#x27;highlight&#x27;,</span><br><span class="line">          seriesIndex: 0,</span><br><span class="line">          dataIndex: currentIndex</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      myChart.on(&#x27;mouseover&#x27;, (params) =&gt; &#123; // 用户鼠标悬浮到某一图形时，停止自动切换并高亮鼠标悬浮的图形</span><br><span class="line">        clearInterval(changePieInterval);</span><br><span class="line">        currentIndex = params.dataIndex;</span><br><span class="line">        highlightPie();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      myChart.on(&#x27;mouseout&#x27;, (params) =&gt; &#123; // 用户鼠标移出时，重新开始自动切换</span><br><span class="line">        if (changePieInterval)</span><br><span class="line">          clearInterval(changePieInterval);</span><br><span class="line">        changePieInterval = setInterval(selectPie, 1000);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      function selectPie() &#123; // 高亮效果切换到下一个图形</span><br><span class="line">        var dataLen = option.series[0].data.length;</span><br><span class="line">        currentIndex = (currentIndex + 1) % dataLen;</span><br><span class="line">        highlightPie();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      option &amp;&amp; myChart.setOption(option);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>echarts</tag>
      </tags>
  </entry>
  <entry>
    <title>引用同一个echarts组件时需要动态传id</title>
    <url>/2022/08/12/56%E5%BC%95%E7%94%A8%E5%90%8C%E4%B8%80%E4%B8%AAecharts%E7%BB%84%E4%BB%B6%E6%97%B6%E9%9C%80%E8%A6%81%E5%8A%A8%E6%80%81%E4%BC%A0id/</url>
    <content><![CDATA[<h1 id="引用同一个echarts组件时需要动态传id"><a href="#引用同一个echarts组件时需要动态传id" class="headerlink" title="引用同一个echarts组件时需要动态传id"></a>引用同一个echarts组件时需要动态传id</h1><h2 id="当你封装好一个echarts组件时，需要动态绑定不同id，否则会出现冲突-x2F-会展示上个使用该组件的数据"><a href="#当你封装好一个echarts组件时，需要动态绑定不同id，否则会出现冲突-x2F-会展示上个使用该组件的数据" class="headerlink" title="当你封装好一个echarts组件时，需要动态绑定不同id，否则会出现冲突&#x2F;会展示上个使用该组件的数据"></a>当你封装好一个echarts组件时，需要动态绑定不同id，否则会出现冲突&#x2F;会展示上个使用该组件的数据</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 动态绑定id --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;echarts&quot; :id=&quot;echartsId&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 接收id --&gt;</span><br><span class="line">props: &#123;</span><br><span class="line">    echartsId: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 通过id获取组件 --&gt;</span><br><span class="line">var chartDom = document.getElementById(this.echartsId);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>echarts</tag>
      </tags>
  </entry>
  <entry>
    <title>处理echarts组件放大超出父盒子宽度问题</title>
    <url>/2022/08/18/57%E5%A4%84%E7%90%86echarts%E7%BB%84%E4%BB%B6%E6%94%BE%E5%A4%A7%E8%B6%85%E5%87%BA%E7%88%B6%E7%9B%92%E5%AD%90%E5%AE%BD%E5%BA%A6%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="处理echarts组件放大超出父盒子宽度问题"><a href="#处理echarts组件放大超出父盒子宽度问题" class="headerlink" title="处理echarts组件放大超出父盒子宽度问题"></a>处理echarts组件放大超出父盒子宽度问题</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 需要在mounted() &#123;&#125;中调用下面代码</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 解决echarts图表放大溢出父容器</span></span><br><span class="line">      <span class="keyword">const</span> resizeOb = <span class="keyword">new</span> <span class="title class_">ResizeObserver</span>(<span class="function">(<span class="params">entries</span>) =&gt;</span> &#123;<span class="comment">//监听元素大小的变化</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> entries) &#123;</span><br><span class="line">          echarts.<span class="title function_">getInstanceByDom</span>(entry.<span class="property">target</span>).<span class="title function_">resize</span>()<span class="comment">//大小变为容器初始化</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      resizeOb.<span class="title function_">observe</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="variable language_">this</span>.<span class="property">id</span>))<span class="comment">//创建echarts盒子的id</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>echarts</tag>
      </tags>
  </entry>
  <entry>
    <title>后端返回的数据，换行和空格问题</title>
    <url>/2022/09/05/59%E5%90%8E%E7%AB%AF%E8%BF%94%E5%9B%9E%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%8D%A2%E8%A1%8C%E5%92%8C%E7%A9%BA%E6%A0%BC%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="后端返回的数据，换行和空格问题"><a href="#后端返回的数据，换行和空格问题" class="headerlink" title="后端返回的数据，换行和空格问题"></a>后端返回的数据，换行和空格问题</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;<span class="selector-tag">p</span> v-else style=&quot;<span class="attribute">white-space</span>: pre-wrap;<span class="attribute">font-family</span>: <span class="string">&#x27;宋体&#x27;</span><span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">            &#123;&#123; journalList[0] &#125;&#125;</span></span><br><span class="line"><span class="string">          &lt;/p&gt;</span></span><br><span class="line"><span class="string">//white-space: pre-wrap;换行且保留空格</span></span><br><span class="line"><span class="string">//font-family: &#x27;宋体&#x27;（不同字体空格字符间隙不一样）</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>修改router的query参数</title>
    <url>/2022/09/04/58%E4%BF%AE%E6%94%B9router%E7%9A%84query%E5%8F%82%E6%95%B0/</url>
    <content><![CDATA[<h1 id="修改router的query参数"><a href="#修改router的query参数" class="headerlink" title="修改router的query参数"></a>修改router的query参数</h1><p>1、安装npm 依赖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i webpack-merge</span><br></pre></td></tr></table></figure>

<p>2、写入代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> merge <span class="keyword">from</span> <span class="string">&#x27;webpack-merge&#x27;</span>；</span><br></pre></td></tr></table></figure>

<p>3、修改原有参数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">query</span>:<span class="title function_">merge</span>(<span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">query</span>,&#123;<span class="string">&#x27;maxPrice&#x27;</span>:<span class="string">&#x27;630&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>4、新增一个参数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">query</span>:<span class="title function_">merge</span>(<span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">query</span>,&#123;<span class="string">&#x27;addParams&#x27;</span>:<span class="string">&#x27;我是新增的一个参数，哈哈哈哈&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>5、替换所有参数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">query</span>:<span class="title function_">merge</span>(&#123;&#125;,&#123;<span class="string">&#x27;maxPrice&#x27;</span>:<span class="string">&#x27;630&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>router</tag>
      </tags>
  </entry>
  <entry>
    <title>处理时间数据顺序没有排序问题</title>
    <url>/2022/10/08/61%E5%A4%84%E7%90%86%E6%97%B6%E9%97%B4%E6%95%B0%E6%8D%AE%E9%A1%BA%E5%BA%8F%E6%B2%A1%E6%9C%89%E5%A4%84%E7%90%86%E6%8E%92%E5%BA%8F%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="处理时间数据顺序没有排序问题"><a href="#处理时间数据顺序没有排序问题" class="headerlink" title="处理时间数据顺序没有排序问题"></a>处理时间数据顺序没有排序问题</h1><h2 id="在做一个echarts柱状图时，后端返回的时间数据没有排序，需要重新排序展示数据"><a href="#在做一个echarts柱状图时，后端返回的时间数据没有排序，需要重新排序展示数据" class="headerlink" title="在做一个echarts柱状图时，后端返回的时间数据没有排序，需要重新排序展示数据"></a>在做一个echarts柱状图时，后端返回的时间数据没有排序，需要重新排序展示数据</h2><blockquote>
<p>数据展示</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 当时后端返回的时间数据如下，并没有排序</span></span><br><span class="line"><span class="keyword">let</span> month = &#123;</span><br><span class="line">  <span class="string">&#x27;2022.9.21&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&#x27;2022.9.22&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&#x27;2022.9.25&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&#x27;2022.9.23&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&#x27;2022.9.24&#x27;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新修改柱状图需要的数据结构</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> month) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">xyArr</span>.<span class="title function_">push</span>(&#123; <span class="attr">time</span>: key, <span class="attr">value</span>: month[key] &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据排序通过sort()和new Date()方法</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">xyArr</span>.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(a.<span class="property">time</span>) &gt; <span class="keyword">new</span> <span class="title class_">Date</span>(b.<span class="property">time</span>) ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">xyArr</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>数据类型的正则校验</title>
    <url>/2022/09/25/60%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%AD%A3%E5%88%99%E6%A0%A1%E9%AA%8C/</url>
    <content><![CDATA[<h1 id="数据类型的正则校验"><a href="#数据类型的正则校验" class="headerlink" title="数据类型的正则校验"></a>数据类型的正则校验</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 检查常量值</span></span><br><span class="line">      checkValueString (rule, value, callback) &#123;</span><br><span class="line">        <span class="keyword">let</span> patter = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">addForm</span>.<span class="property">valueType</span>) &#123;</span><br><span class="line">          <span class="comment">// 整数</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            patter = <span class="regexp">/^-?[0-9]\d*$/</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="comment">// 浮点数</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            patter = <span class="regexp">/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="comment">// 长整型</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            patter = <span class="regexp">/^-?[0-9]\d*$/</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="comment">// 字符串</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            patter = <span class="regexp">/^\D*([1-9]\d*\.?\d&#123;0,3&#125;)?.*$/</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="comment">// 布尔型</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="comment">// 日期型</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            <span class="comment">// patter = /^(?:(?:1[6-9]|[2-9][0-9])[0-9]&#123;2&#125;([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:(?:1[6-9]|[2-9][0-9])(?:0[48]|[2468][048]|[13579][26])|(?:16|[2468][048]|[3579][26])00)([-/.]?)0?2\2(?:29))\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/</span></span><br><span class="line">            patter = <span class="regexp">/^(?:(?:1[6-9]|[2-9][0-9])[0-9]&#123;2&#125;([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:(?:1[6-9]|[2-9][0-9])(?:0[48]|[2468][048]|[13579][26])|(?:16|[2468][048]|[3579][26])00)([-/.]?)0?2\2(?:29))$/</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">addForm</span>.<span class="property">valueType</span> !== <span class="number">5</span> &amp;&amp; !patter.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;输入常量值与数值类型不符&#x27;</span>))</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">addForm</span>.<span class="property">valueType</span> === <span class="number">5</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (value === <span class="string">&#x27;true&#x27;</span> || value === <span class="string">&#x27;false&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_">callback</span>()</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;输入常量值与数值类型不符&#x27;</span>))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 表单检验规则使用------------------------------------------------</span></span><br><span class="line">      <span class="attr">valueString</span>: [</span><br><span class="line">        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入常量值&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">validator</span>: <span class="variable language_">this</span>.<span class="property">checkValueString</span> &#125;,</span><br><span class="line">      ],</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>时间格式处理并返回(moment插件)</title>
    <url>/2022/10/27/63%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86%E5%B9%B6%E8%BF%94%E5%9B%9E(moment%E6%8F%92%E4%BB%B6)/</url>
    <content><![CDATA[<h1 id="时间格式处理并返回-moment插件"><a href="#时间格式处理并返回-moment插件" class="headerlink" title="时间格式处理并返回(moment插件)"></a>时间格式处理并返回(moment插件)</h1><h2 id="依赖下载"><a href="#依赖下载" class="headerlink" title="依赖下载"></a>依赖下载</h2><blockquote>
<p>npm i moment</p>
</blockquote>
<h2 id="插件使用"><a href="#插件使用" class="headerlink" title="插件使用"></a>插件使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1--------------------开始</span></span><br><span class="line"><span class="comment">// 全局注册使用</span></span><br><span class="line"><span class="comment">// 依赖下载后在main.js上注册</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">&#x27;moment&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$moment</span> = moment</span><br><span class="line"><span class="comment">// 在组件便可以使用</span></span><br><span class="line"><span class="variable language_">this</span>.$moment(<span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">dateRange</span>[<span class="number">0</span>] + <span class="string">&quot;&quot;</span>).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2----------------------开始</span></span><br><span class="line"><span class="comment">// 局部使用</span></span><br><span class="line"><span class="comment">// 在使用的组件中引入</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">&#x27;moment&#x27;</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">dateRange</span>[<span class="number">0</span>] + <span class="string">&quot;&quot;</span>).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>时间</tag>
      </tags>
  </entry>
  <entry>
    <title>基础配置（环境配置.evn）</title>
    <url>/2022/11/13/65%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.evn%EF%BC%89/</url>
    <content><![CDATA[<h2 id="1️⃣-文件说明"><a href="#1️⃣-文件说明" class="headerlink" title="1️⃣ 文件说明"></a>1️⃣ 文件说明</h2><p><code>.env</code>：全局默认配置文件，无论什么环境都会加载合并。</p>
<p><code>.env.development</code>：开发环境的配置文件</p>
<p><code>.env.production</code>：生产环境的配置文件</p>
<p><img src="/2022/11/13/65%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.evn%EF%BC%89/01.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>注意：三个文件的文件名必须按上面方式命名，不能乱起名，否则读取不到文件。</p>
</blockquote>
<h2 id="2️⃣-内容格式"><a href="#2️⃣-内容格式" class="headerlink" title="2️⃣ 内容格式"></a>2️⃣ 内容格式</h2><p><img src="/2022/11/13/65%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.evn%EF%BC%89/02.png" alt="img"></p>
<blockquote>
<p>注意：属性名必须以 VUE_APP_ 开头，如：VUE_APP_XXX</p>
</blockquote>
<h2 id="3️⃣-加载"><a href="#3️⃣-加载" class="headerlink" title="3️⃣ 加载"></a>3️⃣ 加载</h2><p>vue会根据启动命令自动加载相对应的环境配置文件。vue是根据文件名进行加载的，所以上面说“不要乱起名，也无需专门控制加载哪个文件”</p>
<p>比如执行npm run serve命令，会自动加载.env.development文件</p>
<p>开发环境加载 <code>.env</code> 和 <code>.env.development</code> 。</p>
<p>生成环境加载 <code>.env</code> 和 <code>.env.production</code> 。</p>
<p>运行<code>npm run serve</code>的时候主要还是看<code>package.json</code>中 <code>server</code>属性的<code>--mode</code>后面跟的是啥。如果是<code>development</code>，就会加载<code>.env.development</code>文件。</p>
<p>在<code>package.json</code>里面配置好，执行serve的时候用开发环境的。build打包用生产或者测试的</p>
<p><strong>package.json 配置项：</strong> 二选一</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;serve&quot;</span>: <span class="string">&quot;vue-cli-service serve --mode development&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;vue-cli-service build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build:sit&quot;</span>: <span class="string">&quot;vue-cli-service build --mode production.sit&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build:uat&quot;</span>: <span class="string">&quot;vue-cli-service build --mode production.uat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build:prod&quot;</span>: <span class="string">&quot;vue-cli-service build --mode production&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;vue-cli-service lint&quot;</span>,</span><br><span class="line">    <span class="string">&quot;et&quot;</span>: <span class="string">&quot;node_modules/.bin/et&quot;</span>,</span><br><span class="line">    <span class="string">&quot;et:init&quot;</span>: <span class="string">&quot;node_modules/.bin/et -i&quot;</span>,</span><br><span class="line">    <span class="string">&quot;et:list&quot;</span>: <span class="string">&quot;gulp themes&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;serve-test&quot;</span>: <span class="string">&quot;vue-cli-service serve --open --mode test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;serve&quot;</span>: <span class="string">&quot;vue-cli-service serve --open --mode development&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;vue-cli-service  --open --mode development  serve&quot;</span>,</span><br><span class="line">    <span class="string">&quot;test-oss&quot;</span>: <span class="string">&quot;vue-cli-service  --mode sit  build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build:sit&quot;</span>: <span class="string">&quot;vue-cli-service  --mode sit  build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build:prod&quot;</span>: <span class="string">&quot;vue-cli-service  --mode production  build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;vue-cli-service lint&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fix&quot;</span>: <span class="string">&quot;tslint --fix -c ./tslint.json &#x27;src/**/*&#123;.ts,.tsx&#125;&#x27;&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line">.<span class="property">env</span>.<span class="property">development</span><span class="string">`的文件。在地址上面一行加一个`</span><span class="variable constant_">NODE_ENV</span>=development</span><br></pre></td></tr></table></figure>

<h2 id="4️⃣-优先级"><a href="#4️⃣-优先级" class="headerlink" title="4️⃣ 优先级"></a>4️⃣ 优先级</h2><p><strong>环境配置文件 &gt; 全局配置文件</strong></p>
<p>当全局的配置文件和环境的配置文件有相同配置项时，环境的配置项会覆盖全局的配置项</p>
<p>如：</p>
<p>开发环境</p>
<p><img src="/2022/11/13/65%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.evn%EF%BC%89/03.png" alt="img"></p>
<blockquote>
<p>从上面图片中可知，.env 中的全局属性 VUE_APP_PREVIEW 与 VUE_APP_API_BASE_URL 被覆盖。</p>
<p>.env 中的全局属性 VUE_APP_AGE 被保留。</p>
</blockquote>
<h2 id="5️⃣-项目中的使用"><a href="#5️⃣-项目中的使用" class="headerlink" title="5️⃣ 项目中的使用"></a>5️⃣ 项目中的使用</h2><p>在配置文件中定义的属性在其它文件中如何访问呢？？</p>
<p>可以使用 <code>process.env.xxx</code> 来访问属性。</p>
<p>如：</p>
<p><img src="/2022/11/13/65%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.evn%EF%BC%89/04.png" alt="img"></p>
]]></content>
      <tags>
        <tag>环境配置</tag>
      </tags>
  </entry>
  <entry>
    <title>时间格式处理并返回(原生)</title>
    <url>/2022/10/26/62%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86%E5%B9%B6%E8%BF%94%E5%9B%9E(%E5%8E%9F%E7%94%9F)/</url>
    <content><![CDATA[<h1 id="时间格式处理并返回-原生"><a href="#时间格式处理并返回-原生" class="headerlink" title="时间格式处理并返回(原生)"></a>时间格式处理并返回(原生)</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 时间处理函数</span></span><br><span class="line">      <span class="title function_">formatDate</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> myDate = <span class="keyword">new</span> <span class="title class_">Date</span>();<span class="comment">//时间实例</span></span><br><span class="line">      <span class="keyword">var</span> H = myDate.<span class="title function_">getHours</span>(); <span class="comment">//获取小时</span></span><br><span class="line">      <span class="keyword">var</span> M = myDate.<span class="title function_">getMinutes</span>(); <span class="comment">//获取分钟</span></span><br><span class="line">      <span class="keyword">var</span> S = myDate.<span class="title function_">getSeconds</span>();<span class="comment">//获取秒</span></span><br><span class="line">      <span class="keyword">var</span> <span class="variable constant_">MS</span> = myDate.<span class="title function_">getMilliseconds</span>();<span class="comment">//获取毫秒</span></span><br><span class="line">      <span class="keyword">var</span> milliSeconds = H * <span class="number">3600</span> * <span class="number">1000</span> + M * <span class="number">60</span> * <span class="number">1000</span> + S * <span class="number">1000</span> + <span class="variable constant_">MS</span>;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;当前时间的毫秒数为：&quot;</span> + milliSeconds);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> timeStamp = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">      <span class="keyword">let</span> year = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getFullYear</span>();</span><br><span class="line">      <span class="keyword">let</span> month = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMonth</span>() + <span class="number">1</span> &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + (<span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMonth</span>() + <span class="number">1</span>) : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMonth</span>() + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getDate</span>() &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getDate</span>() : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getDate</span>();</span><br><span class="line">      <span class="keyword">let</span> hh = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getHours</span>() &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getHours</span>() : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getHours</span>();</span><br><span class="line">      <span class="keyword">let</span> mm = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMinutes</span>() &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMinutes</span>() : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMinutes</span>();</span><br><span class="line">      <span class="keyword">let</span> ss = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getSeconds</span>() &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getSeconds</span>() : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getSeconds</span>();</span><br><span class="line">      <span class="keyword">let</span> sss = <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMilliseconds</span>() &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMilliseconds</span>() : <span class="keyword">new</span> <span class="title class_">Date</span>(timeStamp).<span class="title function_">getMilliseconds</span>();</span><br><span class="line">      <span class="keyword">return</span> year + month + date + hh + mm + ss + sss;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>时间</tag>
      </tags>
  </entry>
  <entry>
    <title>简单的富文本wangeditor</title>
    <url>/2021/11/18/39%E7%AE%80%E5%8D%95%E7%9A%84%E5%AF%8C%E6%96%87%E6%9C%ACwangeditor/</url>
    <content><![CDATA[<h1 id="简单的富文本wangeditor"><a href="#简单的富文本wangeditor" class="headerlink" title="简单的富文本wangeditor"></a>简单的富文本wangeditor</h1><h2 id="依赖包准备"><a href="#依赖包准备" class="headerlink" title="依赖包准备"></a>依赖包准备</h2><blockquote>
<p>下载依赖 npm i wangeditor<br>版本号：4.7.15</p>
</blockquote>
<h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;editor&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-top:20px&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;getEditorContent&quot;</span>&gt;</span>获取内容<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> E <span class="keyword">from</span> <span class="string">&#x27;wangeditor&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;WangEditor&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">components</span>: &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">editor</span>: <span class="literal">null</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">created</span>(<span class="params"></span>) &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="title function_">createEditor</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 创建富文本</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">createEditor</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">editor</span> = <span class="keyword">new</span> <span class="title function_">E</span>(<span class="string">&#x27;#editor&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> &#123; editor &#125; = <span class="variable language_">this</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="property">config</span>.<span class="property">uploadImgServer</span> = <span class="string">&#x27;/upload-img&#x27;</span> <span class="comment">// 服务器上传图片接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 设置编辑区域高度为 500px</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="property">config</span>.<span class="property">height</span> = <span class="number">500</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      editor.<span class="title function_">create</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 获取富文本内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">getEditorContent</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">editor</span>.<span class="property">txt</span>.<span class="title function_">html</span>())</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.left-menu</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.main</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">flex</span>: <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>富文本</tag>
      </tags>
  </entry>
  <entry>
    <title>获取当前网页窗口的距离getBoundingClientRect()</title>
    <url>/2022/11/02/64%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%BD%91%E9%A1%B5%E7%AA%97%E5%8F%A3%E7%9A%84%E8%B7%9D%E7%A6%BBgetBoundingClientRect()/</url>
    <content><![CDATA[<h1 id="获取当前网页窗口的距离getBoundingClientRect"><a href="#获取当前网页窗口的距离getBoundingClientRect" class="headerlink" title="获取当前网页窗口的距离getBoundingClientRect()"></a>获取当前网页窗口的距离getBoundingClientRect()</h1><p><img src="/2022/11/02/64%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%BD%91%E9%A1%B5%E7%AA%97%E5%8F%A3%E7%9A%84%E8%B7%9D%E7%A6%BBgetBoundingClientRect()/01.jpg"></p>
<h2 id="方法使用使用"><a href="#方法使用使用" class="headerlink" title="方法使用使用"></a>方法使用使用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> dom=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;divId&#x27;</span>);</span><br><span class="line"><span class="title function_">alert</span>(dom.<span class="title function_">getBoundingClientRect</span>().<span class="property">left</span>);<span class="comment">//当前页面窗口的左边距离</span></span><br><span class="line"><span class="title function_">alert</span>(dom.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span>);<span class="comment">//距离窗口顶部的距离</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>浏览器</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP 状态码</title>
    <url>/2022/11/27/66HTTP%20%E7%8A%B6%E6%80%81%E7%A0%81/</url>
    <content><![CDATA[<h1 id="HTTP-状态码"><a href="#HTTP-状态码" class="headerlink" title="HTTP 状态码"></a>HTTP 状态码</h1><p>当浏览者访问一个网页时，浏览者的浏览器会向网页所在服务器发出请求。当浏览器接收并显示网页前，此网页所在的服务器会返回一个包含 HTTP 状态码的信息头（server header）用以响应浏览器的请求。</p>
<p>HTTP 状态码的英文为 <strong>HTTP Status Code</strong>。。</p>
<p>下面是常见的 HTTP 状态码：</p>
<ul>
<li>200 - 请求成功</li>
<li>301 - 资源（网页等）被永久转移到其它URL</li>
<li>404 - 请求的资源（网页等）不存在</li>
<li>500 - 内部服务器错误</li>
</ul>
<h2 id="HTTP-状态码分类"><a href="#HTTP-状态码分类" class="headerlink" title="HTTP 状态码分类"></a>HTTP 状态码分类</h2><p>HTTP 状态码由三个十进制数字组成，第一个十进制数字定义了状态码的类型。响应分为五类：信息响应(100–199)，成功响应(200–299)，重定向(300–399)，客户端错误(400–499)和服务器错误 (500–599)：</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>分类描述</th>
</tr>
</thead>
<tbody><tr>
<td>1**</td>
<td>信息，服务器收到请求，需要请求者继续执行操作</td>
</tr>
<tr>
<td>2**</td>
<td>成功，操作被成功接收并处理</td>
</tr>
<tr>
<td>3**</td>
<td>重定向，需要进一步的操作以完成请求</td>
</tr>
<tr>
<td>4**</td>
<td>客户端错误，请求包含语法错误或无法完成请求</td>
</tr>
<tr>
<td>5**</td>
<td>服务器错误，服务器在处理请求的过程中发生了错误</td>
</tr>
</tbody></table>
<p>HTTP状态码列表:</p>
<table>
<thead>
<tr>
<th>状态码</th>
<th>状态码英文名称</th>
<th>中文描述</th>
</tr>
</thead>
<tbody><tr>
<td>100</td>
<td>Continue</td>
<td>继续。客户端应继续其请求</td>
</tr>
<tr>
<td>101</td>
<td>Switching Protocols</td>
<td>切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>200</td>
<td>OK</td>
<td>请求成功。一般用于GET与POST请求</td>
</tr>
<tr>
<td>201</td>
<td>Created</td>
<td>已创建。成功请求并创建了新的资源</td>
</tr>
<tr>
<td>202</td>
<td>Accepted</td>
<td>已接受。已经接受请求，但未处理完成</td>
</tr>
<tr>
<td>203</td>
<td>Non-Authoritative Information</td>
<td>非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本</td>
</tr>
<tr>
<td>204</td>
<td>No Content</td>
<td>无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档</td>
</tr>
<tr>
<td>205</td>
<td>Reset Content</td>
<td>重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域</td>
</tr>
<tr>
<td>206</td>
<td>Partial Content</td>
<td>部分内容。服务器成功处理了部分GET请求</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>300</td>
<td>Multiple Choices</td>
<td>多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择</td>
</tr>
<tr>
<td>301</td>
<td>Moved Permanently</td>
<td>永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替</td>
</tr>
<tr>
<td>302</td>
<td>Found</td>
<td>临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td>
</tr>
<tr>
<td>303</td>
<td>See Other</td>
<td>查看其它地址。与301类似。使用GET和POST请求查看</td>
</tr>
<tr>
<td>304</td>
<td>Not Modified</td>
<td>未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源</td>
</tr>
<tr>
<td>305</td>
<td>Use Proxy</td>
<td>使用代理。所请求的资源必须通过代理访问</td>
</tr>
<tr>
<td>306</td>
<td>Unused</td>
<td>已经被废弃的HTTP状态码</td>
</tr>
<tr>
<td>307</td>
<td>Temporary Redirect</td>
<td>临时重定向。与302类似。使用GET请求重定向</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>客户端请求的语法错误，服务器无法理解</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>请求要求用户的身份认证</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required</td>
<td>保留，将来使用</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>服务器理解请求客户端的请求，但是拒绝执行此请求</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置”您所请求的资源无法找到”的个性页面</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
<td>客户端请求中的方法被禁止</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable</td>
<td>服务器无法根据客户端请求的内容特性完成请求</td>
</tr>
<tr>
<td>407</td>
<td>Proxy Authentication Required</td>
<td>请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td>
</tr>
<tr>
<td>408</td>
<td>Request Time-out</td>
<td>服务器等待客户端发送的请求时间过长，超时</td>
</tr>
<tr>
<td>409</td>
<td>Conflict</td>
<td>服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突</td>
</tr>
<tr>
<td>410</td>
<td>Gone</td>
<td>客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置</td>
</tr>
<tr>
<td>411</td>
<td>Length Required</td>
<td>服务器无法处理客户端发送的不带Content-Length的请求信息</td>
</tr>
<tr>
<td>412</td>
<td>Precondition Failed</td>
<td>客户端请求信息的先决条件错误</td>
</tr>
<tr>
<td>413</td>
<td>Request Entity Too Large</td>
<td>由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息</td>
</tr>
<tr>
<td>414</td>
<td>Request-URI Too Large</td>
<td>请求的URI过长（URI通常为网址），服务器无法处理</td>
</tr>
<tr>
<td>415</td>
<td>Unsupported Media Type</td>
<td>服务器无法处理请求附带的媒体格式</td>
</tr>
<tr>
<td>416</td>
<td>Requested range not satisfiable</td>
<td>客户端请求的范围无效</td>
</tr>
<tr>
<td>417</td>
<td>Expectation Failed</td>
<td>服务器无法满足Expect的请求头信息</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
<td>服务器内部错误，无法完成请求</td>
</tr>
<tr>
<td>501</td>
<td>Not Implemented</td>
<td>服务器不支持请求的功能，无法完成请求</td>
</tr>
<tr>
<td>502</td>
<td>Bad Gateway</td>
<td>作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
<td>由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中</td>
</tr>
<tr>
<td>504</td>
<td>Gateway Time-out</td>
<td>充当网关或代理的服务器，未及时从远端服务器获取请求</td>
</tr>
<tr>
<td>505</td>
<td>HTTP Version not supported</td>
<td>服务器不支持请求的HTTP协议的版本，无法完成处理</td>
</tr>
</tbody></table>
<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title>原生滚动条样式修改</title>
    <url>/2022/12/03/67%E5%8E%9F%E7%94%9F%E6%BB%9A%E5%8A%A8%E6%9D%A1%E6%A0%B7%E5%BC%8F%E4%BF%AE%E6%94%B9/</url>
    <content><![CDATA[<h1 id="原生滚动条样式修改"><a href="#原生滚动条样式修改" class="headerlink" title="原生滚动条样式修改"></a>原生滚动条样式修改</h1><h2 id="隐藏滚动条"><a href="#隐藏滚动条" class="headerlink" title="隐藏滚动条"></a>隐藏滚动条</h2><pre><code>::v-deep.operationReportHtml &#123;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  padding: 28px 12px 0 12px;
  color: #898989;
  background-color: #f1f1f1;

  &amp;::-webkit-scrollbar &#123;//给需要滚动的元素添加伪选择器,将宽度设为0，滚动条就会隐藏。
    width: 0;
  &#125;
&#125;
</code></pre>
<h2 id="滚动条样式修改："><a href="#滚动条样式修改：" class="headerlink" title="滚动条样式修改："></a>滚动条样式修改：</h2><p>可以设置滚动条样式，使其美观。</p>
<p>&#x2F;<em>滚动条宽 长,滚动条整体部分，其中的属性有width,height,background,border等。</em>&#x2F;</p>
<pre><code>::-webkit-scrollbar&#123;
     width: 7px;

&#125;
</code></pre>
<p>&#x2F;<em>滚动条的滑轨背景颜色,可以用display:none让其不显示，也可以添加背景图片，颜色改变显示效果。</em>&#x2F;</p>
<pre><code>::-webkit-scrollbar-track&#123;
    background-color: #f5f5f5;

      -webkit-box-shadow:inset 0 0 3px rgba(0,0,0,0.1);

   border-radius:5px;
</code></pre>
<p>}</p>
<p>&#x2F;*滑块颜色 *&#x2F;</p>
<pre><code>::-webkit-scrollbar-thumb&#123;
    background-color: rgba(0, 0, 0, 0.2);

    border-radius: 5px;

&#125;
</code></pre>
<p>&#x2F;<em>滚动条两端的按钮。可以用display:none让其不显示，也可以添加背景图片，颜色改变显示效果。</em>&#x2F;</p>
<pre><code>::-webkit-scrollbar-button&#123;
    background-color: #eee;

    display: none;
</code></pre>
<p>   }</p>
<p>&#x2F;*横向滚动条和纵向滚动条相交处尖角的颜色 *&#x2F;</p>
<pre><code>::-webkit-scrollbar-corner&#123;
    background-color: black;

&#125;
</code></pre>
]]></content>
      <tags>
        <tag>滚动条</tag>
      </tags>
  </entry>
  <entry>
    <title>主题切换scss</title>
    <url>/2022/12/27/70%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2scss/</url>
    <content><![CDATA[<h1 id="主题切换scss"><a href="#主题切换scss" class="headerlink" title="主题切换scss"></a>主题切换scss</h1><h2 id="步骤1：在assets-x2F-style下添加-themes-scss文件"><a href="#步骤1：在assets-x2F-style下添加-themes-scss文件" class="headerlink" title="步骤1：在assets&#x2F;style下添加_themes.scss文件"></a>步骤1：在assets&#x2F;style下添加_themes.scss文件</h2><blockquote>
<p>配置变量主体</p>
</blockquote>
<h5 id="代码参考"><a href="#代码参考" class="headerlink" title="代码参考"></a>代码参考</h5><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="variable">$themes</span>: ( </span><br><span class="line"><span class="string">&quot;Red&quot;</span>: ( //整体主色调/菜单栏背景/图标.按钮主色/悬停状态</span><br><span class="line">    mainColor: <span class="number">#D6000F</span>, //主题色</span><br><span class="line">    activeMainColor: <span class="number">#ab343c</span>, //页面主标题色/重要文字/弹框标题色</span><br><span class="line">    titleColor: <span class="number">#08121C</span>, //默认字体色/二级信息字体色</span><br><span class="line">    infoColor: <span class="number">#545454</span>, //菜单列表背景色</span><br><span class="line">    menuBackgroundColor:<span class="number">#BC485014</span>, //</span><br><span class="line">    menuIconBackgroundColor:<span class="number">#bc48501f</span>, //默认字体色/二级信息字体/标签默认色</span><br><span class="line">    divInfoColor: <span class="number">#929AA2</span>, //控件不可用/禁用状态/不可点击</span><br><span class="line">    disabledColor: <span class="number">#EAEAEA</span>, //边框描边颜色</span><br><span class="line">    borderColor:<span class="number">#EDF3FE</span>, //整体页面背景色/图标底色/文字信息底色</span><br><span class="line">    bodyBackgroundColor:<span class="number">#F5F7F6</span>, //辅助警示提示作用</span><br><span class="line">    warningColor:<span class="number">#E7D62C</span>, //错误提示文字色/错误提示边框色</span><br><span class="line">    errorColor:<span class="number">#FF542C</span>,</span><br><span class="line">    hoverColor:<span class="number">#fff</span>, ), </span><br><span class="line"><span class="string">&quot;Blue&quot;</span>: ( //整体主色调/菜单栏背景/图标.按钮主色/悬停状态</span><br><span class="line">    mainColor: <span class="number">#409EFF</span>, //菜单选中背景色/点击状态/文字,按钮按下</span><br><span class="line">    activeMainColor: <span class="number">#348eea</span>, //页面主标题色/重要文字/弹框标题色</span><br><span class="line">    titleColor: <span class="number">#08121C</span>, //列表背景色</span><br><span class="line">    menuBackgroundColor:<span class="number">#409EFF14</span>, //</span><br><span class="line">    menuIconBackgroundColor:<span class="number">#409EFF1f</span>, //默认字体色/二级信息字体色</span><br><span class="line">    infoColor: <span class="number">#545454</span>, //默认字体色/二级信息字体/标签默认色</span><br><span class="line">    divInfoColor: <span class="number">#929AA2</span>, //控件不可用/禁用状态/不可点击</span><br><span class="line">    disabledColor: <span class="number">#EAEAEA</span>, //边框描边颜色</span><br><span class="line">    borderColor:<span class="number">#EDF3FE</span>, //整体页面背景色/图标底色/文字信息底色</span><br><span class="line">    bodyBackgroundColor:<span class="number">#F5F7F6</span>, //辅助警示提示作用</span><br><span class="line">    warningColor:<span class="number">#E7D62C</span>, //错误提示文字色/错误提示边框色</span><br><span class="line">    errorColor:<span class="number">#FF542C</span>, hoverColor:<span class="number">#fff</span>, ), </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：在assets-x2F-style下新增另外一个sass文件-handle-scss来步骤1中的-themes变量"><a href="#步骤2：在assets-x2F-style下新增另外一个sass文件-handle-scss来步骤1中的-themes变量" class="headerlink" title="步骤2：在assets&#x2F;style下新增另外一个sass文件_handle.scss来步骤1中的$themes变量"></a>步骤2：在assets&#x2F;style下新增另外一个sass文件_handle.scss来步骤1中的$themes变量</h2><h5 id="代码参考-1"><a href="#代码参考-1" class="headerlink" title="代码参考"></a>代码参考</h5><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">@import</span> <span class="string">&quot;./themes.scss&quot;</span>;</span><br><span class="line"><span class="comment">//切换主题时 获取不同的主题色值</span></span><br><span class="line"><span class="keyword">@mixin</span> themeify &#123;</span><br><span class="line">    <span class="keyword">@each</span> <span class="variable">$theme-name</span>,</span><br><span class="line">    <span class="variable">$theme-map</span> in <span class="variable">$themes</span> &#123;</span><br><span class="line">        <span class="comment">//!global 把局部变量强升为全局变量</span></span><br><span class="line">        <span class="variable">$theme-map</span>: <span class="variable">$theme-map</span> !global;</span><br><span class="line">        <span class="comment">//判断html的data-theme的属性值  #&#123;&#125;是sass的插值表达式</span></span><br><span class="line">        <span class="comment">//&amp; sass嵌套里的父容器标识   @content是混合器插槽，像vue的slot</span></span><br><span class="line">        <span class="selector-attr">[data-theme=<span class="string">&quot;#&#123;$theme-name&#125;&quot;</span>]</span> &amp; &#123;</span><br><span class="line">            <span class="keyword">@content</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//从主题色map中取出对应颜色</span></span><br><span class="line"><span class="keyword">@function</span> themed(<span class="variable">$key</span>) &#123;</span><br><span class="line">    <span class="keyword">@return</span> map-get(<span class="variable">$theme-map</span>, <span class="variable">$key</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取背景颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> background_<span class="attribute">color</span>(<span class="variable">$color</span>) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>)<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取字体颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> font_<span class="attribute">color</span>(<span class="variable">$color</span>) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>)<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取边框颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> border_<span class="attribute">color</span>(<span class="variable">$color</span>) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="attribute">border-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>)<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取主题颜色</span></span><br><span class="line"><span class="keyword">@function</span> get-color( <span class="variable">$color</span>, <span class="variable">$shade</span>: <span class="string">&#x27;mainColor&#x27;</span>, <span class="variable">$map</span> : <span class="variable">$themes</span>)&#123;</span><br><span class="line">    <span class="comment">// check color exists</span></span><br><span class="line">    <span class="keyword">@if</span> (map-has-key(<span class="variable">$map</span>, <span class="variable">$color</span>)) &#123;</span><br><span class="line">      <span class="variable">$value</span>: <span class="built_in">map-get</span>(<span class="variable">$map</span>, <span class="built_in">unquote</span>(<span class="variable">$color</span>));</span><br><span class="line">      <span class="comment">// check if color or map</span></span><br><span class="line">      <span class="keyword">@if</span> type-of(<span class="variable">$value</span>) == <span class="attribute">color</span> &#123;</span><br><span class="line">        <span class="comment">// return color</span></span><br><span class="line">        <span class="keyword">@return</span> <span class="variable">$value</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// check shade of color exists</span></span><br><span class="line">      <span class="keyword">@if</span> (map-has-key(<span class="variable">$value</span>, <span class="variable">$shade</span>)) &#123;</span><br><span class="line">        <span class="comment">// return shade of color</span></span><br><span class="line">        <span class="keyword">@return</span> map-get(<span class="variable">$value</span>, <span class="variable">$shade</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// else do nothing</span></span><br><span class="line">    <span class="keyword">@return</span> null;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤3、使用"><a href="#步骤3、使用" class="headerlink" title="步骤3、使用"></a>步骤3、使用</h2><blockquote>
<p>在组件的style标签在引入文件</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- dom节点 --&gt;</span><br><span class="line">&lt;el-button  @click=&quot;handleclick&quot; type=&quot;primary&quot; icon=&quot;el-icon-edit&quot;&gt;primary&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 定义变量 --&gt;</span><br><span class="line">color:&#x27;Red&#x27;</span><br><span class="line"></span><br><span class="line">&lt;!-- 点击事件 --&gt;</span><br><span class="line">handleclick()&#123;</span><br><span class="line">  this.color = this.color===&#x27;Red&#x27;?&#x27;Blue&#x27;:&#x27;Red&#x27;</span><br><span class="line">  window.document.documentElement.setAttribute( &quot;data-theme&quot;, this.color );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- scss引入 --&gt;</span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">@import &quot;../assets/styles/handle&quot;;</span><br><span class="line">.home &#123;</span><br><span class="line">  @include background-color(&#x27;mainColor&#x27;);//修改背景颜色</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/12/27/70%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2scss/01.png"></p>
]]></content>
      <tags>
        <tag>scss</tag>
      </tags>
  </entry>
  <entry>
    <title>主题切换css---toggleClass()</title>
    <url>/2022/12/26/69%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2css/</url>
    <content><![CDATA[<h1 id="主题切换css—toggleClass"><a href="#主题切换css—toggleClass" class="headerlink" title="主题切换css—toggleClass()"></a>主题切换css—toggleClass()</h1><h2 id="步骤1：在utils-x2F-index-js文件下添加一个添加类名的公共方法"><a href="#步骤1：在utils-x2F-index-js文件下添加一个添加类名的公共方法" class="headerlink" title="步骤1：在utils&#x2F;index.js文件下添加一个添加类名的公共方法"></a>步骤1：在utils&#x2F;index.js文件下添加一个添加类名的公共方法</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">toggleClass</span>(<span class="params">element, className</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!element || !className) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> classString = element.<span class="property">className</span></span><br><span class="line">  <span class="keyword">const</span> nameIndex = classString.<span class="title function_">indexOf</span>(className)</span><br><span class="line">  <span class="keyword">if</span> (nameIndex === -<span class="number">1</span>) &#123;</span><br><span class="line">    classString += <span class="string">&#x27;&#x27;</span> + className</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    classString =</span><br><span class="line">      classString.<span class="title function_">substr</span>(<span class="number">0</span>, nameIndex) +</span><br><span class="line">      classString.<span class="title function_">substr</span>(nameIndex + className.<span class="property">length</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  element.<span class="property">className</span> = classString</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：在assets-x2F-style下添加themes-css文件"><a href="#步骤2：在assets-x2F-style下添加themes-css文件" class="headerlink" title="步骤2：在assets&#x2F;style下添加themes.css文件"></a>步骤2：在assets&#x2F;style下添加themes.css文件</h2><blockquote>
<p>并由一个class类名themes包裹样式所有需要修改的样式<br>添加一个按钮的背景颜色，待会测试用的</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line"><span class="selector-class">.themes</span>&#123;</span><br><span class="line">  <span class="selector-class">.el-button--primary</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤3：使用（测试按钮的背景颜色）"><a href="#步骤3：使用（测试按钮的背景颜色）" class="headerlink" title="步骤3：使用（测试按钮的背景颜色）"></a>步骤3：使用（测试按钮的背景颜色）</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 在页面组件中添加按钮并添加点击事件 --&gt;</span><br><span class="line">&lt;el-button  @click=&quot;handleclick&quot; type=&quot;primary&quot; icon=&quot;el-icon-edit&quot;&gt;primary&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 导入公共方法 --&gt;</span><br><span class="line">import &#123; toggleClass &#125; from &#x27;@/utils&#x27;</span><br><span class="line"></span><br><span class="line">&lt;!-- 点击事件操作 --&gt;</span><br><span class="line">handleclick()&#123;</span><br><span class="line">  toggleClass(document.body, &#x27;themes&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/12/26/69%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2css/05.png"></p>
<h2 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h2><p><img src="/2022/12/26/69%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2css/06.png"></p>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue项目动态修改ip避免重复打包</title>
    <url>/2022/12/19/68Vue%E9%A1%B9%E7%9B%AE%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9ip%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E6%89%93%E5%8C%85/</url>
    <content><![CDATA[<h1 id="Vue项目动态修改ip避免重复打包"><a href="#Vue项目动态修改ip避免重复打包" class="headerlink" title="Vue项目动态修改ip避免重复打包"></a>Vue项目动态修改ip避免重复打包</h1><h2 id="步骤1、在根目录下的public文件夹下新建一个可配置的config-js文件，填写请求的接口地址"><a href="#步骤1、在根目录下的public文件夹下新建一个可配置的config-js文件，填写请求的接口地址" class="headerlink" title="步骤1、在根目录下的public文件夹下新建一个可配置的config.js文件，填写请求的接口地址"></a>步骤1、在根目录下的public文件夹下新建一个可配置的config.js文件，填写请求的接口地址</h2><p><img src="/2022/12/19/68Vue%E9%A1%B9%E7%9B%AE%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9ip%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E6%89%93%E5%8C%85/01.png"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ipConfig = &#123;</span><br><span class="line">  <span class="comment">// baseUrl: &#x27;http://10.11.11.198:8080/tpss&#x27;,//测试环境</span></span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&#x27;http://10.11.11.199:8888/tpss&#x27;</span>,<span class="comment">//生成环境</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2、在根目录下的public文件夹下的index-html文件中引入config文件"><a href="#步骤2、在根目录下的public文件夹下的index-html文件中引入config文件" class="headerlink" title="步骤2、在根目录下的public文件夹下的index.html文件中引入config文件"></a>步骤2、在根目录下的public文件夹下的index.html文件中引入config文件</h2><p><img src="/2022/12/19/68Vue%E9%A1%B9%E7%9B%AE%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9ip%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E6%89%93%E5%8C%85/02.png"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./config.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="步骤3、修改项目用到的process-env-VUE-APP-BASE-URL更改为-window-ipConfig-baseUrl"><a href="#步骤3、修改项目用到的process-env-VUE-APP-BASE-URL更改为-window-ipConfig-baseUrl" class="headerlink" title="步骤3、修改项目用到的process.env.VUE_APP_BASE_URL更改为 window.ipConfig.baseUrl"></a>步骤3、修改项目用到的process.env.VUE_APP_BASE_URL更改为 window.ipConfig.baseUrl</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// let baseUrl = process.env.VUE_APP_BASE_URL</span></span><br><span class="line"><span class="keyword">let</span> baseUrl = <span class="variable language_">window</span>.<span class="property">ipConfig</span>.<span class="property">baseUrl</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>打包</tag>
      </tags>
  </entry>
  <entry>
    <title>h5页面横向滚动的tabs</title>
    <url>/2023/01/13/71h5%E9%A1%B5%E9%9D%A2%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8%E7%9A%84tabs/</url>
    <content><![CDATA[<h1 id="h5页面横向滚动的tabs"><a href="#h5页面横向滚动的tabs" class="headerlink" title="h5页面横向滚动的tabs"></a>h5页面横向滚动的tabs</h1><h2 id="步骤1、在components文件下封装组件"><a href="#步骤1、在components文件下封装组件" class="headerlink" title="步骤1、在components文件下封装组件"></a>步骤1、在components文件下封装组件</h2><blockquote>
<p>完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;header_search-left&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;slot name=&quot;header_tab_img&quot;&gt;&lt;/slot&gt; --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;header_tab&quot; ref=&quot;headertab&quot;&gt;</span><br><span class="line">      &lt;ul ref=&quot;tabitem&quot;&gt;</span><br><span class="line">        &lt;li</span><br><span class="line">          v-for=&quot;(item, index) in listArray&quot;</span><br><span class="line">          :key=&quot;index&quot;</span><br><span class="line">          :class=&quot;index == current ? &#x27;activeheader&#x27; : &#x27;&#x27;&quot;</span><br><span class="line">          @click=&quot;getTab(index, $event)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item.name &#125;&#125;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;header_search-right&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;slot name=&quot;header_tab_img&quot;&gt;&lt;/slot&gt; --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;HeaderTab&quot;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    listArray: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      current:1,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getTab(index, e) &#123;</span><br><span class="line">      this.current = index;   // 高亮当前</span><br><span class="line">      let tab =this.$refs.headertab; // 包裹 ul的 div</span><br><span class="line">      let tabitem = this.$refs.tabitem;    // 包裹 li的 ul</span><br><span class="line">      let winWidth = window.innerWidth;  // 当前屏幕的宽度</span><br><span class="line">      let liList = e.target;   // 当前点击的li</span><br><span class="line">      if (liList) &#123;  //  当前li左偏移, li的宽度, 中间值(当前屏幕的宽度 - li的宽度) /2, 目标值 (中间值 - 当前li左偏移), 整个ul的宽度</span><br><span class="line">        let liLeft = liList.offsetLeft,</span><br><span class="line">          liWidth = liList.offsetWidth,</span><br><span class="line">          liCenter = (winWidth - liWidth) / 2,</span><br><span class="line">          liTarget = liLeft - liCenter;</span><br><span class="line">        let ulWidth = tabitem.offsetWidth;</span><br><span class="line">        if (liTarget &lt; 0) &#123;</span><br><span class="line">          tab.scrollLeft = 0;</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        // winWidth(375) - ulWidth(436) =  -61</span><br><span class="line">        if (liTarget &lt; winWidth - ulWidth) &#123;</span><br><span class="line">          tab.scrollLeft = -(winWidth - ulWidth) + liWidth;</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        tab.scrollLeft = liTarget;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">  .header &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 40px;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    display: flex;</span><br><span class="line">    border-radius: 8px;</span><br><span class="line">    position: relative;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  .header_tab &#123;</span><br><span class="line">    width: 90%;</span><br><span class="line">    height: 40px;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: nowrap;</span><br><span class="line">    overflow: scroll;</span><br><span class="line">    padding-left: 19px;</span><br><span class="line">    padding-right: 19px;</span><br><span class="line">    // 平滑滚动</span><br><span class="line">    transition: all 0.05s linear;</span><br><span class="line">    scroll-behavior: smooth;</span><br><span class="line">  &#125;</span><br><span class="line">  .header_tab::-webkit-scrollbar &#123;</span><br><span class="line">    display: none;</span><br><span class="line">  &#125;</span><br><span class="line">  ul &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding-left: 0;</span><br><span class="line">    padding-right: 19px;</span><br><span class="line">    height: 40px;</span><br><span class="line">  &#125;</span><br><span class="line">  li &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    height: 40px;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    padding: 0px 10px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    color: #333;</span><br><span class="line">    // 点击高亮某一项时,将原来的字体变大,会导致没有高亮的元素距离底部有空隙,会出现纵向滚动条</span><br><span class="line">    // margin-top: -1px;</span><br><span class="line">  &#125;</span><br><span class="line">  .activeheader &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    color: #2b96ff;</span><br><span class="line">    // font-weight: 700;</span><br><span class="line">    position: relative;</span><br><span class="line">    &amp;:after &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      content: &quot;&quot;;</span><br><span class="line">      width: 18px;</span><br><span class="line">      height: 2px;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      left: calc(50% - 9px);</span><br><span class="line">      background-color: #2b96ff;</span><br><span class="line">	    border-radius: 1px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  .header_search-left &#123;</span><br><span class="line">    width: 25px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 1000;</span><br><span class="line">    background-image:-webkit-linear-gradient(  </span><br><span class="line">    to right,   </span><br><span class="line">    rgba(255,255,255,1) 0%,   </span><br><span class="line">    rgba(255,255,255,1) 55%,   </span><br><span class="line">    rgba(255,255,255,1) 70%,</span><br><span class="line">    rgba(255,255,255,0.8) 80%,   </span><br><span class="line">    rgba(255,255,255,0.3) 90%,   </span><br><span class="line">    rgba(255,255,255,0.1) 100%);    </span><br><span class="line">  background-image: linear-gradient(  </span><br><span class="line">    to right,   </span><br><span class="line">    rgba(255,255,255,1) 0%,   </span><br><span class="line">    rgba(255,255,255,1) 55%,</span><br><span class="line">    rgba(255,255,255,1) 70%,  </span><br><span class="line">    rgba(255,255,255,0.8) 80%,   </span><br><span class="line">    rgba(255,255,255,0.3) 90%,   </span><br><span class="line">    rgba(255,255,255,0.1) 100%);</span><br><span class="line">    img &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      margin: auto;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  .header_search-right &#123;</span><br><span class="line">    width: 25px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    z-index: 1000;</span><br><span class="line">    background-image:-webkit-linear-gradient(  </span><br><span class="line">    to left,   </span><br><span class="line">    rgba(255,255,255,1) 0%,   </span><br><span class="line">    rgba(255,255,255,1) 55%,</span><br><span class="line">    rgba(255,255,255,1) 70%,  </span><br><span class="line">    rgba(255,255,255,0.8) 80%,   </span><br><span class="line">    rgba(255,255,255,0.3) 90%,   </span><br><span class="line">    rgba(255,255,255,0.1) 100%);    </span><br><span class="line">  background-image: linear-gradient(  </span><br><span class="line">    to left,   </span><br><span class="line">    rgba(255,255,255,1) 0%,   </span><br><span class="line">    rgba(255,255,255,1) 55%,</span><br><span class="line">    rgba(255,255,255,1) 70%,  </span><br><span class="line">    rgba(255,255,255,0.8) 80%,   </span><br><span class="line">    rgba(255,255,255,0.3) 90%,   </span><br><span class="line">    rgba(255,255,255,0.1) 100%);</span><br><span class="line">    img &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      margin: auto;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2、引用组件并使用"><a href="#步骤2、引用组件并使用" class="headerlink" title="步骤2、引用组件并使用"></a>步骤2、引用组件并使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 使用 --&gt;</span><br><span class="line">&lt;header-tab :listArray=&quot;list&quot;&gt;&lt;/header-tab&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 引用 --&gt;</span><br><span class="line">import HeaderTab from &#x27;../components/scroll.vue&#x27;</span><br><span class="line"></span><br><span class="line">&lt;!-- 参考数据 --&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;&#x27;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        HeaderTab,</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            list:[</span><br><span class="line">                &#123; id: 1, name: &quot;分级分类记录&quot; &#125;,</span><br><span class="line">                &#123; id: 2, name: &quot;吸毒检测记录&quot; &#125;,</span><br><span class="line">                &#123; id: 3, name: &quot;家访记录&quot; &#125;,</span><br><span class="line">                &#123; id: 4, name: &quot;风险评估记录&quot; &#125;,</span><br><span class="line">                &#123; id: 5, name: &quot;毛发检测结果记录&quot; &#125;,</span><br><span class="line">                &#123; id: 6, name: &quot;报备记录&quot; &#125;,</span><br><span class="line">            ],</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="/2023/01/13/71h5%E9%A1%B5%E9%9D%A2%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8%E7%9A%84tabs/01.png"></p>
]]></content>
      <tags>
        <tag>h5</tag>
      </tags>
  </entry>
  <entry>
    <title>h5页面横向滚动的div</title>
    <url>/2023/01/17/72h5%E9%A1%B5%E9%9D%A2%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8%E7%9A%84div/</url>
    <content><![CDATA[<h1 id="h5页面横向滚动的div"><a href="#h5页面横向滚动的div" class="headerlink" title="h5页面横向滚动的div"></a>h5页面横向滚动的div</h1><blockquote>
<p>完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div class=&quot;test&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;test-main&quot;&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; &#x27;测试左右滚动&#x27; &#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">    .test&#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">    background-color: red;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: nowrap;</span><br><span class="line">    overflow: scroll;</span><br><span class="line">    transition: all 0.05s linear;</span><br><span class="line">    scroll-behavior: smooth;</span><br><span class="line">    .test-main&#123;</span><br><span class="line">      width: 1500px;</span><br><span class="line">      height: 100%;</span><br><span class="line">      p&#123;</span><br><span class="line">         width: 1500px; </span><br><span class="line">        text-align: right;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .test::-webkit-scrollbar &#123;</span><br><span class="line">    display: none;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>h5</tag>
      </tags>
  </entry>
  <entry>
    <title>svg-icon自定义icon标签</title>
    <url>/2023/02/05/74svg-icon%E8%87%AA%E5%AE%9A%E4%B9%89icon%E6%A0%87%E7%AD%BE/</url>
    <content><![CDATA[<h1 id="svg-icon自定义icon标签"><a href="#svg-icon自定义icon标签" class="headerlink" title="svg-icon自定义icon标签"></a>svg-icon自定义icon标签</h1><h2 id="步骤1：下载依赖"><a href="#步骤1：下载依赖" class="headerlink" title="步骤1：下载依赖"></a>步骤1：下载依赖</h2><blockquote>
<p>npm i svg-sprite-loader svgo</p>
</blockquote>
<p><img src="/2023/02/05/74svg-icon%E8%87%AA%E5%AE%9A%E4%B9%89icon%E6%A0%87%E7%AD%BE/%E4%BD%8D%E7%BD%AE.jpg"></p>
<h2 id="步骤2：在src下创建icons文件夹-创建存放icon图标的文件"><a href="#步骤2：在src下创建icons文件夹-创建存放icon图标的文件" class="headerlink" title="步骤2：在src下创建icons文件夹(创建存放icon图标的文件)"></a>步骤2：在src下创建icons文件夹(创建存放icon图标的文件)</h2><blockquote>
<p>icons文件夹下面创建index.js<br>代码</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">SvgIcon</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/SvgIcon/index&#x27;</span><span class="comment">// svg component</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// register globally</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;svg-icon&#x27;</span>, <span class="title class_">SvgIcon</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> req = <span class="built_in">require</span>.<span class="title function_">context</span>(<span class="string">&#x27;./svg&#x27;</span>, <span class="literal">false</span>, <span class="regexp">/\.svg$/</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">requireAll</span> = requireContext =&gt; requireContext.<span class="title function_">keys</span>().<span class="title function_">map</span>(requireContext)</span><br><span class="line">requireAll(req)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>icons文件夹下面创建svg文件夹存放svg文件</p>
</blockquote>
<h2 id="步骤3：在src的components内创建SvgIcon组件文件夹"><a href="#步骤3：在src的components内创建SvgIcon组件文件夹" class="headerlink" title="步骤3：在src的components内创建SvgIcon组件文件夹"></a>步骤3：在src的components内创建SvgIcon组件文件夹</h2><blockquote>
<p>在SvgIcon组件文件夹下创建index.vue<br>完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-if=&quot;isExternal&quot; :style=&quot;styleExternalIcon&quot; class=&quot;svg-external-icon svg-icon&quot; v-on=&quot;$listeners&quot; /&gt;</span><br><span class="line">  &lt;svg v-else :class=&quot;svgClass&quot; aria-hidden=&quot;true&quot; v-on=&quot;$listeners&quot;&gt;</span><br><span class="line">    &lt;use :xlink:href=&quot;iconName&quot; /&gt;</span><br><span class="line">  &lt;/svg&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// doc: https://panjiachen.github.io/vue-element-admin-site/feature/component/svg-icon.html#usage</span><br><span class="line">import &#123; isExternal &#125; from &#x27;@/utils/validate&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;SvgIcon&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    iconClass: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      required: true</span><br><span class="line">    &#125;,</span><br><span class="line">    className: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    isExternal() &#123;</span><br><span class="line">      return isExternal(this.iconClass)</span><br><span class="line">    &#125;,</span><br><span class="line">    iconName() &#123;</span><br><span class="line">      return `#icon-$&#123;this.iconClass&#125;`</span><br><span class="line">    &#125;,</span><br><span class="line">    svgClass() &#123;</span><br><span class="line">      if (this.className) &#123;</span><br><span class="line">        return &#x27;svg-icon &#x27; + this.className</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        return &#x27;svg-icon&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    styleExternalIcon() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        mask: `url($&#123;this.iconClass&#125;) no-repeat 50% 50%`,</span><br><span class="line">        &#x27;-webkit-mask&#x27;: `url($&#123;this.iconClass&#125;) no-repeat 50% 50%`</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.svg-icon &#123;</span><br><span class="line">  width: 1em;</span><br><span class="line">  height: 1em;</span><br><span class="line">  vertical-align: -0.15em;</span><br><span class="line">  fill: currentColor;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.svg-external-icon &#123;</span><br><span class="line">  background-color: currentColor;</span><br><span class="line">  mask-size: cover!important;</span><br><span class="line">  display: inline-block;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤4：全局加载就可以了在main-js添加"><a href="#步骤4：全局加载就可以了在main-js添加" class="headerlink" title="步骤4：全局加载就可以了在main.js添加"></a>步骤4：全局加载就可以了在main.js添加</h2><blockquote>
<p>import ‘@&#x2F;icons&#x2F;index’</p>
</blockquote>
<h2 id="步骤5：vue-config-js添加配置"><a href="#步骤5：vue-config-js添加配置" class="headerlink" title="步骤5：vue.config.js添加配置"></a>步骤5：vue.config.js添加配置</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">chainWebpack</span>: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;svg&#x27;</span>)</span><br><span class="line">      .<span class="property">exclude</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">    config.<span class="property">module</span></span><br><span class="line">      .<span class="title function_">rule</span>(<span class="string">&#x27;icons&#x27;</span>)</span><br><span class="line">      .<span class="title function_">test</span>(<span class="regexp">/\.svg$/</span>)</span><br><span class="line">      .<span class="property">include</span>.<span class="title function_">add</span>(<span class="title function_">resolve</span>(<span class="string">&#x27;src/icons&#x27;</span>))</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">      .<span class="title function_">use</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">loader</span>(<span class="string">&#x27;svg-sprite-loader&#x27;</span>)</span><br><span class="line">      .<span class="title function_">options</span>(&#123;</span><br><span class="line">        <span class="attr">symbolId</span>: <span class="string">&#x27;icon-[name]&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">end</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤6：可以引入外部svg添加到icons文件夹下面svg文件夹存放svg文件"><a href="#步骤6：可以引入外部svg添加到icons文件夹下面svg文件夹存放svg文件" class="headerlink" title="步骤6：可以引入外部svg添加到icons文件夹下面svg文件夹存放svg文件"></a>步骤6：可以引入外部svg添加到icons文件夹下面svg文件夹存放svg文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 使用情况 --&gt;</span><br><span class="line">&lt;svg-icon class=&quot;svgicon&quot; :icon-class=&quot;&#x27;helpDescription&#x27;&quot; /&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>svg</tag>
      </tags>
  </entry>
  <entry>
    <title>h5页面底部端弹出日期选择</title>
    <url>/2023/01/24/73h5%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8%E7%AB%AF%E5%BC%B9%E5%87%BA%E6%97%A5%E6%9C%9F%E9%80%89%E6%8B%A9/</url>
    <content><![CDATA[<h1 id="h5页面底部端弹出日期选择"><a href="#h5页面底部端弹出日期选择" class="headerlink" title="h5页面底部端弹出日期选择"></a>h5页面底部端弹出日期选择</h1><h2 id="步骤1：在-x2F-static-x2F-js文件下添加datePicker-js文件"><a href="#步骤1：在-x2F-static-x2F-js文件下添加datePicker-js文件" class="headerlink" title="步骤1：在&#x2F;static&#x2F;js文件下添加datePicker.js文件"></a>步骤1：在&#x2F;static&#x2F;js文件下添加datePicker.js文件</h2><p>（文件路径可以执行设置）</p>
<h4 id="文件完整代码"><a href="#文件完整代码" class="headerlink" title="文件完整代码"></a>文件完整代码</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">datePicker</span> = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">MobileCalendar</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gearDate</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minY</span> = <span class="number">1900</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minM</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minD</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxY</span> = <span class="number">2099</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxM</span> = <span class="number">12</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxD</span> = <span class="number">31</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> cssHtm = <span class="string">&#x27;.gearYM,.gearDate,.gearDatetime,.gearTime&#123;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:10px;background-color:rgba(0,0,0,0.2);display:block;position:fixed;top:0;left:0;width:100%;height:100%;z-index:9900;overflow:hidden;-webkit-animation-fill-mode:both;animation-fill-mode:both&#125;.date_ctrl&#123;vertical-align:middle;background-color:#d5d8df;color:#000;margin:0;height:auto;width:100%;position:absolute;left:0;bottom:0;z-index:9901;overflow:hidden;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)&#125;.slideInUp&#123;animation:slideInUp .3s ease;-webkit-animation:slideInUp .3s ease;&#125;@-webkit-keyframes slideInUp&#123;from&#123;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)&#125;to&#123;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)&#125;&#125;.ym_roll,.date_roll,.datetime_roll,.time_roll&#123;display:-webkit-box;width:100%;height:auto;overflow:hidden;font-weight:bold;background-color:transparent;-webkit-mask:-webkit-gradient(linear,0% 50%,0% 100%,from(#debb47),to(rgba(36,142,36,0)));-webkit-mask:-webkit-linear-gradient(top,#debb47 50%,rgba(36,142,36,0))&#125;.ym_roll&gt;div,.date_roll&gt;div,.datetime_roll&gt;div,.time_roll&gt;div&#123;font-size:2.3em;height:6em;float:left;background-color:transparent;position:relative;overflow:hidden;-webkit-box-flex:4&#125;.ym_roll&gt;div .gear,.date_roll&gt;div .gear,.datetime_roll&gt;div .gear,.time_roll&gt;div .gear&#123;width:100%;float:left;position:absolute;z-index:9902;margin-top:-6em&#125;.date_roll_mask&#123;-webkit-mask:-webkit-gradient(linear,0% 40%,0% 0%,from(#debb47),to(rgba(36,142,36,0)));-webkit-mask:-webkit-linear-gradient(bottom,#debb47 50%,rgba(36,142,36,0));padding:0 0 3em 0&#125;.date_roll&gt;div:nth-child(2)&#123;-webkit-box-flex:2&#125;.date_roll&gt;div:nth-child(1),.datetime_roll&gt;div:nth-child(1)&#123;-webkit-box-flex:4&#125;.datetime_roll&gt;div:first-child&#123;-webkit-box-flex:6&#125;.datetime_roll&gt;div:last-child&#123;-webkit-box-flex:6&#125;.date_grid&#123;position:relative;top:2em;width:100%;height:2em;margin:0;box-sizing:border-box;z-index:0;border-top:1px solid #abaeb5;border-bottom:1px solid #abaeb5&#125;.date_grid&gt;div&#123;color:#000;position:absolute;right:0;top:0;font-size:.8em;line-height:2.5em&#125;.date_roll&gt;div:nth-child(3) .date_grid&gt;div&#123;left:42%&#125;.datetime_roll&gt;div .date_grid&gt;div&#123;right:0&#125;.datetime_roll&gt;div:first-child .date_grid&gt;div&#123;left:auto;right:0%&#125;.datetime_roll&gt;div:last-child .date_grid&gt;div&#123;left:50%&#125;.time_roll&gt;div:nth-child(1) .date_grid&gt;div&#123;right:1em&#125;.ym_roll&gt;div:nth-child(1) .date_grid&gt;div&#123;right:.1em&#125;.ym_roll&gt;div .date_grid&gt;div,.time_roll&gt;div .date_grid&gt;div&#123;right:5em&#125;.date_btn&#123;color:#0575f2;font-size:1.6em;font-weight:bold;line-height:1em;text-align:center;padding:.8em 1em&#125;.date_btn_box:before,.date_btn_box:after&#123;content:&quot;&quot;;position:absolute;height:1px;width:100%;display:block;background-color:#96979b;z-index:15;-webkit-transform:scaleY(0.33);transform:scaleY(0.33)&#125;.date_btn_box&#123;display:-webkit-box;-webkit-box-pack:justify;-webkit-box-align:stretch;background-color:#f1f2f4;position:relative&#125;.date_btn_box:before&#123;left:0;top:0;-webkit-transform-origin:50% 20%;transform-origin:50% 20%&#125;.date_btn_box:after&#123;left:0;bottom:0;-webkit-transform-origin:50% 70%;transform-origin:50% 70%&#125;.date_roll&gt;div:nth-child(1) .gear&#123;text-indent:20%&#125;.date_roll&gt;div:nth-child(2) .gear&#123;text-indent:-20%&#125;.date_roll&gt;div:nth-child(3) .gear&#123;text-indent:-55%&#125;.datetime_roll&gt;div .gear&#123;width:100%;text-indent:-25%&#125;.datetime_roll&gt;div:first-child .gear&#123;text-indent:-10%&#125;.datetime_roll&gt;div:last-child .gear&#123;text-indent:-50%&#125;.ym_roll&gt;div .gear,.time_roll&gt;div .gear&#123;width:100%;text-indent:-70%&#125;.ym_roll&gt;div:nth-child(1) .gear,.time_roll&gt;div:nth-child(1) .gear&#123;width:100%;text-indent:10%&#125;.tooth&#123;height:2em;line-height:2em;text-align:center&#125;&#x27;</span></span><br><span class="line">  <span class="keyword">var</span> cssEle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>)</span><br><span class="line">  cssEle.<span class="property">type</span> = <span class="string">&#x27;text/css&#x27;</span></span><br><span class="line">  cssEle.<span class="title function_">appendChild</span>(<span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(cssHtm))</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(cssEle)</span><br><span class="line"></span><br><span class="line">  <span class="title class_">MobileCalendar</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">type</span> = params.<span class="property">type</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">trigger</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(params.<span class="property">trigger</span>)</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">trigger</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-lcalendar&#x27;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> arr = <span class="variable language_">this</span>.<span class="property">trigger</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-lcalendar&#x27;</span>).<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> minArr = arr[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minY</span> = ~~minArr[<span class="number">0</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minM</span> = ~~minArr[<span class="number">1</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minD</span> = ~~minArr[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">var</span> maxArr = arr[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxY</span> = ~~maxArr[<span class="number">0</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxM</span> = ~~maxArr[<span class="number">1</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxD</span> = ~~maxArr[<span class="number">2</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (params.<span class="property">minDate</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> minArr = params.<span class="property">minDate</span>.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minY</span> = ~~minArr[<span class="number">0</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minM</span> = ~~minArr[<span class="number">1</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">minD</span> = ~~minArr[<span class="number">2</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (params.<span class="property">maxDate</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> maxArr = params.<span class="property">maxDate</span>.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxY</span> = ~~maxArr[<span class="number">0</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxM</span> = ~~maxArr[<span class="number">1</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxD</span> = ~~maxArr[<span class="number">2</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">onClose</span> = params.<span class="property">onClose</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">onSubmit</span> = params.<span class="property">onSubmit</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">onChange</span> = params.<span class="property">onChange</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">bindEvent</span>(<span class="variable language_">this</span>.<span class="property">type</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">bindEvent</span>: <span class="keyword">function</span> (<span class="params">type</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _self = <span class="variable language_">this</span></span><br><span class="line">      <span class="keyword">var</span> isTouched = <span class="literal">false</span>; <span class="keyword">var</span> isMoved = <span class="literal">false</span></span><br><span class="line">      <span class="keyword">var</span> pree</span><br><span class="line">      <span class="comment">// 呼出日期插件</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">popupDate</span> (e) &#123;</span><br><span class="line">        _self.<span class="property">gearDate</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">className</span> = <span class="string">&#x27;gearDate&#x27;</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;date_ctrl slideInUp&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn_box&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_cancel&quot;&gt;取消&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_finish&quot;&gt;确定&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll_mask&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_yy&quot; data-datetype=&quot;date_yy&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;年&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_mm&quot; data-datetype=&quot;date_mm&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;月&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_dd&quot; data-datetype=&quot;date_dd&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;日&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;date_bg&quot; style=&quot;width:100%;height:100%;&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">        <span class="title function_">dateCtrlInit</span>()</span><br><span class="line">        <span class="keyword">var</span> lcalendar_cancel = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_cancel&#x27;</span>)</span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_finish = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_finish&#x27;</span>)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, finishMobileDate)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_bg = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_bg&#x27;</span>)</span><br><span class="line">        lcalendar_bg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> date_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> date_dd = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// -------------------------------------------------------------</span></span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, finishMobileDate)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, gearTouchOut)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchOut)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 初始化年月日插件默认值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">dateCtrlInit</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="keyword">var</span> dateArr = &#123;</span><br><span class="line">          <span class="attr">yy</span>: date.<span class="title function_">getYear</span>(),</span><br><span class="line">          <span class="attr">mm</span>: date.<span class="title function_">getMonth</span>(),</span><br><span class="line">          <span class="attr">dd</span>: date.<span class="title function_">getDate</span>() - <span class="number">1</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;$/</span>.<span class="title function_">test</span>(_self.<span class="property">trigger</span>.<span class="property">value</span>)) &#123;</span><br><span class="line">          <span class="comment">/* rs = _self.trigger.value.match(/(^|-)\d&#123;1,4&#125;/g);</span></span><br><span class="line"><span class="comment">                  dateArr.yy = rs[0] - _self.minY;</span></span><br><span class="line"><span class="comment">                  dateArr.mm = rs[1].replace(/-/g, &quot;&quot;) - 1;</span></span><br><span class="line"><span class="comment">                  dateArr.dd = rs[2].replace(/-/g, &quot;&quot;) - 1;*/</span></span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125;</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">yy</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">mm</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">dd</span>)</span><br><span class="line">        <span class="title function_">setDateGearTooth</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 呼出年月插件</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">popupYM</span> (e) &#123;</span><br><span class="line">        _self.<span class="property">gearDate</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">className</span> = <span class="string">&#x27;gearDate&#x27;</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;date_ctrl slideInUp&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn_box&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_cancel&quot;&gt;取消&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_finish&quot;&gt;确定&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll_mask&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;ym_roll&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_yy&quot; data-datetype=&quot;date_yy&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;年&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_mm&quot; data-datetype=&quot;date_mm&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;月&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;date_bg&quot; style=&quot;width:100%;height:100%;&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">        <span class="title function_">ymCtrlInit</span>()</span><br><span class="line">        <span class="keyword">var</span> lcalendar_cancel = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_cancel&#x27;</span>)</span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_finish = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_finish&#x27;</span>)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, finishMobileYM)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_bg = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_bg&#x27;</span>)</span><br><span class="line">        lcalendar_bg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> date_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// -------------------------------------------------------------</span></span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, finishMobileYM)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, gearTouchOut)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchOut)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 初始化年月插件默认值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">ymCtrlInit</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="keyword">var</span> dateArr = &#123;</span><br><span class="line">          <span class="attr">yy</span>: date.<span class="title function_">getYear</span>(),</span><br><span class="line">          <span class="attr">mm</span>: date.<span class="title function_">getMonth</span>(),</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;$/</span>.<span class="title function_">test</span>(_self.<span class="property">trigger</span>.<span class="property">value</span>)) &#123;</span><br><span class="line">          rs = _self.<span class="property">trigger</span>.<span class="property">value</span>.<span class="title function_">match</span>(<span class="regexp">/(^|-)\d&#123;1,4&#125;/g</span>)</span><br><span class="line">          dateArr.<span class="property">yy</span> = rs[<span class="number">0</span>] - _self.<span class="property">minY</span></span><br><span class="line">          dateArr.<span class="property">mm</span> = rs[<span class="number">1</span>].<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&#x27;&#x27;</span>) - <span class="number">1</span></span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125;</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">yy</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">mm</span>)</span><br><span class="line">        <span class="title function_">setDateGearTooth</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 呼出年插件</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">popupY</span> (e) &#123;</span><br><span class="line">        _self.<span class="property">gearDate</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">className</span> = <span class="string">&#x27;gearDate&#x27;</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;date_ctrl slideInUp&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn_box&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_cancel&quot;&gt;取消&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_finish&quot;&gt;确定&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll_mask&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;ym_roll&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_yy&quot; data-datetype=&quot;date_yy&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;年&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;date_bg&quot; style=&quot;width:100%;height:100%;&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">        <span class="title function_">yCtrlInit</span>()</span><br><span class="line">        <span class="keyword">var</span> lcalendar_cancel = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_cancel&#x27;</span>)</span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_finish = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_finish&#x27;</span>)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, finishMobileY)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_bg = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_bg&#x27;</span>)</span><br><span class="line">        lcalendar_bg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">        <span class="comment">// var date_mm = _self.gearDate.querySelector(&quot;.date_mm&quot;);</span></span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;touchstart&#x27;, gearTouchStart);</span></span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;touchmove&#x27;, gearTouchMove);</span></span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;touchend&#x27;, gearTouchEnd);</span></span><br><span class="line">        <span class="comment">// -------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, finishMobileY)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;mousedown&#x27;, gearTouchStart);</span></span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;mousemove&#x27;, gearTouchMove);</span></span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// date_mm.addEventListener(&#x27;mouseup&#x27;, gearTouchEnd);</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, gearTouchOut)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchOut)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 初始化年插件默认值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">yCtrlInit</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="keyword">var</span> dateArr = &#123;</span><br><span class="line">          <span class="attr">yy</span>: date.<span class="title function_">getYear</span>(),</span><br><span class="line">          <span class="comment">// mm: date.getMonth()</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;$/</span>.<span class="title function_">test</span>(_self.<span class="property">trigger</span>.<span class="property">value</span>)) &#123;</span><br><span class="line">          <span class="comment">/* rs = _self.trigger.value.match(/(^|-)\d&#123;1,4&#125;/g);</span></span><br><span class="line"><span class="comment">                  dateArr.yy = rs[0] - _self.minY;*/</span></span><br><span class="line">          <span class="comment">// dateArr.mm = rs[1].replace(/-/g, &quot;&quot;) - 1;</span></span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125;</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">yy</span>)</span><br><span class="line">        <span class="comment">// _self.gearDate.querySelector(&quot;.date_mm&quot;).setAttribute(&quot;val&quot;, dateArr.mm);</span></span><br><span class="line">        <span class="title function_">setDateGearTooth</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 呼出日期+时间插件</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">popupDateTime</span> (e) &#123;</span><br><span class="line">        _self.<span class="property">gearDate</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">className</span> = <span class="string">&#x27;gearDatetime&#x27;</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;date_ctrl slideInUp&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn_box&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_cancel&quot;&gt;取消&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_finish&quot;&gt;确定&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll_mask&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;datetime_roll&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_yy&quot; data-datetype=&quot;date_yy&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;年&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_mm&quot; data-datetype=&quot;date_mm&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;月&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear date_dd&quot; data-datetype=&quot;date_dd&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;日&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear time_hh&quot; data-datetype=&quot;time_hh&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;时&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear time_mm&quot; data-datetype=&quot;time_mm&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;分&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> + <span class="comment">// date_roll</span></span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> + <span class="comment">// date_roll_mask</span></span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;date_bg&quot; style=&quot;width:100%;height:100%;&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">        <span class="title function_">dateTimeCtrlInit</span>()</span><br><span class="line">        <span class="keyword">var</span> lcalendar_cancel = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_cancel&#x27;</span>)</span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_finish = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_finish&#x27;</span>)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, finishMobileDateTime)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_bg = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_bg&#x27;</span>)</span><br><span class="line">        lcalendar_bg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> date_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> date_dd = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> time_hh = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> time_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// -------------------------------------------------------------</span></span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, finishMobileDateTime)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        date_yy.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        date_dd.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, gearTouchOut)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchOut)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 初始化年月日时分插件默认值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">dateTimeCtrlInit</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="keyword">var</span> dateArr = &#123;</span><br><span class="line">          <span class="attr">yy</span>: date.<span class="title function_">getYear</span>(),</span><br><span class="line">          <span class="attr">mm</span>: date.<span class="title function_">getMonth</span>(),</span><br><span class="line">          <span class="attr">dd</span>: date.<span class="title function_">getDate</span>() - <span class="number">1</span>,</span><br><span class="line">          <span class="attr">hh</span>: date.<span class="title function_">getHours</span>(),</span><br><span class="line">          <span class="attr">mi</span>: date.<span class="title function_">getMinutes</span>(),</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;\s\d&#123;2&#125;:\d&#123;2&#125;$/</span>.<span class="title function_">test</span>(_self.<span class="property">trigger</span>.<span class="property">value</span>)) &#123;</span><br><span class="line">          <span class="comment">/* rs = _self.trigger.value.match(/(^|-|\s|:)\d&#123;1,4&#125;/g);</span></span><br><span class="line"><span class="comment">                  dateArr.yy = rs[0] - _self.minY;</span></span><br><span class="line"><span class="comment">                  dateArr.mm = rs[1].replace(/-/g, &quot;&quot;) - 1;</span></span><br><span class="line"><span class="comment">                  dateArr.dd = rs[2].replace(/-/g, &quot;&quot;) - 1;</span></span><br><span class="line"><span class="comment">                  dateArr.hh = parseInt(rs[3].replace(/\s0?/g, &quot;&quot;));</span></span><br><span class="line"><span class="comment">                  dateArr.mi = parseInt(rs[4].replace(/:0?/g, &quot;&quot;));*/</span></span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          dateArr.<span class="property">yy</span> = dateArr.<span class="property">yy</span> + <span class="number">1900</span> - _self.<span class="property">minY</span></span><br><span class="line">        &#125;</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">yy</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">mm</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">dd</span>)</span><br><span class="line">        <span class="title function_">setDateGearTooth</span>()</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">hh</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, dateArr.<span class="property">mi</span>)</span><br><span class="line">        <span class="title function_">setTimeGearTooth</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 呼出时间插件</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">popupTime</span> (e) &#123;</span><br><span class="line">        _self.<span class="property">gearDate</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">className</span> = <span class="string">&#x27;gearDate&#x27;</span></span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;date_ctrl slideInUp&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn_box&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_cancel&quot;&gt;取消&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_btn lcalendar_finish&quot;&gt;确定&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_roll_mask&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;time_roll&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear time_hh&quot; data-datetype=&quot;time_hh&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;时&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;gear time_mm&quot; data-datetype=&quot;time_mm&quot;&gt;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div class=&quot;date_grid&quot;&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;div&gt;分&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> + <span class="comment">// time_roll</span></span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;date_bg&quot; style=&quot;width:100%;height:100%;&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">        <span class="title function_">timeCtrlInit</span>()</span><br><span class="line">        <span class="keyword">var</span> lcalendar_cancel = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_cancel&#x27;</span>)</span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_finish = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lcalendar_finish&#x27;</span>)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, finishMobileTime)</span><br><span class="line">        <span class="keyword">var</span> lcalendar_bg = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_bg&#x27;</span>)</span><br><span class="line">        lcalendar_bg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        <span class="keyword">var</span> time_hh = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> time_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, gearTouchEnd)</span><br><span class="line">        <span class="comment">// -------------------------------------------------------------</span></span><br><span class="line">        lcalendar_cancel.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, closeMobileCalendar)</span><br><span class="line">        lcalendar_finish.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, finishMobileTime)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, gearTouchStart)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, gearTouchMove)</span><br><span class="line">        time_hh.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        time_mm.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchEnd)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, gearTouchOut)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_roll_mask&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, gearTouchOut)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 初始化时分插件默认值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">timeCtrlInit</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="keyword">var</span> e = &#123;</span><br><span class="line">          <span class="attr">hh</span>: d.<span class="title function_">getHours</span>(),</span><br><span class="line">          <span class="attr">mm</span>: d.<span class="title function_">getMinutes</span>(),</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^\d&#123;2&#125;:\d&#123;2&#125;$/</span>.<span class="title function_">test</span>(_self.<span class="property">trigger</span>.<span class="property">value</span>)) &#123;</span><br><span class="line">          rs = _self.<span class="property">trigger</span>.<span class="property">value</span>.<span class="title function_">match</span>(<span class="regexp">/(^|:)\d&#123;2&#125;/g</span>)</span><br><span class="line">          e.<span class="property">hh</span> = <span class="built_in">parseInt</span>(rs[<span class="number">0</span>].<span class="title function_">replace</span>(<span class="regexp">/^0?/g</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">          e.<span class="property">mm</span> = <span class="built_in">parseInt</span>(rs[<span class="number">1</span>].<span class="title function_">replace</span>(<span class="regexp">/:0?/g</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, e.<span class="property">hh</span>)</span><br><span class="line">        _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, e.<span class="property">mm</span>)</span><br><span class="line">        <span class="title function_">setTimeGearTooth</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 重置日期节点个数</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">setDateGearTooth</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> itemStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> (date_yy &amp;&amp; date_yy.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)) &#123;</span><br><span class="line">          <span class="comment">// 得到年份的值</span></span><br><span class="line">          <span class="keyword">var</span> yyVal = <span class="built_in">parseInt</span>(date_yy.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">          <span class="comment">// p 当前节点前后需要展示的节点个数</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt;= passY - <span class="number">1</span>; p++) &#123;</span><br><span class="line">            itemStr += <span class="string">&quot;&lt;div class=&#x27;tooth&#x27;&gt;&quot;</span> + (_self.<span class="property">minY</span> + p) + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          date_yy.<span class="property">innerHTML</span> = itemStr</span><br><span class="line">          <span class="keyword">var</span> top = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="built_in">parseFloat</span>(date_yy.<span class="title function_">getAttribute</span>(<span class="string">&#x27;top&#x27;</span>)))</span><br><span class="line">          <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(top)) &#123;</span><br><span class="line">            top % <span class="number">2</span> == <span class="number">0</span> ? (top = top) : (top = top + <span class="number">1</span>)</span><br><span class="line">            top &gt; <span class="number">8</span> &amp;&amp; (top = <span class="number">8</span>)</span><br><span class="line">            <span class="keyword">var</span> minTop = <span class="number">8</span> - (passY - <span class="number">1</span>) * <span class="number">2</span></span><br><span class="line">            top &lt; minTop &amp;&amp; (top = minTop)</span><br><span class="line">            date_yy.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + top + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">            date_yy.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, top + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">            yyVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(top - <span class="number">8</span>) / <span class="number">2</span></span><br><span class="line">            date_yy.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, yyVal)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            date_yy.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + (<span class="number">8</span> - yyVal * <span class="number">2</span>) + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">            date_yy.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, <span class="number">8</span> - yyVal * <span class="number">2</span> + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> date_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (date_mm &amp;&amp; date_mm.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)) &#123;</span><br><span class="line">          itemStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">          <span class="comment">// 得到月份的值</span></span><br><span class="line">          <span class="keyword">var</span> mmVal = <span class="built_in">parseInt</span>(date_mm.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">          <span class="keyword">var</span> maxM = <span class="number">11</span></span><br><span class="line">          <span class="keyword">var</span> minM = <span class="number">0</span></span><br><span class="line">          <span class="comment">// 当年份到达最大值</span></span><br><span class="line">          <span class="keyword">if</span> (yyVal == passY - <span class="number">1</span>) &#123;</span><br><span class="line">            maxM = _self.<span class="property">maxM</span> - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 当年份到达最小值</span></span><br><span class="line">          <span class="keyword">if</span> (yyVal == <span class="number">0</span>) &#123;</span><br><span class="line">            minM = _self.<span class="property">minM</span> - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// p 当前节点前后需要展示的节点个数</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; maxM - minM + <span class="number">1</span>; p++) &#123;</span><br><span class="line">            itemStr += <span class="string">&quot;&lt;div class=&#x27;tooth&#x27;&gt;&quot;</span> + (minM + p + <span class="number">1</span>) + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          date_mm.<span class="property">innerHTML</span> = itemStr</span><br><span class="line">          <span class="keyword">if</span> (mmVal &gt; maxM) &#123;</span><br><span class="line">            mmVal = maxM</span><br><span class="line">            date_mm.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, mmVal)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mmVal &lt; minM) &#123;</span><br><span class="line">            mmVal = maxM</span><br><span class="line">            date_mm.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, mmVal)</span><br><span class="line">          &#125;</span><br><span class="line">          date_mm.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + (<span class="number">8</span> - (mmVal - minM) * <span class="number">2</span>) + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">          date_mm.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, <span class="number">8</span> - (mmVal - minM) * <span class="number">2</span> + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> date_dd = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (date_dd &amp;&amp; date_dd.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)) &#123;</span><br><span class="line">          itemStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">          <span class="comment">// 得到日期的值</span></span><br><span class="line">          <span class="keyword">var</span> ddVal = <span class="built_in">parseInt</span>(date_dd.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">          <span class="comment">// 返回月份的天数</span></span><br><span class="line">          <span class="keyword">var</span> maxMonthDays = <span class="title function_">calcDays</span>(yyVal, mmVal)</span><br><span class="line">          <span class="comment">// p 当前节点前后需要展示的节点个数</span></span><br><span class="line">          <span class="keyword">var</span> maxD = maxMonthDays - <span class="number">1</span></span><br><span class="line">          <span class="keyword">var</span> minD = <span class="number">0</span></span><br><span class="line">          <span class="comment">// 当年份月份到达最大值</span></span><br><span class="line">          <span class="keyword">if</span> (yyVal == passY - <span class="number">1</span> &amp;&amp; _self.<span class="property">maxM</span> == mmVal + <span class="number">1</span>) &#123;</span><br><span class="line">            maxD = _self.<span class="property">maxD</span> - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 当年、月到达最小值</span></span><br><span class="line">          <span class="keyword">if</span> (yyVal == <span class="number">0</span> &amp;&amp; _self.<span class="property">minM</span> == mmVal + <span class="number">1</span>) &#123;</span><br><span class="line">            minD = _self.<span class="property">minD</span> - <span class="number">1</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; maxD - minD + <span class="number">1</span>; p++) &#123;</span><br><span class="line">            itemStr += <span class="string">&quot;&lt;div class=&#x27;tooth&#x27;&gt;&quot;</span> + (minD + p + <span class="number">1</span>) + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          date_dd.<span class="property">innerHTML</span> = itemStr</span><br><span class="line">          <span class="keyword">if</span> (ddVal &gt; maxD) &#123;</span><br><span class="line">            ddVal = maxD</span><br><span class="line">            date_dd.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, ddVal)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ddVal &lt; minD) &#123;</span><br><span class="line">            ddVal = minD</span><br><span class="line">            date_dd.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, ddVal)</span><br><span class="line">          &#125;</span><br><span class="line">          date_dd.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + (<span class="number">8</span> - (ddVal - minD) * <span class="number">2</span>) + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">          date_dd.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, <span class="number">8</span> - (ddVal - minD) * <span class="number">2</span> + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 重置时间节点个数</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">setTimeGearTooth</span> () &#123;</span><br><span class="line">        <span class="keyword">var</span> time_hh = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (time_hh &amp;&amp; time_hh.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)) &#123;</span><br><span class="line">          <span class="keyword">var</span> i = <span class="string">&#x27;&#x27;</span></span><br><span class="line">          <span class="keyword">var</span> hhVal = <span class="built_in">parseInt</span>(time_hh.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> g = <span class="number">0</span>; g &lt;= <span class="number">23</span>; g++) &#123;</span><br><span class="line">            i += <span class="string">&quot;&lt;div class=&#x27;tooth&#x27;&gt;&quot;</span> + g + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          time_hh.<span class="property">innerHTML</span> = i</span><br><span class="line">          time_hh.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + (<span class="number">8</span> - hhVal * <span class="number">2</span>) + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">          time_hh.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, <span class="number">8</span> - hhVal * <span class="number">2</span> + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> time_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (time_mm &amp;&amp; time_mm.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)) &#123;</span><br><span class="line">          <span class="keyword">var</span> i = <span class="string">&#x27;&#x27;</span></span><br><span class="line">          <span class="keyword">var</span> mmVal = <span class="built_in">parseInt</span>(time_mm.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> g = <span class="number">0</span>; g &lt;= <span class="number">59</span>; g++) &#123;</span><br><span class="line">            i += <span class="string">&quot;&lt;div class=&#x27;tooth&#x27;&gt;&quot;</span> + g + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          time_mm.<span class="property">innerHTML</span> = i</span><br><span class="line">          time_mm.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + (<span class="number">8</span> - mmVal * <span class="number">2</span>) + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">          time_mm.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, <span class="number">8</span> - mmVal * <span class="number">2</span> + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 求月份最大天数</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">calcDays</span> (year, month) &#123;</span><br><span class="line">        <span class="keyword">if</span> (month == <span class="number">1</span>) &#123;</span><br><span class="line">          year += _self.<span class="property">minY</span></span><br><span class="line">          <span class="keyword">if</span> ((year % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; year % <span class="number">100</span> != <span class="number">0</span>) || (year % <span class="number">400</span> == <span class="number">0</span> &amp;&amp; year % <span class="number">4000</span> != <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">29</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">28</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (month == <span class="number">3</span> || month == <span class="number">5</span> || month == <span class="number">8</span> || month == <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">30</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">31</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 触摸开始</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">gearTouchStart</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isMoved || isTouched) <span class="keyword">return</span></span><br><span class="line">        isTouched = <span class="literal">true</span></span><br><span class="line">        e.<span class="title function_">preventDefault</span>()</span><br><span class="line">        <span class="keyword">var</span> target = e.<span class="property">target</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;gear&#x27;</span>)) &#123;</span><br><span class="line">            target = target.<span class="property">parentElement</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">        target[<span class="string">&#x27;old_&#x27;</span> + target.<span class="property">id</span>] = e.<span class="property">targetTouches</span> ? e.<span class="property">targetTouches</span>[<span class="number">0</span>].<span class="property">screenY</span> : e.<span class="property">pageY</span></span><br><span class="line">        target[<span class="string">&#x27;o_t_&#x27;</span> + target.<span class="property">id</span>] = (<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">getTime</span>()</span><br><span class="line">        <span class="keyword">var</span> top = target.<span class="title function_">getAttribute</span>(<span class="string">&#x27;top&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (top) &#123;</span><br><span class="line">          target[<span class="string">&#x27;o_d_&#x27;</span> + target.<span class="property">id</span>] = <span class="built_in">parseFloat</span>(top.<span class="title function_">replace</span>(<span class="regexp">/em/g</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          target[<span class="string">&#x27;o_d_&#x27;</span> + target.<span class="property">id</span>] = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        pree = e</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 手指移动</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">gearTouchMove</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isTouched) <span class="keyword">return</span></span><br><span class="line">        isMoved = <span class="literal">true</span></span><br><span class="line">        e.<span class="title function_">preventDefault</span>()</span><br><span class="line">        <span class="keyword">if</span> (pree) <span class="keyword">var</span> target = pree.<span class="property">target</span>; <span class="keyword">else</span> &#123; <span class="keyword">var</span> target = e.<span class="property">target</span> &#125;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;gear&#x27;</span>)) &#123;</span><br><span class="line">            target = target.<span class="property">parentElement</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        target[<span class="string">&#x27;new_&#x27;</span> + target.<span class="property">id</span>] = e.<span class="property">targetTouches</span> ? e.<span class="property">targetTouches</span>[<span class="number">0</span>].<span class="property">screenY</span> : e.<span class="property">pageY</span></span><br><span class="line">        target[<span class="string">&#x27;n_t_&#x27;</span> + target.<span class="property">id</span>] = (<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">getTime</span>()</span><br><span class="line">        <span class="comment">// var f = (target[&quot;new_&quot; + target.id] - target[&quot;old_&quot; + target.id]) * 18 / target.clientHeight;</span></span><br><span class="line">        <span class="keyword">var</span> f = (target[<span class="string">&#x27;new_&#x27;</span> + target.<span class="property">id</span>] - target[<span class="string">&#x27;old_&#x27;</span> + target.<span class="property">id</span>]) * <span class="number">18</span> / <span class="number">370</span></span><br><span class="line">        target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>] = target[<span class="string">&#x27;o_d_&#x27;</span> + target.<span class="property">id</span>] + f</span><br><span class="line">        target.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>] + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">        target.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>] + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 离开屏幕</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">gearTouchEnd</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isTouched || !isMoved) &#123;</span><br><span class="line">          isTouched = isMoved = <span class="literal">false</span></span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        isTouched = isMoved = <span class="literal">false</span></span><br><span class="line">        e.<span class="title function_">preventDefault</span>()</span><br><span class="line">        <span class="keyword">if</span> (pree) <span class="keyword">var</span> target = pree.<span class="property">target</span>; <span class="keyword">else</span> &#123; <span class="keyword">var</span> target = e.<span class="property">target</span> &#125;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;gear&#x27;</span>)) &#123;</span><br><span class="line">            target = target.<span class="property">parentElement</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> flag = (target[<span class="string">&#x27;new_&#x27;</span> + target.<span class="property">id</span>] - target[<span class="string">&#x27;old_&#x27;</span> + target.<span class="property">id</span>]) / (target[<span class="string">&#x27;n_t_&#x27;</span> + target.<span class="property">id</span>] - target[<span class="string">&#x27;o_t_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(flag) &lt;= <span class="number">0.2</span>) &#123;</span><br><span class="line">          target[<span class="string">&#x27;spd_&#x27;</span> + target.<span class="property">id</span>] = (flag &lt; <span class="number">0</span> ? -<span class="number">0.08</span> : <span class="number">0.08</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(flag) &lt;= <span class="number">0.5</span>) &#123;</span><br><span class="line">            target[<span class="string">&#x27;spd_&#x27;</span> + target.<span class="property">id</span>] = (flag &lt; <span class="number">0</span> ? -<span class="number">0.16</span> : <span class="number">0.16</span>)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[<span class="string">&#x27;spd_&#x27;</span> + target.<span class="property">id</span>] = flag / <span class="number">2</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>]) &#123;</span><br><span class="line">          target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>] = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">rollGear</span>(target)</span><br><span class="line">        pree = <span class="literal">null</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 离开区域</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">gearTouchOut</span> (e) &#123;</span><br><span class="line">        <span class="title function_">gearTouchEnd</span>(pree)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 缓动效果</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">rollGear</span> (target) &#123;</span><br><span class="line">        <span class="keyword">var</span> d = <span class="number">0</span></span><br><span class="line">        <span class="keyword">var</span> stopGear = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">        target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>] = <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> pos = target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>]</span><br><span class="line">          <span class="keyword">var</span> speed = target[<span class="string">&#x27;spd_&#x27;</span> + target.<span class="property">id</span>] * <span class="title class_">Math</span>.<span class="title function_">exp</span>(-<span class="number">0.1</span> * d)</span><br><span class="line">          pos += speed</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(speed) &gt; <span class="number">0.1</span>) &#123; &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            speed = <span class="number">0.1</span></span><br><span class="line">            <span class="keyword">var</span> b = <span class="title class_">Math</span>.<span class="title function_">round</span>(pos / <span class="number">2</span>) * <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - b) &lt; <span class="number">0.05</span>) &#123;</span><br><span class="line">              stopGear = <span class="literal">true</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (pos &gt; b) &#123;</span><br><span class="line">                pos -= speed</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                pos += speed</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (pos &gt; <span class="number">8</span>) &#123;</span><br><span class="line">            pos = <span class="number">8</span></span><br><span class="line">            stopGear = <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">switch</span> (target.<span class="property">dataset</span>.<span class="property">datetype</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;date_yy&#x27;</span>:</span><br><span class="line">              <span class="keyword">var</span> minTop = <span class="number">8</span> - (passY - <span class="number">1</span>) * <span class="number">2</span></span><br><span class="line">              <span class="keyword">if</span> (pos &lt; minTop) &#123;</span><br><span class="line">                pos = minTop</span><br><span class="line">                stopGear = <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (stopGear) &#123;</span><br><span class="line">                <span class="keyword">var</span> gearVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - <span class="number">8</span>) / <span class="number">2</span></span><br><span class="line">                <span class="title function_">setGear</span>(target, gearVal)</span><br><span class="line">                <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;date_mm&#x27;</span>:</span><br><span class="line">              <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">              <span class="comment">// 得到年份的值</span></span><br><span class="line">              <span class="keyword">var</span> yyVal = <span class="built_in">parseInt</span>(date_yy.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">              <span class="keyword">var</span> maxM = <span class="number">11</span></span><br><span class="line">              <span class="keyword">var</span> minM = <span class="number">0</span></span><br><span class="line">              <span class="comment">// 当年份到达最大值</span></span><br><span class="line">              <span class="keyword">if</span> (yyVal == passY - <span class="number">1</span>) &#123;</span><br><span class="line">                maxM = _self.<span class="property">maxM</span> - <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="comment">// 当年份到达最小值</span></span><br><span class="line">              <span class="keyword">if</span> (yyVal == <span class="number">0</span>) &#123;</span><br><span class="line">                minM = _self.<span class="property">minM</span> - <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">var</span> minTop = <span class="number">8</span> - (maxM - minM) * <span class="number">2</span></span><br><span class="line">              <span class="keyword">if</span> (pos &lt; minTop) &#123;</span><br><span class="line">                pos = minTop</span><br><span class="line">                stopGear = <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (stopGear) &#123;</span><br><span class="line">                <span class="keyword">var</span> gearVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - <span class="number">8</span>) / <span class="number">2</span> + minM</span><br><span class="line">                <span class="title function_">setGear</span>(target, gearVal)</span><br><span class="line">                <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;date_dd&#x27;</span>:</span><br><span class="line">              <span class="keyword">var</span> date_yy = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>)</span><br><span class="line">              <span class="keyword">var</span> date_mm = _self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>)</span><br><span class="line">              <span class="comment">// 得到年份的值</span></span><br><span class="line">              <span class="keyword">var</span> yyVal = <span class="built_in">parseInt</span>(date_yy.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">              <span class="comment">// 得到月份的值</span></span><br><span class="line">              <span class="keyword">var</span> mmVal = <span class="built_in">parseInt</span>(date_mm.<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))</span><br><span class="line">              <span class="comment">// 返回月份的天数</span></span><br><span class="line">              <span class="keyword">var</span> maxMonthDays = <span class="title function_">calcDays</span>(yyVal, mmVal)</span><br><span class="line">              <span class="keyword">var</span> maxD = maxMonthDays - <span class="number">1</span></span><br><span class="line">              <span class="keyword">var</span> minD = <span class="number">0</span></span><br><span class="line">              <span class="comment">// 当年份月份到达最大值</span></span><br><span class="line">              <span class="keyword">if</span> (yyVal == passY - <span class="number">1</span> &amp;&amp; _self.<span class="property">maxM</span> == mmVal + <span class="number">1</span>) &#123;</span><br><span class="line">                maxD = _self.<span class="property">maxD</span> - <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="comment">// 当年、月到达最小值</span></span><br><span class="line">              <span class="keyword">if</span> (yyVal == <span class="number">0</span> &amp;&amp; _self.<span class="property">minM</span> == mmVal + <span class="number">1</span>) &#123;</span><br><span class="line">                minD = _self.<span class="property">minD</span> - <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">var</span> minTop = <span class="number">8</span> - (maxD - minD) * <span class="number">2</span></span><br><span class="line">              <span class="keyword">if</span> (pos &lt; minTop) &#123;</span><br><span class="line">                pos = minTop</span><br><span class="line">                stopGear = <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (stopGear) &#123;</span><br><span class="line">                <span class="keyword">var</span> gearVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - <span class="number">8</span>) / <span class="number">2</span> + minD</span><br><span class="line">                <span class="title function_">setGear</span>(target, gearVal)</span><br><span class="line">                <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;time_hh&#x27;</span>:</span><br><span class="line">              <span class="keyword">if</span> (pos &lt; -<span class="number">38</span>) &#123;</span><br><span class="line">                pos = -<span class="number">38</span></span><br><span class="line">                stopGear = <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (stopGear) &#123;</span><br><span class="line">                <span class="keyword">var</span> gearVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - <span class="number">8</span>) / <span class="number">2</span></span><br><span class="line">                <span class="title function_">setGear</span>(target, gearVal)</span><br><span class="line">                <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;time_mm&#x27;</span>:</span><br><span class="line">              <span class="keyword">if</span> (pos &lt; -<span class="number">110</span>) &#123;</span><br><span class="line">                pos = -<span class="number">110</span></span><br><span class="line">                stopGear = <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (stopGear) &#123;</span><br><span class="line">                <span class="keyword">var</span> gearVal = <span class="title class_">Math</span>.<span class="title function_">abs</span>(pos - <span class="number">8</span>) / <span class="number">2</span></span><br><span class="line">                <span class="title function_">setGear</span>(target, gearVal)</span><br><span class="line">                <span class="built_in">clearInterval</span>(target[<span class="string">&#x27;int_&#x27;</span> + target.<span class="property">id</span>])</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">          &#125;</span><br><span class="line">          target[<span class="string">&#x27;pos_&#x27;</span> + target.<span class="property">id</span>] = pos</span><br><span class="line">          target.<span class="property">style</span>[<span class="string">&#x27;-webkit-transform&#x27;</span>] = <span class="string">&#x27;translate3d(0,&#x27;</span> + pos + <span class="string">&#x27;em,0)&#x27;</span></span><br><span class="line">          target.<span class="title function_">setAttribute</span>(<span class="string">&#x27;top&#x27;</span>, pos + <span class="string">&#x27;em&#x27;</span>)</span><br><span class="line">          d++</span><br><span class="line">        &#125;, <span class="number">30</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 控制插件滚动后停留的值</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">setGear</span> (target, val) &#123;</span><br><span class="line">        val = <span class="title class_">Math</span>.<span class="title function_">round</span>(val)</span><br><span class="line">        target.<span class="title function_">setAttribute</span>(<span class="string">&#x27;val&#x27;</span>, val)</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/date/</span>.<span class="title function_">test</span>(target.<span class="property">dataset</span>.<span class="property">datetype</span>)) &#123;</span><br><span class="line">          <span class="title function_">setDateGearTooth</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">setTimeGearTooth</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 取消</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">closeMobileCalendar</span> (e) &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>()</span><br><span class="line">        isTouched = isMoved = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onClose</span>) _self.<span class="title function_">onClose</span>()</span><br><span class="line">        <span class="keyword">var</span> evt = <span class="keyword">new</span> <span class="title class_">CustomEvent</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="title function_">dispatchEvent</span>(evt)</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(_self.<span class="property">gearDate</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 日期确认</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">finishMobileDate</span> (e) &#123;</span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">var</span> date_yy = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        <span class="keyword">var</span> date_mm = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))) + <span class="number">1</span></span><br><span class="line">        date_mm = date_mm &gt; <span class="number">9</span> ? date_mm : <span class="string">&#x27;0&#x27;</span> + date_mm</span><br><span class="line">        <span class="keyword">var</span> date_dd = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))) + <span class="number">1</span></span><br><span class="line">        date_dd = date_dd &gt; <span class="number">9</span> ? date_dd : <span class="string">&#x27;0&#x27;</span> + date_dd</span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="property">value</span> = (date_yy % passY + _self.<span class="property">minY</span>) + <span class="string">&#x27;-&#x27;</span> + date_mm + <span class="string">&#x27;-&#x27;</span> + date_dd</span><br><span class="line">        _self.<span class="property">value</span> = _self.<span class="property">trigger</span>.<span class="property">value</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onSubmit</span>) _self.<span class="title function_">onSubmit</span>()</span><br><span class="line">        <span class="title function_">closeMobileCalendar</span>(e)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 年月确认</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">finishMobileYM</span> (e) &#123;</span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">var</span> date_yy = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        <span class="keyword">var</span> date_mm = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))) + <span class="number">1</span></span><br><span class="line">        date_mm = date_mm &gt; <span class="number">9</span> ? date_mm : <span class="string">&#x27;0&#x27;</span> + date_mm</span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="property">value</span> = (date_yy % passY + _self.<span class="property">minY</span>) + <span class="string">&#x27;-&#x27;</span> + date_mm</span><br><span class="line">        _self.<span class="property">value</span> = _self.<span class="property">trigger</span>.<span class="property">value</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onSubmit</span>) _self.<span class="title function_">onSubmit</span>()</span><br><span class="line">        <span class="title function_">closeMobileCalendar</span>(e)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 年月确认</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">finishMobileY</span> (e) &#123;</span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">var</span> date_yy = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        <span class="comment">// var date_mm = parseInt(Math.round(_self.gearDate.querySelector(&quot;.date_mm&quot;).getAttribute(&quot;val&quot;))) + 1;</span></span><br><span class="line">        <span class="comment">// date_mm = date_mm &gt; 9 ? date_mm : &#x27;0&#x27; + date_mm;</span></span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="property">value</span> = (date_yy % passY + _self.<span class="property">minY</span>)</span><br><span class="line">        _self.<span class="property">value</span> = _self.<span class="property">trigger</span>.<span class="property">value</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onSubmit</span>) _self.<span class="title function_">onSubmit</span>()</span><br><span class="line">        <span class="title function_">closeMobileCalendar</span>(e)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 日期时间确认</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">finishMobileDateTime</span> (e) &#123;</span><br><span class="line">        <span class="keyword">var</span> passY = _self.<span class="property">maxY</span> - _self.<span class="property">minY</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">var</span> date_yy = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_yy&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        <span class="keyword">var</span> date_mm = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_mm&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))) + <span class="number">1</span></span><br><span class="line">        date_mm = date_mm &gt; <span class="number">9</span> ? date_mm : <span class="string">&#x27;0&#x27;</span> + date_mm</span><br><span class="line">        <span class="keyword">var</span> date_dd = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.date_dd&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>))) + <span class="number">1</span></span><br><span class="line">        date_dd = date_dd &gt; <span class="number">9</span> ? date_dd : <span class="string">&#x27;0&#x27;</span> + date_dd</span><br><span class="line">        <span class="keyword">var</span> time_hh = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        time_hh = time_hh &gt; <span class="number">9</span> ? time_hh : <span class="string">&#x27;0&#x27;</span> + time_hh</span><br><span class="line">        <span class="keyword">var</span> time_mm = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        time_mm = time_mm &gt; <span class="number">9</span> ? time_mm : <span class="string">&#x27;0&#x27;</span> + time_mm</span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="property">value</span> = (date_yy % passY + _self.<span class="property">minY</span>) + <span class="string">&#x27;-&#x27;</span> + date_mm + <span class="string">&#x27;-&#x27;</span> + date_dd + <span class="string">&#x27; &#x27;</span> + (time_hh.<span class="property">length</span> &lt; <span class="number">2</span> ? <span class="string">&#x27;0&#x27;</span> : <span class="string">&#x27;&#x27;</span>) + time_hh + (time_mm.<span class="property">length</span> &lt; <span class="number">2</span> ? <span class="string">&#x27;:0&#x27;</span> : <span class="string">&#x27;:&#x27;</span>) + time_mm</span><br><span class="line">        _self.<span class="property">value</span> = _self.<span class="property">trigger</span>.<span class="property">value</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onSubmit</span>) _self.<span class="title function_">onSubmit</span>()</span><br><span class="line">        <span class="title function_">closeMobileCalendar</span>(e)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 时间确认</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">finishMobileTime</span> (e) &#123;</span><br><span class="line">        <span class="keyword">var</span> time_hh = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_hh&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        time_hh = time_hh &gt; <span class="number">9</span> ? time_hh : <span class="string">&#x27;0&#x27;</span> + time_hh</span><br><span class="line">        <span class="keyword">var</span> time_mm = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(_self.<span class="property">gearDate</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.time_mm&#x27;</span>).<span class="title function_">getAttribute</span>(<span class="string">&#x27;val&#x27;</span>)))</span><br><span class="line">        time_mm = time_mm &gt; <span class="number">9</span> ? time_mm : <span class="string">&#x27;0&#x27;</span> + time_mm</span><br><span class="line">        _self.<span class="property">trigger</span>.<span class="property">value</span> = (time_hh.<span class="property">length</span> &lt; <span class="number">2</span> ? <span class="string">&#x27;0&#x27;</span> : <span class="string">&#x27;&#x27;</span>) + time_hh + (time_mm.<span class="property">length</span> &lt; <span class="number">2</span> ? <span class="string">&#x27;:0&#x27;</span> : <span class="string">&#x27;:&#x27;</span>) + time_mm</span><br><span class="line">        _self.<span class="property">value</span> = _self.<span class="property">trigger</span>.<span class="property">value</span></span><br><span class="line">        <span class="keyword">if</span> (_self.<span class="property">onSubmit</span>) _self.<span class="title function_">onSubmit</span>()</span><br><span class="line">        <span class="title function_">closeMobileCalendar</span>(e)</span><br><span class="line">      &#125;</span><br><span class="line">      _self.<span class="property">trigger</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;ym&#x27;</span>: popupYM,</span><br><span class="line">        <span class="string">&#x27;date&#x27;</span>: popupDate,</span><br><span class="line">        <span class="string">&#x27;datetime&#x27;</span>: popupDateTime,</span><br><span class="line">        <span class="string">&#x27;time&#x27;</span>: popupTime,</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: popupY,</span><br><span class="line"></span><br><span class="line">      &#125;[type])</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">MobileCalendar</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：全局注册在main-js中引入"><a href="#步骤2：全局注册在main-js中引入" class="headerlink" title="步骤2：全局注册在main.js中引入"></a>步骤2：全局注册在main.js中引入</h2><blockquote>
<p>import datePicker from “..&#x2F;static&#x2F;js&#x2F;datePicker.js”  &#x2F;&#x2F;路径自己设置<br>Vue.use(datePicker)</p>
</blockquote>
<h2 id="步骤3：使用操作"><a href="#步骤3：使用操作" class="headerlink" title="步骤3：使用操作"></a>步骤3：使用操作</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;input id=&quot;demo&quot; type=&quot;text&quot; placeholder=&quot;选择出生日期&quot; readonly&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!-- 备注：需要更改样式在js里面更改 --&gt;</span><br><span class="line">   mounted() &#123;</span><br><span class="line">    this.datePicker(); //加载日期选择控件</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    datePicker() &#123;</span><br><span class="line">      var calendar = new datePicker();</span><br><span class="line">      calendar.init(&#123;</span><br><span class="line">        trigger: &quot;#demo&quot; /*按钮选择器，用于触发弹出插件*/,</span><br><span class="line">        type:</span><br><span class="line">          &quot;date&quot; /*模式：date日期；datetime日期时间；time时间；ym年月；year:年*/,</span><br><span class="line">        minDate: &quot;1900-1-1&quot; /*最小日期*/,</span><br><span class="line">        maxDate: &quot;2100-12-31&quot; /*最大日期*/,</span><br><span class="line">        onSubmit: function() &#123;</span><br><span class="line">          /*确认时触发事件*/</span><br><span class="line">          var theSelectData = calendar.value;</span><br><span class="line">        &#125;,</span><br><span class="line">        onClose: function() &#123;</span><br><span class="line">          /*取消时触发事件*/</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>h5</tag>
      </tags>
  </entry>
  <entry>
    <title>动态生成树节点图</title>
    <url>/2023/02/09/75%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E6%A0%91%E8%8A%82%E7%82%B9%E5%9B%BE/</url>
    <content><![CDATA[<h1 id="动态生成树节点图"><a href="#动态生成树节点图" class="headerlink" title="动态生成树节点图"></a>动态生成树节点图</h1><blockquote>
<p>效果及说明文档：<a href="http://www.longstudy.club/vue-okr-tree-doc/index.html">http://www.longstudy.club/vue-okr-tree-doc/index.html</a></p>
</blockquote>
<h2 id="步骤1：下载组件文件把lib文件夹下载到本地的components下"><a href="#步骤1：下载组件文件把lib文件夹下载到本地的components下" class="headerlink" title="步骤1：下载组件文件把lib文件夹下载到本地的components下"></a>步骤1：下载组件文件把lib文件夹下载到本地的components下</h2><blockquote>
<p><a href="https://github.com/husky-dot/vue-okr-tree">https://github.com/husky-dot/vue-okr-tree</a></p>
</blockquote>
<h2 id="步骤2：组件引入"><a href="#步骤2：组件引入" class="headerlink" title="步骤2：组件引入"></a>步骤2：组件引入</h2><blockquote>
<p>import VueOkrTree from ‘@&#x2F;components&#x2F;vue-okr-tree&#x2F;vue-okr-tree&#x2F;OkrTree.vue’</p>
</blockquote>
<h2 id="步骤3：注册"><a href="#步骤3：注册" class="headerlink" title="步骤3：注册"></a>步骤3：注册</h2><blockquote>
<p>components: {<br>    VueOkrTree<br>  },</p>
</blockquote>
<h2 id="步骤4：使用"><a href="#步骤4：使用" class="headerlink" title="步骤4：使用"></a>步骤4：使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;VueOkrTree :data=&quot;testData&quot; direction=&quot;horizontal&quot; show-collapsable /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 测试数据 --&gt;</span><br><span class="line">testData: [&#123;</span><br><span class="line">        label: &#x27;xxx科技有有限公司&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;产品研发部&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;研发-前端&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;研发-后端&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;UI 设计&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;销售部&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;销售一部&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;销售二部&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;财务部&#x27;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>树节点</tag>
      </tags>
  </entry>
  <entry>
    <title>rsa加密</title>
    <url>/2023/02/13/76rsa%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<h1 id="rsa加密"><a href="#rsa加密" class="headerlink" title="rsa加密"></a>rsa加密</h1><h2 id="需求添加用户名密码加密请求传送"><a href="#需求添加用户名密码加密请求传送" class="headerlink" title="需求添加用户名密码加密请求传送"></a>需求添加用户名密码加密请求传送</h2><blockquote>
<p>使用rsa进行加密</p>
</blockquote>
<h2 id="前提准备下载依赖"><a href="#前提准备下载依赖" class="headerlink" title="前提准备下载依赖"></a>前提准备下载依赖</h2><blockquote>
<p>npm i jsencrypt encryptlong</p>
</blockquote>
<h2 id="步骤1：在utils文件夹下添加rsa-js文件"><a href="#步骤1：在utils文件夹下添加rsa-js文件" class="headerlink" title="步骤1：在utils文件夹下添加rsa.js文件"></a>步骤1：在utils文件夹下添加rsa.js文件</h2><blockquote>
<p>完整代码（公钥秘钥根据后端提供自行替换）</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 产引入jsencrypt实现数据RSA加密 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import Rsa from &#x27;@/utils/rsa.js&#x27;</span></span><br><span class="line"><span class="comment">// Vue.prototype.Rsa = Rsa // 将Rsa注册为公共方法,方便其他页面调用</span></span><br><span class="line"><span class="comment">//依赖</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JSEncrypt</span> <span class="keyword">from</span> <span class="string">&#x27;jsencrypt&#x27;</span> <span class="comment">// 处理长文本数据时报错 jsencrypt.js Message too long for RSA</span></span><br><span class="line"><span class="comment">/* 产引入encryptlong实现数据RSA加密 */</span></span><br><span class="line"><span class="comment">//依赖</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Encrypt</span> <span class="keyword">from</span> <span class="string">&#x27;encryptlong&#x27;</span> <span class="comment">// encryptlong是基于jsencrypt扩展的长文本分段加解密功能。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 密钥对生成 http://web.chacuo.net/netrsakeypair</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 公钥key</span></span><br><span class="line"><span class="keyword">const</span> publicKey = <span class="string">&#x27;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCW/82VijXZ2Gwtphmar1FxJkujSL31HbL5dFXLfVr4irEbKI2/JvhuX8ui7JmrSAuBZUZPCzkddgxJ3T8JUIbt5MH5CltDDlOjPeqdwgVGSLWcDdPf07K+LDjFRN9RrwCs8J/91KCZiHjdY06YWucLxhikM1G7fSuvYR1ISxuaiwIDAQAB&#x27;</span></span><br><span class="line"><span class="comment">// 私钥key</span></span><br><span class="line"><span class="keyword">const</span> privateKey = <span class="string">&#x27;MIIBUwIBADANBgkqhkiG9w0BAQEFAASCAT0wggE5AgEAAkEA0vfvyTdGJkdbHkB8\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;mp0f3FE0GYP3AYPaJF7jUd1M0XxFSE2ceK3k2kw20YvQ09NJKk+OMjWQl9WitG9p\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;B6tSCQIDAQABAkA2SimBrWC2/wvauBuYqjCFwLvYiRYqZKThUS3MZlebXJiLB+Ue\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;/gUifAAKIg1avttUZsHBHrop4qfJCwAI0+YRAiEA+W3NK/RaXtnRqmoUUkb59zsZ\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;UBLpvZgQPfj1MhyHDz0CIQDYhsAhPJ3mgS64NbUZmGWuuNKp5coY2GIj/zYDMJp6\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;vQIgUueLFXv/eZ1ekgz2Oi67MNCk5jeTF2BurZqNLR3MSmUCIFT3Q6uHMtsB9Eha\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;4u7hS31tj1UWE+D+ADzp59MGnoftAiBeHT7gDMuqeJHPL4b+kC+gzV4FGTfhR9q3\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;tTbklZkD2A==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">/* JSEncrypt加密 */</span></span><br><span class="line">  rsaPublicData (data) &#123;</span><br><span class="line">    <span class="keyword">var</span> jsencrypt = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>()</span><br><span class="line">    jsencrypt.<span class="title function_">setPublicKey</span>(publicKey)</span><br><span class="line">    <span class="comment">// 如果是对象/数组的话，需要先JSON.stringify转换成字符串</span></span><br><span class="line">    <span class="keyword">var</span> result = jsencrypt.<span class="title function_">encrypt</span>(data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/* JSEncrypt解密 */</span></span><br><span class="line">  rsaPrivateData (data) &#123;</span><br><span class="line">    <span class="keyword">var</span> jsencrypt = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>()</span><br><span class="line">    jsencrypt.<span class="title function_">setPrivateKey</span>(privateKey)</span><br><span class="line">    <span class="comment">// 如果是对象/数组的话，需要先JSON.stringify转换成字符串</span></span><br><span class="line">    <span class="keyword">var</span> result = jsencrypt.<span class="title function_">encrypt</span>(data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/* 加密 */</span></span><br><span class="line">  encrypt (data) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">PUBLIC_KEY</span> = publicKey</span><br><span class="line">    <span class="keyword">var</span> encryptor = <span class="keyword">new</span> <span class="title class_">Encrypt</span>()</span><br><span class="line">    encryptor.<span class="title function_">setPublicKey</span>(<span class="variable constant_">PUBLIC_KEY</span>)</span><br><span class="line">    <span class="comment">// 如果是对象/数组的话，需要先JSON.stringify转换成字符串</span></span><br><span class="line">    <span class="keyword">const</span> result = encryptor.<span class="title function_">encryptLong</span>(data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/* 解密 - PRIVATE_KEY - 验证 */</span></span><br><span class="line">  decrypt (data) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">PRIVATE_KEY</span> = privateKey</span><br><span class="line">    <span class="keyword">var</span> encryptor = <span class="keyword">new</span> <span class="title class_">Encrypt</span>()</span><br><span class="line">    encryptor.<span class="title function_">setPrivateKey</span>(<span class="variable constant_">PRIVATE_KEY</span>)</span><br><span class="line">    <span class="comment">// 如果是对象/数组的话，需要先JSON.stringify转换成字符串</span></span><br><span class="line">    <span class="keyword">var</span> result = encryptor.<span class="title function_">decryptLong</span>(data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="步骤2：在main-js将Rsa注册为公共方法-方便其他页面调用"><a href="#步骤2：在main-js将Rsa注册为公共方法-方便其他页面调用" class="headerlink" title="步骤2：在main.js将Rsa注册为公共方法,方便其他页面调用"></a>步骤2：在main.js将Rsa注册为公共方法,方便其他页面调用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Rsa</span> <span class="keyword">from</span> <span class="string">&#x27;@/utils/rsa.js&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">Rsa</span> = <span class="title class_">Rsa</span></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：使用"><a href="#步骤3：使用" class="headerlink" title="步骤3：使用"></a>步骤3：使用</h2><blockquote>
<p>this.Rsa.rsaPublicData(password)</p>
</blockquote>
]]></content>
      <tags>
        <tag>加密</tag>
      </tags>
  </entry>
  <entry>
    <title>前端快速生成CHANGELOG文件记录git提交版本说明</title>
    <url>/2023/02/27/79%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E7%94%9F%E6%88%90CHANGELOG%E6%96%87%E4%BB%B6%E8%AE%B0%E5%BD%95git%E6%8F%90%E4%BA%A4%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E/</url>
    <content><![CDATA[<h1 id="前端快速生成CHANGELOG文件记录git提交版本说明"><a href="#前端快速生成CHANGELOG文件记录git提交版本说明" class="headerlink" title="前端快速生成CHANGELOG文件记录git提交版本说明"></a>前端快速生成CHANGELOG文件记录git提交版本说明</h1><h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><p>前端快速生成CHANGELOG文件<br><a href="https://juejin.cn/post/7108606930079186951#heading-6">https://juejin.cn/post/7108606930079186951#heading-6</a></p>
<blockquote>
<p>npm install -g commitizen<br>npm install -g conventional-changelog-cli<br>npm install -g standard-version<br>commitizen init cz-conventional-changelog –save-dev –save-exact</p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><p>在package.json文件内script标签下配置脚本运行命令行<br>&#x2F;&#x2F; package.json 中添加生成changeLog的脚本<br>“changeLog”:”conventional-changelog -p angular -i CHANGELOG.md -s</p>
<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><p>git add . 提交全部改动<br>git cz 提交message格式<br>git push</p>
<p>安装了standard-version，通过 standard-version 运行生成CHANGELOG文档。<br>typetype含义feat本次提交了一个新需求 、功能。fix本次修复了一个bug 。docs本次修改了文档方面的内容style本次只是修改了代码的格式refactor重构代码，不是bug和新功能perf本次修改提高了性能test新增测试或者修改测试build修改了外部依赖，包括系统构建ci修改了CI文件chore辅助工具修改 src、docs、test文件之外的改动revert回退提交</p>
]]></content>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>VUE展示JSON格式数据界面(日志界面vue-json-viewer)</title>
    <url>/2023/02/24/78VUE%E5%B1%95%E7%A4%BAJSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%95%8C%E9%9D%A2/</url>
    <content><![CDATA[<h1 id="VUE展示JSON格式数据界面-日志界面vue-json-viewer"><a href="#VUE展示JSON格式数据界面-日志界面vue-json-viewer" class="headerlink" title="VUE展示JSON格式数据界面(日志界面vue-json-viewer)"></a>VUE展示JSON格式数据界面(日志界面vue-json-viewer)</h1><h2 id="需求某界面的日志展示在包含之间的关系时可以折叠起来"><a href="#需求某界面的日志展示在包含之间的关系时可以折叠起来" class="headerlink" title="需求某界面的日志展示在包含之间的关系时可以折叠起来"></a>需求某界面的日志展示在包含之间的关系时可以折叠起来</h2><blockquote>
<p>使用vue-json-viewer进行数据处理</p>
</blockquote>
<h2 id="前提准备下载依赖"><a href="#前提准备下载依赖" class="headerlink" title="前提准备下载依赖"></a>前提准备下载依赖</h2><blockquote>
<p>npm i vue-json-viewer</p>
</blockquote>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><blockquote>
<p>完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;json-viewer</span><br><span class="line">      v-show=&quot;testData &amp;&amp; JSON.stringify(testData) !== &#x27;&#123;&#125;&#x27;&quot;</span><br><span class="line">      id=&quot;json-viewer&quot;</span><br><span class="line">      :value=&quot;testData&quot;</span><br><span class="line">      :expand-depth=&quot;5&quot;</span><br><span class="line">      expanded</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import JsonViewer from &#x27;vue-json-viewer&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    JsonViewer</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      testData: [&#123;</span><br><span class="line">        label: &#x27;xxx科技有有限公司&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          label: &#x27;产品研发部&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;研发-前端&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;研发-后端&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;UI 设计&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;销售部&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            label: &#x27;销售一部&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            label: &#x27;销售二部&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          label: &#x27;财务部&#x27;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box &#123;&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p><img src="/2023/02/24/78VUE%E5%B1%95%E7%A4%BAJSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%95%8C%E9%9D%A2/01.png"></p>
]]></content>
      <tags>
        <tag>JSON</tag>
      </tags>
  </entry>
  <entry>
    <title>crypto-js加密</title>
    <url>/2023/02/14/77crypto-js%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<h1 id="crypto-js加密"><a href="#crypto-js加密" class="headerlink" title="crypto-js加密"></a>crypto-js加密</h1><h2 id="需求添加用户名密码加密请求传送"><a href="#需求添加用户名密码加密请求传送" class="headerlink" title="需求添加用户名密码加密请求传送"></a>需求添加用户名密码加密请求传送</h2><blockquote>
<p>使用crypto-js进行加密</p>
</blockquote>
<h2 id="前提准备下载依赖"><a href="#前提准备下载依赖" class="headerlink" title="前提准备下载依赖"></a>前提准备下载依赖</h2><blockquote>
<p>npm i crypto-js</p>
</blockquote>
<h2 id="步骤1：在utils文件夹下添加rsa-js文件"><a href="#步骤1：在utils文件夹下添加rsa-js文件" class="headerlink" title="步骤1：在utils文件夹下添加rsa.js文件"></a>步骤1：在utils文件夹下添加rsa.js文件</h2><blockquote>
<p>完整代码（公钥秘钥根据后端提供自行替换）</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">CryptoJS</span> <span class="keyword">from</span> <span class="string">&#x27;crypto-js&#x27;</span>;</span><br><span class="line"><span class="comment">// 密钥</span></span><br><span class="line"><span class="keyword">const</span> aseKey = <span class="string">&#x27;Rw52cml9Vpg8qaX6&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">//随机生成指定数量的16进制key</span></span><br><span class="line">  <span class="title function_">generatekey</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> library = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> key = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">      <span class="keyword">let</span> randomPoz = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * library.<span class="property">length</span>);</span><br><span class="line">      key += library.<span class="title function_">substring</span>(randomPoz, randomPoz + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> key;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">//加密</span></span><br><span class="line">  <span class="title function_">encrypt</span>(<span class="params">word</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> key = <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey);</span><br><span class="line">    <span class="keyword">var</span> srcs = <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(word);</span><br><span class="line">    <span class="keyword">var</span> encrypted = <span class="title class_">CryptoJS</span>.<span class="property">AES</span>.<span class="title function_">encrypt</span>(srcs, key, &#123; <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>, <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> encrypted.<span class="title function_">toString</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//解密</span></span><br><span class="line">  <span class="title function_">decrypt</span>(<span class="params">word</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> key = <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey);</span><br><span class="line">    <span class="keyword">var</span> decrypt = <span class="title class_">CryptoJS</span>.<span class="property">AES</span>.<span class="title function_">decrypt</span>(word, key, &#123; <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>, <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">stringify</span>(decrypt).<span class="title function_">toString</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤2：在main-js将Rsa注册为公共方法-方便其他页面调用"><a href="#步骤2：在main-js将Rsa注册为公共方法-方便其他页面调用" class="headerlink" title="步骤2：在main.js将Rsa注册为公共方法,方便其他页面调用"></a>步骤2：在main.js将Rsa注册为公共方法,方便其他页面调用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Encryption</span> <span class="keyword">from</span> <span class="string">&#x27;@/utils/encryption&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="步骤3：使用"><a href="#步骤3：使用" class="headerlink" title="步骤3：使用"></a>步骤3：使用</h2><blockquote>
<p>加密<br>Encryption.encrypt(this.loginForm.password)</p>
</blockquote>
]]></content>
      <tags>
        <tag>加密</tag>
      </tags>
  </entry>
  <entry>
    <title>高德地图的key、安全秘钥设置</title>
    <url>/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/</url>
    <content><![CDATA[<h1 id="高德地图的key、安全秘钥设置"><a href="#高德地图的key、安全秘钥设置" class="headerlink" title="高德地图的key、安全秘钥设置"></a>高德地图的key、安全秘钥设置</h1><h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><blockquote>
<p>进入高德地图开发平台：<a href="https://lbs.amap.com/">https://lbs.amap.com/</a><br>没有注册的可以先注册一下</p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><blockquote>
<p>鼠标悬停右上角点击进入应用管理<br><img src="/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/01.png"></p>
</blockquote>
<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>在我的应用点击添加key<br><img src="/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/02.png"></p>
</blockquote>
<h2 id="步骤4："><a href="#步骤4：" class="headerlink" title="步骤4："></a>步骤4：</h2><blockquote>
<p>根据自己项目需求完成添加key内容<br><img src="/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/03.png"></p>
</blockquote>
<h2 id="步骤5："><a href="#步骤5：" class="headerlink" title="步骤5："></a>步骤5：</h2><blockquote>
<p>完成便可在列表上查看key、安全秘钥<br><img src="/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/04.png"></p>
</blockquote>
]]></content>
      <tags>
        <tag>高德地图</tag>
      </tags>
  </entry>
  <entry>
    <title>高德地图选址@amap/amap-jsapi-loader</title>
    <url>/2023/03/13/82%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E9%80%89%E5%9D%80amap/</url>
    <content><![CDATA[<h1 id="高德地图选址-amap-x2F-amap-jsapi-loader"><a href="#高德地图选址-amap-x2F-amap-jsapi-loader" class="headerlink" title="高德地图选址@amap&#x2F;amap-jsapi-loader"></a>高德地图选址@amap&#x2F;amap-jsapi-loader</h1><h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><blockquote>
<p>在某页面需要添加一个地图选址的界面<br>运用@amap&#x2F;amap-jsapi-loader和高德开发平台完成该需求的开发</p>
</blockquote>
<h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><blockquote>
<p>需要先在高德开发平台申请key和安全秘钥<br>本人已有记录过怎么申请可查看教程:<a href="https://wanggjie.github.io/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/">https://wanggjie.github.io/2023/03/12/81%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E7%94%B3%E8%AF%B7key/</a></p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><blockquote>
<p>下载依赖：npm i @amap&#x2F;amap-jsapi-loader</p>
</blockquote>
<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>在components下封装amap.vue组件<br>下面是完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"> * @Author: @hjj</span><br><span class="line"> * @Data: Do not edit</span><br><span class="line"> * @LastEditTime: 2022-09-23 11:06:18</span><br><span class="line"> * @LastEditors: @hjj</span><br><span class="line"> * @Description:</span><br><span class="line"> * @FilePath: \fish-farm-web\src\components\themap\MapContainer.vue</span><br><span class="line">--&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-autocomplete</span><br><span class="line">      v-model=&quot;keyword&quot;</span><br><span class="line">      value-key=&quot;name&quot;</span><br><span class="line">      :fetch-suggestions=&quot;handleAuto&quot;</span><br><span class="line">      placeholder=&quot;请输入关键字搜索&quot;</span><br><span class="line">      :trigger-on-focus=&quot;false&quot;</span><br><span class="line">      clearable</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      @select=&quot;handleSelect&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;template slot=&quot;prepend&quot;&gt;关键字&lt;/template&gt;</span><br><span class="line">      &lt;!-- &lt;el-button slot=&quot;append&quot; icon=&quot;el-icon-search&quot; @click=&quot;handleSearch&quot;&gt;&lt;/el-button&gt; --&gt;</span><br><span class="line">    &lt;/el-autocomplete&gt;</span><br><span class="line">    &lt;!-- &lt;el-input id=&quot;tipinput&quot; v-model=&quot;keyword&quot; value-key=&quot;nsrmc&quot; auto-complete=&quot;on&quot; :fetch-suggestions=&quot;handleAuto&quot; placeholder=&quot;请输入关键字搜索&quot;&gt;</span><br><span class="line">      &lt;template slot=&quot;prepend&quot;&gt;关键字&lt;/template&gt;</span><br><span class="line">      &lt;el-button slot=&quot;append&quot; icon=&quot;el-icon-search&quot; @click=&quot;handleSearch&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-input&gt; --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;container&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;el-row :gutter=&quot;10&quot; style=&quot;margin-top: 30px&quot;&gt;</span><br><span class="line">      &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.address&quot; readonly&gt;</span><br><span class="line">          &lt;template slot=&quot;prepend&quot;&gt;地址&lt;/template&gt;</span><br><span class="line">        &lt;/el-input&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">      &lt;el-col :span=&quot;6&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.longitude&quot; readonly&gt;</span><br><span class="line">          &lt;template slot=&quot;prepend&quot;&gt;经度&lt;/template&gt;</span><br><span class="line">        &lt;/el-input&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">      &lt;el-col :span=&quot;6&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.latitude&quot; readonly&gt;</span><br><span class="line">          &lt;template slot=&quot;prepend&quot;&gt;纬度&lt;/template&gt;</span><br><span class="line">        &lt;/el-input&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AMapLoader from &#x27;@amap/amap-jsapi-loader&#x27;</span><br><span class="line">let map = null</span><br><span class="line">let AMapObj = null</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#x27;地点选择&#x27;,</span><br><span class="line">      open: false,</span><br><span class="line">      keyword: &#x27;&#x27;,</span><br><span class="line">      placeSearch: null,</span><br><span class="line">      auto: null,</span><br><span class="line">      // AMapObj: null,</span><br><span class="line">      marker: null,</span><br><span class="line">      geocoder: null,</span><br><span class="line">      form: &#123;</span><br><span class="line">        address: &#x27;&#x27;,</span><br><span class="line">        longitude: undefined,</span><br><span class="line">        latitude: undefined</span><br><span class="line">      &#125;,</span><br><span class="line">      autoOptions: &#123;</span><br><span class="line">        input: &#x27;tipinput&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.open = true</span><br><span class="line">    this.initMap()</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    // DOM初始化完成进行地图初始化</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    show() &#123;</span><br><span class="line">      this.open = true</span><br><span class="line">      this.initMap()</span><br><span class="line">    &#125;,</span><br><span class="line">    initMap() &#123;</span><br><span class="line">      AMapLoader.load(&#123;</span><br><span class="line">        key: &#x27;9f42ea8e9681a3c50e5a86e3cd639d98&#x27;, // 申请好的Web端开发者Key，首次调用 load 时必填</span><br><span class="line">        version: &#x27;2.0&#x27;, // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15</span><br><span class="line">        plugins: [&#x27;&#x27;] // 需要使用的的插件列表，如比例尺&#x27;AMap.Scale&#x27;等</span><br><span class="line">      &#125;).then((AMap) =&gt; &#123;</span><br><span class="line">        AMapObj = AMap</span><br><span class="line">        map = new AMap.Map(&#x27;container&#x27;, &#123; // 设置地图容器id</span><br><span class="line">          viewMode: &#x27;3D&#x27;, // 是否为3D地图模式</span><br><span class="line">          zoom: 12 // 初始化地图级别</span><br><span class="line">        &#125;)</span><br><span class="line">        map.on(&#x27;click&#x27;, this.onMapClick) // 点击事件监听</span><br><span class="line">        AMap.plugin(</span><br><span class="line">          [&#x27;AMap.ToolBar&#x27;, &#x27;AMap.Scale&#x27;, &#x27;AMap.Geolocation&#x27;, &#x27;AMap.AutoComplete&#x27;, &#x27;AMap.PlaceSearch&#x27;, &#x27;AMap.Geocoder&#x27;],</span><br><span class="line">          () =&gt; &#123;</span><br><span class="line">            // 缩放条</span><br><span class="line">            const toolbar = new AMap.ToolBar()</span><br><span class="line">            // 比例尺</span><br><span class="line">            const scale = new AMap.Scale()</span><br><span class="line">            // 定位</span><br><span class="line">            const geolocation = new AMap.Geolocation(&#123;</span><br><span class="line">              enableHighAccuracy: true, // 是否使用高精度定位，默认:true</span><br><span class="line">              timeout: 10000, // 超过10秒后停止定位，默认：5s</span><br><span class="line">              position: &#x27;RT&#x27;, // 定位按钮的停靠位置</span><br><span class="line">              buttonOffset: new AMap.Pixel(10, 20), // 定位按钮与设置的停靠位置的偏移量，默认：Pixel(10, 20)</span><br><span class="line">              zoomToAccuracy: true // 定位成功后是否自动调整地图视野到定位点</span><br><span class="line">            &#125;)</span><br><span class="line">            this.geocoder = new AMap.Geocoder(&#123;</span><br><span class="line">              city: &#x27;全国&#x27;</span><br><span class="line">            &#125;)</span><br><span class="line">            map.addControl(geolocation)</span><br><span class="line">            map.addControl(toolbar)</span><br><span class="line">            map.addControl(scale)</span><br><span class="line">            this.auto = new AMap.AutoComplete(this.autoOptions)</span><br><span class="line">            // this.auto.on(&#x27;select&#x27;, (e)=&gt;&#123;</span><br><span class="line">            //   console.log(e);</span><br><span class="line">            // &#125;)</span><br><span class="line">            this.placeSearch = new AMap.PlaceSearch(&#123;</span><br><span class="line">              map: map,</span><br><span class="line">              city: &#x27;&#x27;,</span><br><span class="line">              pageSize: 30, // 单页显示结果条数</span><br><span class="line">              pageIndex: 1, // 页码</span><br><span class="line">              citylimit: false, // 是否强制限制在设置的城市内搜索</span><br><span class="line">              autoFitView: true</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        )</span><br><span class="line">      &#125;).catch(e =&gt; &#123;</span><br><span class="line">        console.log(e)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    onMapClick(e) &#123;</span><br><span class="line">      const &#123; lnglat: &#123; lat, lng &#125;&#125; = e</span><br><span class="line">      const lnglat = [lng, lat]</span><br><span class="line">      this.form[&#x27;longitude&#x27;] = lng</span><br><span class="line">      this.form[&#x27;latitude&#x27;] = lat</span><br><span class="line">      console.log(&#x27;onMapClick&#x27;, e, lnglat, this.geocoder)</span><br><span class="line">      this.geocoder.getAddress(lnglat, (status, res) =&gt; &#123;</span><br><span class="line">        console.log(status, res)</span><br><span class="line">        if (status === &#x27;complete&#x27; &amp;&amp; res.info === &#x27;OK&#x27;) &#123;</span><br><span class="line">          // result为对应的地理位置详细信息</span><br><span class="line">          console.log(res)</span><br><span class="line">          this.form[&#x27;address&#x27;] = res.regeocode.formattedAddress</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      if (this.marker) &#123;</span><br><span class="line">        map.remove(this.marker)</span><br><span class="line">      &#125;</span><br><span class="line">      this.marker = new AMapObj.Marker(&#123;</span><br><span class="line">        position: new AMapObj.LngLat(lng, lat) // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]</span><br><span class="line">      &#125;)</span><br><span class="line">      map.add(this.marker)</span><br><span class="line">    &#125;,</span><br><span class="line">    submitForm() &#123;</span><br><span class="line">      this.$emit(&#x27;ok&#x27;, this.form)</span><br><span class="line">      this.cancel()</span><br><span class="line">    &#125;,</span><br><span class="line">    cancel() &#123;</span><br><span class="line">      this.open = false</span><br><span class="line">      this.form = &#123;</span><br><span class="line">        address: &#x27;&#x27;,</span><br><span class="line">        longitude: undefined,</span><br><span class="line">        latitude: undefined</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleAuto(queryString, cb) &#123;</span><br><span class="line">      this.auto.search(queryString, (status, result) =&gt; &#123;</span><br><span class="line">        console.log(result)</span><br><span class="line">        if (JSON.stringify(result) !== &#x27;&#123;&#125;&#x27;) &#123;</span><br><span class="line">          cb(result.tips)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          cb([])</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSelect(item) &#123;</span><br><span class="line">      console.log(item)</span><br><span class="line">      const &#123; district, address, location: &#123; lat, lng &#125;&#125; = item</span><br><span class="line">      this.form.address = district + address</span><br><span class="line">      this.form.latitude = lat</span><br><span class="line">      this.form.longitude = lng</span><br><span class="line">      this.handleSearch(item.adcode, item.name)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSearch(adcode, name) &#123;</span><br><span class="line">      if (adcode) &#123;</span><br><span class="line">        this.placeSearch.setCity(adcode, (status, result) =&gt; &#123;</span><br><span class="line">          console.log(&#x27;setCity&#x27;, status, result)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      this.placeSearch.search(name, (status, result) =&gt; &#123;</span><br><span class="line">        console.log(&#x27;search&#x27;, status, result)</span><br><span class="line">        // if (status == &#x27;complete &#x27;) &#123;</span><br><span class="line">        //   let resObj = result.poiList.pois[0]</span><br><span class="line">        //   const &#123; pname, cityname, adname, address, location: &#123; lat, lng &#125; &#125; = resObj</span><br><span class="line">        //   this.form.address = pname + cityname + adname + address</span><br><span class="line">        //   this.form.latitude = lat</span><br><span class="line">        //   this.form.longitude = lng</span><br><span class="line">        // &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#container &#123;</span><br><span class="line">  padding: 0px;</span><br><span class="line">  margin: 0px;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 500px;</span><br><span class="line">  margin-top: 30px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="步骤4："><a href="#步骤4：" class="headerlink" title="步骤4："></a>步骤4：</h2><blockquote>
<p>设置自己的key、安全秘钥</p>
</blockquote>
<h3 id="4-1-设置key"><a href="#4-1-设置key" class="headerlink" title="4-1:设置key"></a>4-1:设置key</h3><blockquote>
<p>在amap.vue组件设置自己预先在高德开发平台申请的key<br><img src="/2023/03/13/82%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E9%80%89%E5%9D%80amap/03.png"></p>
</blockquote>
<h3 id="4-2-设置安全秘钥"><a href="#4-2-设置安全秘钥" class="headerlink" title="4-2:设置安全秘钥"></a>4-2:设置安全秘钥</h3><blockquote>
<p>在public下的index.html下添加以下代码</p>
<script type="text/javascript">
      window._AMapSecurityConfig = {
        securityJsCode: "03ef515823abb04f1e6fdbea532bd68d",
      };
    </script>
<p><img src="/2023/03/13/82%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E9%80%89%E5%9D%80amap/02.png"></p>
</blockquote>
<h2 id="步骤5：使用"><a href="#步骤5：使用" class="headerlink" title="步骤5：使用"></a>步骤5：使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;amap /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import amap from &#x27;@/components/amap.vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    amap</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.box &#123;&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p><img src="/2023/03/13/82%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E9%80%89%E5%9D%80amap/01.png"></p>
]]></content>
      <tags>
        <tag>高德地图</tag>
      </tags>
  </entry>
  <entry>
    <title>W3C盒模型和IE盒模型间的问题</title>
    <url>/2023/03/15/83%E8%A7%A3%E5%86%B3%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B%E9%97%B4%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="W3C盒模型和IE盒模型间的问题"><a href="#W3C盒模型和IE盒模型间的问题" class="headerlink" title="W3C盒模型和IE盒模型间的问题"></a>W3C盒模型和IE盒模型间的问题</h1><h2 id="W3C盒模型"><a href="#W3C盒模型" class="headerlink" title="W3C盒模型"></a>W3C盒模型</h2><p>首先看一下《 the W3C box model》，这里所写出的标准，如果没问题的话，是应该被所有标准的现代浏览器及IE6和它的后续版本所遵循的。在W3C盒模型中，一个块级元素的总宽度按照如下的方程式计算：</p>
<p>总宽度 &#x3D; margin-left + border-left + padding-left + width + padding-right + border-right + margin-right</p>
<p>对于高度也使用同样的计算方法，但是为了简便起见从现在开始我只说width。</p>
<h2 id="IE盒模型"><a href="#IE盒模型" class="headerlink" title="IE盒模型"></a>IE盒模型</h2><p>IE盒模型的计算方式和W3C的很相似，但有一点是非常不同的，这就是：填充和边框并不被包含在计算的范围内。</p>
<p>总宽度 &#x3D; margin-left + width + margin-right</p>
<p>这就意味着一旦元素拥有横向的填充和&#x2F;或边框，实际的内容区域（content area ）就要扩大来创造出他们占据的空间。</p>
<h2 id="关于IE的版本"><a href="#关于IE的版本" class="headerlink" title="关于IE的版本"></a>关于IE的版本</h2><p>IE5.5及更早的版本使用的是IE盒模型。很多人似乎没注意到IE6及更新的版本在标准兼容模式（standards compliant mode）下使用的是W3C的盒模型标准。我们说这是一个好消息因为这意味着此盒模型问题只会出现在IE5.5及其更早的版本中。只要为文档设置一个DOCTYPE，就会使得IE遵循标准兼容模式的方式工作。</p>
<h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><p>现在确定了IE6及后续版本都会遵循标准兼容模式，那现在唯一要关注的事情就是如何令IE5.5及更早版本中的网页和其在更现代的浏览器中呈现出的是一致的。如果你目前就遇到了这个问题，那么下面的几个方法会帮助到你，我以我的喜好为它们列出了优先顺序。</p>
<p>避免导致这个问题的情景<br>插入额外的标记<br>使用条件注释判断语句<br>使用CSS hacks<br>因为这个由盒模型解析方式不同导致的问题往往只是针对表象上的显示，所以我个人偏好的方法就是尽量避免不去触发IE5.*&#x2F;Win的这个BUG，而有些时候会不可避免的遇到，那我就会使用下面介绍的方法中的一个。</p>
<h3 id="1-避免导致这个问题的情景"><a href="#1-避免导致这个问题的情景" class="headerlink" title="1.避免导致这个问题的情景"></a>1.避免导致这个问题的情景</h3><p>这是我的首选，很简单，就是避免为一个元素同时设置width和padding值或者width和border值，再或者width同时和它们两个值。这确保了所有的浏览器都会一样的去计算元素的总宽度，而不用考虑它们使用哪种盒模型方式。</p>
<p>我这里拿一个例子说明，下面的HTML用来定义一个新闻列表：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;news&quot;&gt;</span><br><span class="line">  &lt;h2&gt;News&lt;/h2&gt;</span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;li&gt;</span><br><span class="line">      &lt;h3&gt;News article 1&lt;/h3&gt;</span><br><span class="line">      &lt;p&gt;Lorem ipsum dolor sit amet&lt;/p&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">    &lt;li&gt;</span><br><span class="line">      &lt;h3&gt;News article 2&lt;/h3&gt;</span><br><span class="line">      &lt;p&gt;Lorem ipsum dolor sit amet&lt;/p&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>为了得到一个250像素宽的列表，且应用1像素的边框和10像素的填充，会用到这样的CSS：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#news</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding</span>:<span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> solid;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>:<span class="number">228px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在符合标准的浏览器中，总宽度是250像素（1px left border + 10px left padding + width + 10px right padding + 1px right border）。但在IE5.5及更早的版本中，总宽度只是228像素，因为它并未计算边框和填充的值。</p>
<p>那么该如何避免这个问题呢？让我们假设新闻列表在另一个容器里，比如它在侧边栏（sidebar）里：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;sidebar&quot;&gt;</span><br><span class="line">  &lt;div id=&quot;news&quot;&gt;</span><br><span class="line">    ...</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>如果是这样，你可以为父容器（sidebar）设置宽度来达到效果：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#sidebar</span> &#123;<span class="attribute">width</span>:<span class="number">250px</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#news</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding</span>:<span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> solid;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-插入额外的标记"><a href="#2-插入额外的标记" class="headerlink" title="2.插入额外的标记"></a>2.插入额外的标记</h3><p>如果情况不容许你使用第一种方法，那可以使用插入额外的标记这个方法。还是使用前面那个例子，这次我们在#news里面插入一个标记：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;news&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &lt;h2&gt;News&lt;/h2&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      ...</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>使用如下的CSS：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#news</span> &#123;<span class="attribute">width</span>:<span class="number">250px</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#news</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding</span>:<span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> solid;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>外层的元素提供宽度，包含在里面的元素提供边框和填充。</p>
<p>是否使用一个额外标记这种妥协式的方式的决定权在于开发者本身。避免使用这种方式的好处是显而易见的，但是一个额外的div标签除了会增加文件的体积和降低代码的可维护性之外，不会产生其他的不良影响。它不会影响到页面的无障碍性以及当CSS文档不存在的时候文档的可阅读性。此外，增加一个额外的标记还会为某些设计上的实现提供便利条件。</p>
<h3 id="3-使用条件注释判断语句"><a href="#3-使用条件注释判断语句" class="headerlink" title="3.使用条件注释判断语句"></a>3.使用条件注释判断语句</h3><p>如果没有合适的父容器来控制宽度也不能通过添加额外的标记解决问题，那针对IE 5.*&#x2F;Win我们就需要设置一个不同的width值了。</p>
<p>我的建议，这么做最安全的方式就是使用条件注释判断语句（conditional comments,）这些内容只能在IE&#x2F;Win中被解析，下面的代码只有在IE6以下的版本中被执行：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;!--<span class="selector-attr">[if lt IE 6]</span>&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">  <span class="selector-id">#news</span> &#123;<span class="attribute">width</span>:<span class="number">250px</span>&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;!<span class="selector-attr">[endif]</span>--&gt;</span><br><span class="line">如果你打算使用这个方法，我建议将全部的针对IE <span class="number">5</span>.*/Win的代码都转移到一个单独的CSS文件中来加载它：</span><br><span class="line"></span><br><span class="line">&lt;!--<span class="selector-attr">[if lt IE 6]</span>&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/ie5<span class="selector-class">.css</span>&quot;&gt;</span><br><span class="line">&lt;!<span class="selector-attr">[endif]</span>--&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-使用CSS-hacks"><a href="#4-使用CSS-hacks" class="headerlink" title="4.使用CSS hacks"></a>4.使用CSS hacks</h3><p>最后你还可以通过使用一个CSS hack（CSS hack）来为IE 5.*&#x2F;Win提供修改过的属性值。我的建议是尽量不使用CSS hacks。顾名思义，它们是hacks，hacks是基于不同浏览器对CSS解析不同导致的无证错误之上的。因为现在依然有很多人在使用hacks，所以我在这里提一下也无妨。除非你明确的知道在做些什么，否则我还是要建议你尽可能的使用其他方法。</p>
<p>针对盒模型问题最简单的CSS hack是SBMH（The simplified box model hack），案例的HTML代码和上面第一个是一样的，CSS是：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#news</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding</span>:<span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> solid;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>:<span class="number">250px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>:<span class="number">228px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所有的浏览器都会看到并理解“width:250px”，但IE 5.<em>&#x2F;Win不会读取下面的一行，width:228px，但这行会被其余的浏览器解析。所以最后，IE 5.</em>&#x2F;Win得到的width值是250px，其他浏览器得到的是228px。这样，在全部的浏览器中我们的新闻列表的总宽度就一致了。</p>
<p>总结：<br>我在本文中展示了如何避免或解决因CSS盒模型计算不同而导致的问题的办法，你可以根据实际情况来选择使用哪一种方法。</p>
<p>需要提到的是，可能在未来的某个时间，CSS3的“box-sizing”属性会给开发者选择盒模型解析方式的权利（在新发布的CSS草案中，容许开发者使用content-box和border-box属性来选择盒模型解析的类型）。W3C的盒模型方式被称为“content-box”，IE的被称为“border-box”。因为每一种盒模型的解析方式都存在着利与弊，所以可以使用这项技术是有好处的。但说回来，对于这种属性的任何具体的落实，都会面临一些浏览器尚不支持的尴尬情况。</p>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>重绘和回流</title>
    <url>/2023/03/18/85%E9%87%8D%E7%BB%98%E5%92%8C%E5%9B%9E%E6%B5%81/</url>
    <content><![CDATA[<h1 id="重绘和回流"><a href="#重绘和回流" class="headerlink" title="重绘和回流"></a>重绘和回流</h1><h3 id="1-回流和重绘基本概念"><a href="#1-回流和重绘基本概念" class="headerlink" title="1.回流和重绘基本概念"></a>1.回流和重绘基本概念</h3><p>回流：当render树中的一部分或者全部因为大小边距等问题发生改变而需要重建的过程叫做回流（改变大小）。</p>
<p>重绘：当元素的一部分属性发生变化，如外观背景色不会引起布局变化而需要重新渲染的过程叫做重绘（改变样式）。</p>
<p>注意：回流必将引起重绘，而重绘不一定会引起回流。</p>
<h3 id="2-回流和重绘发生条件"><a href="#2-回流和重绘发生条件" class="headerlink" title="2.回流和重绘发生条件"></a>2.回流和重绘发生条件</h3><p>当页面布局和几何属性改变时就需要回流。下述情况会发生浏览器回流：</p>
<p>添加或者删除可见的 DOM 元素；<br>元素位置改变；<br>元素尺寸改变——边距、填充、边框、宽度和高度<br>内容改变——比如文本改变或者图片大小改变而引起的计算值宽度和高度改变；<br>页面渲染初始化；<br>浏览器窗口尺寸改变——resize 事件发生时；<br>重绘发生条件：元素的属性或者样式发生变化。</p>
<p>回流的开销较大，如果每个操作都去回流重绘的话，浏览器可能就会受不了。所以很多浏览器都会优化这些操作，浏览器会维护1个队列，把所有会引起回流、重绘的操作放入这个队列，等队列中的操作到了一定的数量或者到了一定的时间间隔，浏览器就会 flush 队列，进行一个批处理。这样就会让多次的回流、重绘变成一次回流重绘。</p>
<p>虽然有了浏览器的优化，但有时一些代码可能会强制浏览器提前flush队列，这样浏览器的优化可能就起不到作用了。当请求向浏览器请求一些 style 信息的时候，就会让浏览器 flush 队列，比如：</p>
<p>offsetTop、offsetLeft、offsetWidth、offsetHeight<br>scrollTop&#x2F;Left&#x2F;Width&#x2F;Height<br>clientTop&#x2F;Left&#x2F;Width&#x2F;Height<br>width、height<br>请求了 getComputedStyle() 或者 IE 的 currentStyle</p>
<h3 id="3-如何减少回流和重绘"><a href="#3-如何减少回流和重绘" class="headerlink" title="3.如何减少回流和重绘"></a>3.如何减少回流和重绘</h3><p>减少回流和重绘其实就是需要减少对 render tree 的操作（合并多次多 DOM 和样式的修改），并减少对一些样式信息的请求，尽量利用好浏览器的优化策略。</p>
<p>添加 css 样式而不是利用js控制样式（我就是想到这种办法解决回流问题的）<br>尽量将需要改变 DOM 的操作一次完成<br>直接改变 className，如果动态改变样式，则使用 cssText（考虑没有优化的浏览器）<br>不要经常访问会引起浏览器 flush 队列的属性，如果你确实要访问，利用缓存<br>让元素脱离动画流，减少回流的 Render Tree 的规模<br>将需要多次重排的元素，position 属性设为 absolute 或 fixed，这样此元素就脱离了文档流，它的变化不会影响到其他元素。例如有动画效果的元素就最好设置为绝对定位；<br>尽量不要使用表格布局，如果没有定宽表格一列的宽度由最宽的一列决定，那么很可能在最后一行的宽度超出之前的列宽，引起整体回流造成 table 可能需要多次计算才能确定好其在渲染树中节点的属性，通常要花3倍于同等元素的时间</p>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>BFC理解及实例</title>
    <url>/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/</url>
    <content><![CDATA[<h1 id="BFC理解及实例"><a href="#BFC理解及实例" class="headerlink" title="BFC理解及实例"></a>BFC理解及实例</h1><p>一、常见定位方案</p>
<p>普通流</p>
<p>    默认，从上而下，行内元素水平排列，行满换行，块级元素渲染成一个新行。</p>
<p>浮动</p>
<p>    先按普通流位置出现，然后根据浮动方向偏移。</p>
<p>绝对定位</p>
<p>    元素具体位置由绝对定位坐标组成。</p>
<p>二、什么是BFC</p>
<p>BFC（Block Formatting Context）格式化上下文，是Web页面中盒模型布局的CSS渲染模式，指一个独立的渲染区域或者说是一个隔离的独立容器。</p>
<p>BFC 即 Block Formatting Contexts (块级格式化上下文)，属于普通流。</p>
<p>可以把 BFC 理解为一个封闭的大箱子，箱子内部的元素无论如何翻江倒海，都不会影响到外部。</p>
<p> 三、形成BFC的条件</p>
<p>      1、浮动元素，float 除 none 以外的值； </p>
<p>      2、绝对定位元素，position（absolute，fixed）； </p>
<p>      3、display 为以下其中之一的值 inline-block，table-cell，table-caption、flex； </p>
<p>      4、overflow 除了 visible 以外的值（hidden，auto，scroll）；</p>
<p>      5、body 根元素</p>
<p>四、BFC的特性</p>
<p>     1、内部的Box会在垂直方向上一个接一个的放置。</p>
<p>     2、垂直方向上的距离由margin决定</p>
<p>     3、bfc的区域不会与float的元素区域重叠。</p>
<p>     4、计算bfc的高度时，浮动元素也参与计算</p>
<p>     5、bfc就是页面上的一个独立容器，容器里面的子元素不会影响外面元素。</p>
<p>五、实例讲解</p>
<p>1、BFC中的盒子对齐</p>
<p>特性的第一条是：内部的Box会在垂直方向上一个接一个的放置。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 1、BFC中的盒子对齐 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;box1&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;box2&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;box3&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;box4&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">/* 1、BFC中的盒子对齐 */</span><br><span class="line"></span><br><span class="line"> div &#123;</span><br><span class="line"></span><br><span class="line">    height: 20px;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container &#123;</span><br><span class="line"></span><br><span class="line">    position: absolute;  /* 创建一个BFC环境*/</span><br><span class="line"></span><br><span class="line">    height: auto;</span><br><span class="line"></span><br><span class="line">    background-color: #eee;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.box1 &#123;</span><br><span class="line"></span><br><span class="line">    width: 400px;</span><br><span class="line"></span><br><span class="line">    background-color: red;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">.box2 &#123;</span><br><span class="line"></span><br><span class="line">    width: 300px;</span><br><span class="line"></span><br><span class="line">    background-color: green;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">.box3 &#123;</span><br><span class="line"></span><br><span class="line">    width: 100px;</span><br><span class="line"></span><br><span class="line">    background-color: yellow;</span><br><span class="line"></span><br><span class="line">    float: left;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">.box4 &#123;</span><br><span class="line"></span><br><span class="line">    width: 200px;</span><br><span class="line"></span><br><span class="line">    height: 30px;</span><br><span class="line"></span><br><span class="line">    background-color: purple;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/01.png" width="50%"></p>
<p>浮动的元素也是这样，box3浮动，他依然接着上一个盒子垂直排列。并且所有的盒子都左对齐。</p>
<p>2、外边距折叠</p>
<p>特性的第二条：垂直方向上的距离由margin决定</p>
<p>也会用到第五条特性： bfc就是页面上的一个独立容器，容器里面的子元素不会影响外面元素。</p>
<p>在常规文档流中，两个兄弟盒子之间的垂直距离是由他们的外边距所决定的，但不是他们的两个外边距之和，而是以较大的为准。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;box1&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;box2&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.container &#123;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">.box1 &#123;</span><br><span class="line">  height: 20px;</span><br><span class="line">  margin: 10px 0;</span><br><span class="line">  background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">.box2 &#123;</span><br><span class="line">  height: 20px;</span><br><span class="line">  margin: 20px 0;</span><br><span class="line">  background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/02.png" width="50%"></p>
<p>这里我们可以看到，第一个子盒子有上边距（不会发生margin穿透的问题）；两个子盒子的垂直距离为20px而不是30px，因为垂直外边距会折叠，间距以较大的为准。</p>
<p> 那么有没有方法让垂直外边距不折叠呢？答案是：有。特性的第5条就说了：bfc就是页面上的一个独立容器，容器里面的子元素不会影响外面元素，同样外面的元素不会影响到BFC内的元素。所以就让box1或box2再处于另一个BFC中就行了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 特性的第5条：bfc就是页面上的一个独立容器，容器里面的子元素不会影响外面元素，同样外面的元素不会影响到BFC内的元素。 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;wrapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;box1&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;box2&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">/* 特性的第5条：bfc就是页面上的一个独立容器，容器里面的子元素不会影响外面元素，同样外面的元素不会影响到BFC内的元素。</span><br><span class="line"></span><br><span class="line">   .container创建一个BFC环境</span><br><span class="line"></span><br><span class="line">   .wrapper创建一个BFC环境</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.container &#123;</span><br><span class="line"></span><br><span class="line">  overflow: hidden;</span><br><span class="line"></span><br><span class="line">  width: 100px;</span><br><span class="line"></span><br><span class="line">  height: 100px;</span><br><span class="line"></span><br><span class="line">  background-color: red;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.wrapper &#123;</span><br><span class="line"></span><br><span class="line">  overflow: hidden;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box1 &#123;</span><br><span class="line"></span><br><span class="line">  height: 20px;</span><br><span class="line"></span><br><span class="line">  margin: 10px 0;</span><br><span class="line"></span><br><span class="line">  background-color: green;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box2 &#123;</span><br><span class="line"></span><br><span class="line">  height: 20px;</span><br><span class="line"></span><br><span class="line">  margin: 20px 0;</span><br><span class="line"></span><br><span class="line">  background-color: green;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/03.png" width="50%"></p>
<p>3、不被浮动元素覆盖 </p>
<p>以常见的两栏布局为例。</p>
<p>左边固定宽度，右边不设宽，因此右边的宽度自适应，随浏览器窗口大小的变化而变化。</p>
<p>如果要是不加BFC的话就会被遮盖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 3、不被浮动元素覆盖  --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">/* 3、不被浮动元素覆盖</span><br><span class="line"></span><br><span class="line"> .column:nth-of-type(2) 创建一个BFC环境</span><br><span class="line"></span><br><span class="line"> :nth-of-type(n) 选择器匹配属于父元素的特定类型的第 N 个子元素的每个元素.</span><br><span class="line"></span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(1) &#123;</span><br><span class="line"></span><br><span class="line">  float: left;</span><br><span class="line"></span><br><span class="line">  width: 200px;</span><br><span class="line"></span><br><span class="line">  height: 300px;</span><br><span class="line"></span><br><span class="line">  margin-right: 10px;</span><br><span class="line"></span><br><span class="line">  background-color: red;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(2) &#123;</span><br><span class="line"></span><br><span class="line">  overflow: hidden;</span><br><span class="line"></span><br><span class="line">  height: 300px;</span><br><span class="line"></span><br><span class="line">  background-color: purple;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/04.png" width="50%"></p>
<p>还有三栏布局。</p>
<p>左右两边固定宽度，中间不设宽，因此中间的宽度自适应，随浏览器的大小变化而变化。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 三栏布局 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;contain&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">/* 三栏布局 */</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(1),</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(2) &#123;</span><br><span class="line"></span><br><span class="line">  float: left;</span><br><span class="line"></span><br><span class="line">  width: 100px;</span><br><span class="line"></span><br><span class="line">  height: 300px;</span><br><span class="line"></span><br><span class="line">  background-color: green;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(2) &#123;</span><br><span class="line"></span><br><span class="line">  float: right;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.column:nth-of-type(3) &#123;</span><br><span class="line"></span><br><span class="line">  overflow: hidden;</span><br><span class="line"></span><br><span class="line">  height: 300px;</span><br><span class="line"></span><br><span class="line">  background-color: red;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/05.png" width="50%"></p>
<p>也可以用来防止字体环绕：</p>
<p>众所周知，浮动的盒子会遮盖下面的盒子，但是下面盒子里的文字是不会被遮盖的，文字反而还会环绕浮动的盒子。这也是一个比较有趣的特性。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 字体环绕 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;left&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;p&gt;你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好</span><br><span class="line"></span><br><span class="line">       你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好</span><br><span class="line"></span><br><span class="line">       你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好你好</span><br><span class="line"></span><br><span class="line">    &lt;/p&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">/* 字体环绕 p标签加不加bfc，实现不同效果 （overflow: hidden;） */</span><br><span class="line"></span><br><span class="line">.left &#123;</span><br><span class="line"></span><br><span class="line">  float: left;</span><br><span class="line"></span><br><span class="line">  width: 100px;</span><br><span class="line"></span><br><span class="line">  height: 100px;</span><br><span class="line"></span><br><span class="line">  background-color: yellow;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p &#123;</span><br><span class="line"></span><br><span class="line">  background-color: green;</span><br><span class="line"></span><br><span class="line">  /* overflow: hidden; */</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>P标签不加BFC实现效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/06.png" width="50%"></p>
<p>P标签加BFC实现效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/07.png" width="50%"></p>
<p>4、BFC包含浮动的块<br>利用overflow:hidden清除浮动，因为浮动的盒子无法撑出处于标准文档流的父盒子的height。</p>
<p>BFC可以包含浮动的元素(清除浮动)</p>
<p>浮动的元素会脱离普通文档流，来看下下面一个例子:</p>
<!-- 4 BFC包含浮动的块 -->
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;border: 1px solid #000;&quot;&gt;</span><br><span class="line"></span><br><span class="line">     &lt;div style=&quot;width: 100px;height: 100px;background: #eee;float: left;&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/08.png" width="50%"></p>
<p>由于容器内元素浮动脱离文档流，导致容器只剩下2px边距高度，我们这时候可以采用BFC：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;border: 1px solid #000;overflow: hidden&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div style=&quot;width: 100px;height: 100px;background: #eee;float: left;&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="/2023/03/17/84bfc%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E4%BE%8B/09.png" width="50%"></p>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>dom、css、render树解析</title>
    <url>/2023/03/20/86dom%E3%80%81css%E3%80%81render%E6%A0%91%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="dom、css、render树解析"><a href="#dom、css、render树解析" class="headerlink" title="dom、css、render树解析"></a>dom、css、render树解析</h1><blockquote>
<p>面试官：请说一下Dom树 CSS树 渲染树(render树) 规则、原理<br>答：<br>首先你要了解浏览器渲染的顺序：<br>  1.构建dom 树<br>  2.构建css 树<br>  3.构建渲染树<br>  4.节点布局<br>  5.页面渲染<br>其实DOM节点可以分为 可视化节点 和 非可视化节点，<br>像 div、p 等这种结构性的标签节点可被称为可视化节点，<br>而 script、meta 等这种在页面上显示不出来的节点则被称为非可视化节点；</p>
</blockquote>
<h2 id="那渲染树-render树-是什么呢？浏览器是如何渲染-UI-的？"><a href="#那渲染树-render树-是什么呢？浏览器是如何渲染-UI-的？" class="headerlink" title="那渲染树(render树)是什么呢？浏览器是如何渲染 UI 的？"></a>那渲染树(render树)是什么呢？浏览器是如何渲染 UI 的？</h2><blockquote>
<p>（1）浏览器获取 HTML 文件，然后对文件进行解析，形成 DOM Tree<br>（2）与此同时，进行 CSS 解析，生成 Style Rules<br>（3）接着将 DOM Tree 与 Style Rules 合成为 Render Tree<br>（4）元素在页面中布局，然后绘制<br>render 树就是根据 可视化节点 和 css 样式表 结合诞生出来的树；<br>注意：PS: display: none 的元素会出现在 DOM树 中，但不会出现在 render 树中；</p>
</blockquote>
<h2 id="什么是dom-树？"><a href="#什么是dom-树？" class="headerlink" title="什么是dom 树？"></a>什么是dom 树？</h2><blockquote>
<p>浏览器将HTML解析成树形的数据结构，简称DOM。<br>DOM 是文档对象模型 (Document Object Model) 的缩写。它是 HTML 文档的对象表示，同时也是外部内容（例如 JavaScript）与 HTML 元素之间的接口。 解析树的根节点是Document对象。<br><img src="/2023/03/20/86dom%E3%80%81css%E3%80%81render%E6%A0%91%E8%A7%A3%E6%9E%90/01.png" width="50%"><br>你还可以这样理解 dom 树：<br>  1.DOM树揭示了DOM对象之间的层次关系，这样就方便动态地对html文档进行增删改查。<br>  2.增删改查必须要遵循层次关系<br>  3.文本对象是最底层的节点<br>  4.获取 对象的值 .value</p>
</blockquote>
<h2 id="什么是CSS树？"><a href="#什么是CSS树？" class="headerlink" title="什么是CSS树？"></a>什么是CSS树？</h2><img src="/2023/03/20/86dom%E3%80%81css%E3%80%81render%E6%A0%91%E8%A7%A3%E6%9E%90/02.png" width="50%">
>看着有点像 less 写法（less这种预处理语言，就是借用DOM树的思想，来将less这种语法结构，转译成普通的css语法，最终我们用的还是普通的css语法构成的css文件）。
渲染树构建(renderTree)
渲染树是dom树结合css树形成的一个新的树。当renderTree构建完毕后，浏览器会根据它去绘制页面。
特点:
(1)渲染树每个节点都有自己的样式。
(2)不包含隐藏节点(display: none)、不需要绘制的节点(html/head/style/title)，这些节点在renderTree形成之前就会被剔除。
(3)visibility: hidden相对应的节点是包含在渲染树上的，因为它影响布局(layout)。
(4)渲染树上的每一个节点都会被当成一个盒子，具有内容填充、边距、边框、位置、大小及其它样式。

<h2 id="解析与加载"><a href="#解析与加载" class="headerlink" title="解析与加载"></a>解析与加载</h2><blockquote>
<p>（1）解析与加载<br>概念<br>页面渲染机制主要分为解析和加载<br>解析：解析就是把整个html结构变成一个又一个的节点，然后挂在dom树上面形成dom树<br>加载：加载就是加载html里面的资源<br>先有解析，再有加载，而解析和加载的过程是一个异步的过程</p>
</blockquote>
<p>示例1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;baidu.png&quot; alt=&quot;&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>先是解析img标签变成节点再挂到dom树上，图片的加载并不在解析的过程当中，加载在当前节点解析完成之后</p>
<p>示例2<br>在构建dom树的时候，span和div会挂在dom树上面吗？</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;span style=&quot;display: none&quot;&gt;&lt;/span&gt;</span><br><span class="line">var oDiv = document.createElement(&#x27;div&#x27;);</span><br><span class="line">document.body.appendChild(oDiv);</span><br></pre></td></tr></table></figure>
<p>会，因为节点树不会管样式，只管dom节点，动态创建也是dom节点</p>
]]></content>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>富文本编辑器tinymce</title>
    <url>/2023/03/05/80%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8tinymce/</url>
    <content><![CDATA[<h1 id="富文本编辑器tinymce"><a href="#富文本编辑器tinymce" class="headerlink" title="富文本编辑器tinymce"></a>富文本编辑器tinymce</h1><h2 id="步骤1："><a href="#步骤1：" class="headerlink" title="步骤1："></a>步骤1：</h2><blockquote>
<p>下载依赖：npm i <a href="mailto:&#x74;&#x69;&#110;&#x79;&#x6d;&#99;&#x65;&#64;&#x35;&#46;&#x31;&#x30;&#x2e;&#51;">&#x74;&#x69;&#110;&#x79;&#x6d;&#99;&#x65;&#64;&#x35;&#46;&#x31;&#x30;&#x2e;&#51;</a> @tinymce&#x2F;<a href="mailto:&#116;&#x69;&#x6e;&#121;&#109;&#99;&#101;&#45;&#x76;&#117;&#101;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x38;">&#116;&#x69;&#x6e;&#121;&#109;&#99;&#101;&#45;&#x76;&#117;&#101;&#64;&#x33;&#x2e;&#x32;&#x2e;&#x38;</a> -S</p>
</blockquote>
<h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><blockquote>
<p>在node_modules中找到tinymce<br><img src="/2023/03/05/80%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8tinymce/002.png"></p>
</blockquote>
<h2 id="步骤3："><a href="#步骤3：" class="headerlink" title="步骤3："></a>步骤3：</h2><blockquote>
<p>复制skins文件夹，并下载中文包<br>中文包下载地址<br><a href="https://www.tiny.cloud/get-tiny/language-packages/">https://www.tiny.cloud/get-tiny/language-packages/</a><br><img src="/2023/03/05/80%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8tinymce/001.png"></p>
</blockquote>
<blockquote>
<p>1.在public中新建 tinymce 文件夹</p>
<p>2.将中文包下载好后解压出来，将langs文件夹复制到public&#x2F;tinymce</p>
<p>3.把node_modules中tinymce下的skins文件夹复制到public&#x2F;tinymce<br><img src="/2023/03/05/80%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8tinymce/003.png"></p>
</blockquote>
<h2 id="步骤4："><a href="#步骤4：" class="headerlink" title="步骤4："></a>步骤4：</h2><blockquote>
<p>在components文件夹中新建tinymce_editor.vue</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;tinymce-editor&quot;&gt;</span><br><span class="line">    &lt;Editor</span><br><span class="line">        :id=&quot;editorId&quot;</span><br><span class="line">        v-model=&quot;editorValue&quot;</span><br><span class="line">        :init=&quot;editorInit&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import tinymce from &#x27;tinymce/tinymce&#x27;;</span><br><span class="line">import Editor from &#x27;@tinymce/tinymce-vue&#x27;;</span><br><span class="line">import &#x27;tinymce/icons/default/icons&#x27;;</span><br><span class="line">import &#x27;tinymce/themes/silver&#x27;;</span><br><span class="line">// 引入富文本编辑器主题的js和css</span><br><span class="line">import &#x27;tinymce/themes/silver/theme.min&#x27;;</span><br><span class="line">import &#x27;tinymce/skins/ui/oxide/skin.min.css&#x27;;</span><br><span class="line">// 扩展插件</span><br><span class="line"></span><br><span class="line">import &quot;tinymce/themes/silver/theme&quot;;</span><br><span class="line">import &quot;tinymce/icons/default/icons&quot;;</span><br><span class="line">import &quot;tinymce/plugins/image&quot;; // 插入上传图片插件</span><br><span class="line">import &quot;tinymce/plugins/media&quot;; // 插入视频插件</span><br><span class="line">import &quot;tinymce/plugins/table&quot;; // 插入表格插件</span><br><span class="line">import &quot;tinymce/plugins/link&quot;; // 超链接插件</span><br><span class="line">import &quot;tinymce/plugins/code&quot;; // 代码块插件</span><br><span class="line">import &quot;tinymce/plugins/lists&quot;; // 列表插件</span><br><span class="line">import &quot;tinymce/plugins/contextmenu&quot;; // 右键菜单插件</span><br><span class="line">import &quot;tinymce/plugins/wordcount&quot;; // 字数统计插件</span><br><span class="line">import &quot;tinymce/plugins/colorpicker&quot;; // 选择颜色插件</span><br><span class="line">import &quot;tinymce/plugins/textcolor&quot;; // 文本颜色插件</span><br><span class="line">import &quot;tinymce/plugins/fullscreen&quot;; // 全屏</span><br><span class="line">import &quot;tinymce/plugins/help&quot;; // 帮助</span><br><span class="line">import &quot;tinymce/plugins/charmap&quot;;</span><br><span class="line">import &quot;tinymce/plugins/paste&quot;;</span><br><span class="line">import &quot;tinymce/plugins/print&quot;; // 打印</span><br><span class="line">import &quot;tinymce/plugins/preview&quot;; // 预览</span><br><span class="line">import &quot;tinymce/plugins/hr&quot;; // 水平线</span><br><span class="line">import &quot;tinymce/plugins/anchor&quot;;</span><br><span class="line">import &quot;tinymce/plugins/pagebreak&quot;;</span><br><span class="line">import &quot;tinymce/plugins/spellchecker&quot;;</span><br><span class="line">import &quot;tinymce/plugins/searchreplace&quot;;</span><br><span class="line">import &quot;tinymce/plugins/visualblocks&quot;;</span><br><span class="line">import &quot;tinymce/plugins/visualchars&quot;;</span><br><span class="line">import &quot;tinymce/plugins/insertdatetime&quot;;</span><br><span class="line">import &quot;tinymce/plugins/nonbreaking&quot;;</span><br><span class="line">import &quot;tinymce/plugins/autosave&quot;;</span><br><span class="line">import &quot;tinymce/plugins/fullpage&quot;;</span><br><span class="line">import &quot;tinymce/plugins/toc&quot;;</span><br><span class="line">import &quot;tinymce/plugins/advlist&quot;;</span><br><span class="line">import &quot;tinymce/plugins/autolink&quot;;</span><br><span class="line">import &quot;tinymce/plugins/codesample&quot;;</span><br><span class="line">import &quot;tinymce/plugins/directionality&quot;;</span><br><span class="line">import &quot;tinymce/plugins/imagetools&quot;;</span><br><span class="line">import &quot;tinymce/plugins/noneditable&quot;;</span><br><span class="line">import &quot;tinymce/plugins/save&quot;;</span><br><span class="line">import &quot;tinymce/plugins/tabfocus&quot;;</span><br><span class="line">import &quot;tinymce/plugins/textpattern&quot;;</span><br><span class="line">import &quot;tinymce/plugins/template&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;TinymceEditor&#x27;,</span><br><span class="line">  components: &#123;Editor&#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    height: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 500</span><br><span class="line">    &#125;,</span><br><span class="line">    id: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;tinymceEditor&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    value: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: &#123;</span><br><span class="line">      type: [String, Array],</span><br><span class="line">      default: &#x27;link lists image code table wordcount media fullscreen preview paste contextmenu textcolor&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    toolbar: &#123;</span><br><span class="line">      type: [String, Array],</span><br><span class="line">      default: &#x27;fontselect | bold italic underline strikethrough | link unlink image | undo redo | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent blockquote | code | removeformat&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      editorInit: &#123;</span><br><span class="line">        // language_url: &#x27;/tinymce/langs/zh_CN.js&#x27;,</span><br><span class="line">        language_url: &#x27;https://lab.uxfeel.com/node_modules/tinymce/langs/zh_CN.js&#x27;,</span><br><span class="line">        language: &#x27;zh_CN&#x27;,</span><br><span class="line">        skin_url: &#x27;/tinymce/skins/ui/oxide&#x27;,</span><br><span class="line">        content_css: &#x27;/tinymce/skins/content/default/content.css&#x27;,</span><br><span class="line">        height: this.height,</span><br><span class="line">        content_style: &#x27;* &#123; padding:0; margin:0; &#125; img &#123;max-width:100% !important &#125;&#x27;,</span><br><span class="line">        plugin_preview_width: 375, // 预览宽度</span><br><span class="line">        plugin_preview_height: 668,</span><br><span class="line">        browser_spellcheck: true, // 拼写检查</span><br><span class="line">        lineheight_val: &quot;1 1.1 1.2 1.3 1.35 1.4 1.5 1.55 1.6 1.75 1.8 1.9 1.95 2 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 3 3.1 3.2 3.3 3.4 4 5&quot;,</span><br><span class="line">        fontsize_formats: &quot;8pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 24pt 36pt&quot;,</span><br><span class="line">        font_formats: &quot;微软雅黑=&#x27;微软雅黑&#x27;;宋体=&#x27;宋体&#x27;;黑体=&#x27;黑体&#x27;;仿宋=&#x27;仿宋&#x27;;楷体=&#x27;楷体&#x27;;隶书=&#x27;隶书&#x27;;幼圆=&#x27;幼圆&#x27;;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings&quot;,</span><br><span class="line">        plugins: &quot;advlist anchor autolink autosave code codesample colorpickercontextmenu directionalityfullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount&quot;,</span><br><span class="line">        powerpaste_word_import: &#x27;merge&#x27;,</span><br><span class="line">        toolbar: this.toolbar,</span><br><span class="line">        paste_data_images: true, // 允许粘贴图像</span><br><span class="line">        statusbar: true, // 底部的状态栏</span><br><span class="line">        menubar: true, // 最上方的菜单</span><br><span class="line">        branding: false, // 水印“Powered by TinyMCE”</span><br><span class="line">        // 图片上传时触发，将图片传给后端，后端返回图片的url</span><br><span class="line">        images_upload_handler: (blobInfo, success, failure) =&gt; &#123;</span><br><span class="line">          // this.$emit(&#x27;handleImgUpload&#x27;, blobInfo, success, failure);</span><br><span class="line">          const formData = new FormData();</span><br><span class="line">          formData.append(&#x27;img&#x27;, blobInfo.blob());</span><br><span class="line">          try &#123;</span><br><span class="line">            // const res = this.uploadFile(formData);</span><br><span class="line">            this.$axios.post(this.$URL + &#x27;qiniu/imageurl/&#x27;, formData).then(res =&gt; &#123;</span><br><span class="line">              // success接收返回的图片url</span><br><span class="line">              success(res.data.url);</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            console.log(e);</span><br><span class="line">            failure(&#x27;上传失败:&#x27; + e);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      editorId: this.id,</span><br><span class="line">      newValue: &#x27;&#x27;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    newValue(newValue) &#123;</span><br><span class="line">      this.$emit(&#x27;input&#x27;, newValue);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    tinymce.init(&#123;&#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    editorValue: &#123;</span><br><span class="line">      get() &#123;</span><br><span class="line">        return this.value;</span><br><span class="line">      &#125;,</span><br><span class="line">      set(val) &#123;</span><br><span class="line">        this.newValue = val;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // https://github.com/tinymce/tinymce-vue =&gt; All available events</span><br><span class="line">    clear() &#123;</span><br><span class="line">      this.editorValue = &#x27;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>


<h2 id="步骤5：组件使用"><a href="#步骤5：组件使用" class="headerlink" title="步骤5：组件使用"></a>步骤5：组件使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;article&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;tinymce-editor&quot;&gt;</span><br><span class="line">      &lt;tinymce_write</span><br><span class="line">          :id=&quot;tinymce_editor&quot;</span><br><span class="line">          v-model=&quot;content&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import tinymce_editor. from &quot;@/components/tinymce_editor.&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  // 注册组件</span><br><span class="line">  components: &#123;tinymce_editor&#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">	  // 内容</span><br><span class="line">      content: &#x27;&#x27;,</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>富文本</tag>
      </tags>
  </entry>
</search>
